/*! For license information please see main.322db1bc.js.LICENSE.txt */
(()=>{var e={6503:(e,t,n)=>{"use strict";e=n.nmd(e);const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t=>`\x1b[${38+e};5;${t}m`},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(t,n,r)=>`\x1b[${38+e};2;${t};${n};${r}m`};Object.defineProperty(e,"exports",{enumerable:!0,get:function(){const e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(const[n,r]of Object.entries(t)){for(const[n,a]of Object.entries(r))t[n]={open:`\x1b[${a[0]}m`,close:`\x1b[${a[1]}m`},r[n]=t[n],e.set(a[0],a[1]);Object.defineProperty(t,n,{value:r,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1b[39m",t.bgColor.close="\x1b[49m",t.color.ansi256=r(),t.color.ansi16m=a(),t.bgColor.ansi256=r(10),t.bgColor.ansi16m=a(10),Object.defineProperties(t,{rgbToAnsi256:{value:(e,t,n)=>e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5),enumerable:!1},hexToRgb:{value:e=>{const t=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!t)return[0,0,0];let{colorString:n}=t.groups;3===n.length&&(n=n.split("").map((e=>e+e)).join(""));const r=Number.parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},enumerable:!1},hexToAnsi256:{value:e=>t.rgbToAnsi256(...t.hexToRgb(e)),enumerable:!1}}),t}})},8693:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});const r={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var a,i=new Uint8Array(16);function s(){if(!a&&!(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}for(var o=[],l=0;l<256;++l)o.push((l+256).toString(16).slice(1));function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}const u=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();var a=(e=e||{}).random||(e.rng||s)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return c(a)}},4445:(e,t)=>{"use strict";t.byteLength=function(e){var t=o(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=o(e),s=i[0],l=i[1],c=new a(function(e,t,n){return 3*(t+n)/4-n}(0,s,l)),u=0,d=l>0?s-4:s;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[u++]=255&t);1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,a=r%3,i=[],s=16383,o=0,c=r-a;o<c;o+=s)i.push(l(e,o,o+s>c?c:o+s));1===a?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===a&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=i[s],r[i.charCodeAt(s)]=s;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,r){for(var a,i,s=[],o=t;o<r;o+=3)a=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(n[(i=a)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},9894:e=>{"use strict";const t=/[\p{Lu}]/u,n=/[\p{Ll}]/u,r=/^[\p{Lu}](?![\p{Lu}])/gu,a=/([\p{Alpha}\p{N}_]|$)/u,i=/[_.\- ]+/,s=new RegExp("^"+i.source),o=new RegExp(i.source+a.source,"gu"),l=new RegExp("\\d+"+a.source,"gu"),c=(e,a)=>{if("string"!==typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");if(a={pascalCase:!1,preserveConsecutiveUppercase:!1,...a},0===(e=Array.isArray(e)?e.map((e=>e.trim())).filter((e=>e.length)).join("-"):e.trim()).length)return"";const i=!1===a.locale?e=>e.toLowerCase():e=>e.toLocaleLowerCase(a.locale),c=!1===a.locale?e=>e.toUpperCase():e=>e.toLocaleUpperCase(a.locale);if(1===e.length)return a.pascalCase?c(e):i(e);return e!==i(e)&&(e=((e,r,a)=>{let i=!1,s=!1,o=!1;for(let l=0;l<e.length;l++){const c=e[l];i&&t.test(c)?(e=e.slice(0,l)+"-"+e.slice(l),i=!1,o=s,s=!0,l++):s&&o&&n.test(c)?(e=e.slice(0,l-1)+"-"+e.slice(l-1),o=s,s=!1,i=!0):(i=r(c)===c&&a(c)!==c,o=s,s=a(c)===c&&r(c)!==c)}return e})(e,i,c)),e=e.replace(s,""),e=a.preserveConsecutiveUppercase?((e,t)=>(r.lastIndex=0,e.replace(r,(e=>t(e)))))(e,i):i(e),a.pascalCase&&(e=c(e.charAt(0))+e.slice(1)),((e,t)=>(o.lastIndex=0,l.lastIndex=0,e.replace(o,((e,n)=>t(n))).replace(l,(e=>t(e)))))(e,c)};e.exports=c,e.exports.default=c},3047:e=>{"use strict";e.exports=function(e,t){if("string"!==typeof e)throw new TypeError("Expected a string");return t="undefined"===typeof t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},7283:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var o=new a(r,i||e,s),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,i=r.length,s=new Array(i);a<i;a++)s[a]=r[a].fn;return s},o.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,a,i,s){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,a),!0;case 5:return u.fn.call(u.context,t,r,a,i),!0;case 6:return u.fn.call(u.context,t,r,a,i,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,a);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,r,a){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||a&&!o.once||r&&o.context!==r||s(this,i);else{for(var l=0,c=[],u=o.length;l<u;l++)(o[l].fn!==t||a&&!o[l].once||r&&o[l].context!==r)&&c.push(o[l]);c.length?this._events[i]=1===c.length?c[0]:c:s(this,i)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o},2740:e=>{"use strict";e.exports=function(e,t,n,r,a,i,s,o){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,a,i,s,o],u=0;(l=new Error(t.replace(/%s/g,(function(){return c[u++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},8502:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});const r={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var a,i=new Uint8Array(16);function s(){if(!a&&!(a="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}for(var o=[],l=0;l<256;++l)o.push((l+256).toString(16).slice(1));function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}const u=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();var a=(e=e||{}).random||(e.rng||s)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return c(a)}},9498:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},5623:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(7283),a=n(2270),i=n(7349),s=()=>{},o=new a.TimeoutError;t.default=class extends r{constructor(e){var t,n,r,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=s,this._resolveIdle=s,!("number"===typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:i.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(a=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==a?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"===typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,r)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const i=void 0===this._timeout&&void 0===t.timeout?e():a.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&r(o)}));n(await i)}catch(i){r(i)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},115:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){let r=0,a=e.length;for(;a>0;){const i=a/2|0;let s=r+i;n(e[s],t)<=0?(r=++s,a-=i+1):a=i}return r}},7349:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(115);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const n={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(n);const a=r.default(this._queue,n,((e,t)=>t.priority-e.priority));this._queue.splice(a,0,n)}dequeue(){const e=this._queue.shift();return null===e||void 0===e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},6659:(e,t,n)=>{"use strict";const r=n(302),a=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class i extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const s=(e,t)=>new Promise(((n,s)=>{t={onFailedAttempt:()=>{},retries:10,...t};const o=r.operation(t);o.attempt((async r=>{try{n(await e(r))}catch(c){if(!(c instanceof Error))return void s(new TypeError(`Non-error was thrown: "${c}". You should only throw errors.`));if(c instanceof i)o.stop(),s(c.originalError);else if(c instanceof TypeError&&(l=c.message,!a.includes(l)))o.stop(),s(c);else{((e,t,n)=>{const r=n.retries-(t-1);e.attemptNumber=t,e.retriesLeft=r})(c,r,t);try{await t.onFailedAttempt(c)}catch(c){return void s(c)}o.retry(c)||s(o.mainError())}}var l}))}));e.exports=s,e.exports.default=s,e.exports.AbortError=i},2270:(e,t,n)=>{"use strict";const r=n(9498);class a extends Error{constructor(e){super(e),this.name="TimeoutError"}}const i=(e,t,n)=>new Promise(((i,s)=>{if("number"!==typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void i(e);const o=setTimeout((()=>{if("function"===typeof n){try{i(n())}catch(o){s(o)}return}const r=n instanceof Error?n:new a("string"===typeof n?n:`Promise timed out after ${t} milliseconds`);"function"===typeof e.cancel&&e.cancel(),s(r)}),t);r(e.then(i,s),(()=>{clearTimeout(o)}))}));e.exports=i,e.exports.default=i,e.exports.TimeoutError=a},1497:(e,t,n)=>{"use strict";var r=n(3218);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,s){if(s!==r){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},5173:(e,t,n)=>{e.exports=n(1497)()},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2730:(e,t,n)=>{"use strict";var r=n(5043),a=n(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),P=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var C=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function $(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var L,M=Object.assign;function D(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?D(e):""}function F(e){switch(e.tag){case 5:return D(e.type);case 16:return D("Lazy");case 13:return D("Suspense");case 19:return D("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case x:return"Portal";case S:return"Profiler";case k:return"StrictMode";case N:return"Suspense";case j:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case O:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function Z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=V(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function G(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Z(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){J(e,t);var n=Z(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,Z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Z(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Z(n)}}function ie(e,t){var n=Z(t.value),r=Z(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Ee=null,ke=null;function Se(e){if(e=ba(e)){if("function"!==typeof xe)throw Error(i(280));var t=e.stateNode;t&&(t=_a(t),xe(e.stateNode,e.type,t))}}function Oe(e){Ee?ke?ke.push(e):ke=[e]:Ee=e}function Pe(){if(Ee){var e=Ee,t=ke;if(ke=Ee=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Te(e,t){return e(t)}function Ne(){}var je=!1;function Ie(e,t,n){if(je)return e(t,n);je=!0;try{return Te(e,t,n)}finally{je=!1,(null!==Ee||null!==ke)&&(Ne(),Pe())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var r=_a(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Ce=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ce=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Ce=!1}function $e(e,t,n,r,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Me=null,De=!1,Ue=null,ze={onError:function(e){Le=!0,Me=e}};function Fe(e,t,n,r,a,i,s,o,l){Le=!1,Me=null,$e.apply(ze,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ze(e){if(Be(e)!==e)throw Error(i(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return Ze(a),e;if(s===r)return Ze(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var We=a.unstable_scheduleCallback,Ke=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Ge=a.unstable_requestPaint,Je=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Qe=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=dt(o):0!==(i&=s)&&(r=dt(i))}else 0!==(s=n&~a)?r=dt(s):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,xt,Et,kt,St,Ot=!1,Pt=[],Tt=null,Nt=null,jt=null,It=new Map,At=new Map,Ct=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $t(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":jt=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Lt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&xt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Mt(e){var t=va(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void St(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Dt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&xt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ut(e,t,n){Dt(e)&&n.delete(t)}function zt(){Ot=!1,null!==Tt&&Dt(Tt)&&(Tt=null),null!==Nt&&Dt(Nt)&&(Nt=null),null!==jt&&Dt(jt)&&(jt=null),It.forEach(Ut),At.forEach(Ut)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,Ot||(Ot=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Bt(e){function t(t){return Ft(t,e)}if(0<Pt.length){Ft(Pt[0],e);for(var n=1;n<Pt.length;n++){var r=Pt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&Ft(Tt,e),null!==Nt&&Ft(Nt,e),null!==jt&&Ft(jt,e),It.forEach(t),At.forEach(t),n=0;n<Ct.length;n++)(r=Ct[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ct.length&&null===(n=Ct[0]).blockedOn;)Mt(n),null===n.blockedOn&&Ct.shift()}var Ht=w.ReactCurrentBatchConfig,Zt=!0;function Vt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=1,Wt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function qt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=4,Wt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function Wt(e,t,n,r){if(Zt){var a=Yt(e,t,n,r);if(null===a)Zr(e,t,r,Kt,n),$t(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Tt=Lt(Tt,e,t,n,r,a),!0;case"dragenter":return Nt=Lt(Nt,e,t,n,r,a),!0;case"mouseover":return jt=Lt(jt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return It.set(i,Lt(It.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,At.set(i,Lt(At.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if($t(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&_t(i),null===(i=Yt(e,t,n,r))&&Zr(e,t,r,Kt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Zr(e,t,r,null,n)}}var Kt=null;function Yt(e,t,n,r){if(Kt=null,null!==(e=va(e=_e(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Xt,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Qt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),dn=M({},cn,{view:0,detail:0}),hn=an(dn),pn=M({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=an(pn),mn=an(M({},pn,{dataTransfer:0})),gn=an(M({},dn,{relatedTarget:0})),yn=an(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(vn),wn=an(M({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Sn(){return kn}var On=M({},dn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Pn=an(On),Tn=an(M({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(M({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),jn=an(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=M({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=an(In),Cn=[9,13,27,32],Rn=u&&"CompositionEvent"in window,$n=null;u&&"documentMode"in document&&($n=document.documentMode);var Ln=u&&"TextEvent"in window&&!$n,Mn=u&&(!Rn||$n&&8<$n&&11>=$n),Dn=String.fromCharCode(32),Un=!1;function zn(e,t){switch(e){case"keyup":return-1!==Cn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Vn(e,t,n,r){Oe(r),0<(t=qr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Wn=null;function Kn(e){Dr(e,0)}function Yn(e){if(W(wa(e)))return e}function Gn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Qn="oninput"in document;if(!Qn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Qn="function"===typeof er.oninput}Xn=Qn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Wn=qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Wn)){var t=[];Vn(t,Wn,e,_e(e)),Ie(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Wn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Wn)}function ir(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!or(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=ur(n,i);var s=ur(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==K(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=qr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Er={},kr={};function Sr(e){if(Er[e])return Er[e];if(!xr[e])return e;var t,n=xr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Er[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);var Or=Sr("animationend"),Pr=Sr("animationiteration"),Tr=Sr("animationstart"),Nr=Sr("transitionend"),jr=new Map,Ir="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){jr.set(e,t),l(t,[e])}for(var Cr=0;Cr<Ir.length;Cr++){var Rr=Ir[Cr];Ar(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Ar(Or,"onAnimationEnd"),Ar(Pr,"onAnimationIteration"),Ar(Tr,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $r="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat($r));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,o,l,c){if(Fe.apply(this,arguments),Le){if(!Le)throw Error(i(198));var u=Me;Le=!1,Me=null,De||(De=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Dr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Mr(a,o,c),i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Mr(a,o,c),i=l}}}if(De)throw e=Ue,De=!1,Ue=null,e}function Ur(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Fr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Fr]){e[Fr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fr]||(t[Fr]=!0,zr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Gt(t)){case 1:var a=Vt;break;case 4:a=qt;break;default:a=Wt}n=a.bind(null,t,n,e),a=void 0,!Ce||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Zr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=va(o)))return;if(5===(l=s.tag)||6===l){r=i=s;continue e}o=o.parentNode}}r=r.return}Ie((function(){var r=i,a=_e(n),s=[];e:{var o=jr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Pn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Nn;break;case Or:case Pr:case Tr:l=yn;break;case Nr:l=jn;break;case"scroll":l=hn;break;case"wheel":l=An;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ae(f,h))&&u.push(Vr(f,m,p)))),d)break;f=f.return}0<u.length&&(o=new l(o,c,null,n,a),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!va(c)&&!c[fa])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?va(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?o:wa(l),p=null==c?o:wa(c),(o=new u(m,f+"leave",l,n,a)).target=d,o.relatedTarget=p,m=null,va(a)===r&&((u=new u(h,f+"enter",c,n,a)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Wr(p))f++;for(p=0,m=h;m;m=Wr(m))p++;for(;0<f-p;)u=Wr(u),f--;for(;0<p-f;)h=Wr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Wr(u),h=Wr(h)}u=null}else u=null;null!==l&&Kr(s,o,l,u,!1),null!==c&&null!==d&&Kr(s,d,c,u,!0)}if("select"===(l=(o=r?wa(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Gn;else if(Zn(o))if(Jn)g=sr;else{g=ar;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ir);switch(g&&(g=g(e,r))?Vn(s,g,n,a):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?wa(r):window,e){case"focusin":(Zn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,a)}var v;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Mn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(v=en()):(Xt="value"in(Jt=a)?Jt.value:Jt.textContent,Bn=!0)),0<(y=qr(r,b)).length&&(b=new wn(b,e,null,n,a),s.push({event:b,listeners:y}),v?b.data=v:null!==(v=Fn(n))&&(b.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:(Un=!0,Dn);case"textInput":return(e=t.data)===Dn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Rn&&zn(e,t)?(e=en(),Qt=Xt=Jt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=v))}Dr(s,t)}))}function Vr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Ae(e,n))&&r.unshift(Vr(e,i,a)),null!=(i=Ae(e,t))&&r.push(Vr(e,i,a))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=Ae(n,i))&&s.unshift(Vr(n,l,o)):a||null!=(l=Ae(n,i))&&s.push(Vr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yr=/\r\n?/g,Gr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Gr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(i(425))}function Qr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(oa)}:ra;function oa(e){setTimeout((function(){throw e}))}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Bt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,pa="__reactProps$"+da,fa="__reactContainer$"+da,ma="__reactEvents$"+da,ga="__reactListeners$"+da,ya="__reactHandles$"+da;function va(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[ha])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function _a(e){return e[pa]||null}var xa=[],Ea=-1;function ka(e){return{current:e}}function Sa(e){0>Ea||(e.current=xa[Ea],xa[Ea]=null,Ea--)}function Oa(e,t){Ea++,xa[Ea]=e.current,e.current=t}var Pa={},Ta=ka(Pa),Na=ka(!1),ja=Pa;function Ia(e,t){var n=e.type.contextTypes;if(!n)return Pa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Aa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ca(){Sa(Na),Sa(Ta)}function Ra(e,t,n){if(Ta.current!==Pa)throw Error(i(168));Oa(Ta,t),Oa(Na,n)}function $a(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,H(e)||"Unknown",a));return M({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pa,ja=Ta.current,Oa(Ta,e),Oa(Na,Na.current),!0}function Ma(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=$a(e,t,ja),r.__reactInternalMemoizedMergedChildContext=e,Sa(Na),Sa(Ta),Oa(Ta,e)):Sa(Na),Oa(Na,n)}var Da=null,Ua=!1,za=!1;function Fa(e){null===Da?Da=[e]:Da.push(e)}function Ba(){if(!za&&null!==Da){za=!0;var e=0,t=bt;try{var n=Da;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Da=null,Ua=!1}catch(a){throw null!==Da&&(Da=Da.slice(e+1)),We(Qe,Ba),a}finally{bt=t,za=!1}}return null}var Ha=[],Za=0,Va=null,qa=0,Wa=[],Ka=0,Ya=null,Ga=1,Ja="";function Xa(e,t){Ha[Za++]=qa,Ha[Za++]=Va,Va=e,qa=t}function Qa(e,t,n){Wa[Ka++]=Ga,Wa[Ka++]=Ja,Wa[Ka++]=Ya,Ya=e;var r=Ga;e=Ja;var a=32-st(r)-1;r&=~(1<<a),n+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Ga=1<<32-st(t)+a|n<<a|r,Ja=i+e}else Ga=1<<i|n<<a|r,Ja=e}function ei(e){null!==e.return&&(Xa(e,1),Qa(e,1,0))}function ti(e){for(;e===Va;)Va=Ha[--Za],Ha[Za]=null,qa=Ha[--Za],Ha[Za]=null;for(;e===Ya;)Ya=Wa[--Ka],Wa[Ka]=null,Ja=Wa[--Ka],Wa[Ka]=null,Ga=Wa[--Ka],Wa[Ka]=null}var ni=null,ri=null,ai=!1,ii=null;function si(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ya?{id:Ga,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!oi(e,t)){if(li(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&oi(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!ai)return ui(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw hi(),Error(i(418));for(;t;)si(e,t),t=ca(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=ca(e.nextSibling)}function pi(){ri=ni=null,ai=!1}function fi(e){null===ii?ii=[e]:ii.push(e)}var mi=w.ReactCurrentBatchConfig;function gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function yi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Cc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===E?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===A&&vi(i)===t.type)?((r=a(t,n.props)).ref=gi(e,t,n),r.return=e,r):((r=Rc(n.type,n.key,n.props,null,e.mode,r)).ref=gi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Dc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=$c(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=gi(e,null,t),n.return=e,n;case x:return(t=Dc(t,e.mode,n)).return=e,t;case A:return h(e,(0,t._init)(t._payload),n)}if(te(t)||$(t))return(t=$c(t,e.mode,n,null)).return=e,t;yi(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===a?c(e,t,n,r):null;case x:return n.key===a?u(e,t,n,r):null;case A:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||$(n))return null!==a?null:d(e,t,n,r,null);yi(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case A:return f(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||$(r))return d(t,e=e.get(n)||null,r,a,null);yi(t,r)}return null}function m(a,i,o,l){for(var c=null,u=null,d=i,m=i=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=p(a,d,o[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(a,d),i=s(y,i,m),null===u?c=y:u.sibling=y,u=y,d=g}if(m===o.length)return n(a,d),ai&&Xa(a,m),c;if(null===d){for(;m<o.length;m++)null!==(d=h(a,o[m],l))&&(i=s(d,i,m),null===u?c=d:u.sibling=d,u=d);return ai&&Xa(a,m),c}for(d=r(a,d);m<o.length;m++)null!==(g=f(d,a,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),i=s(g,i,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(a,e)})),ai&&Xa(a,m),c}function g(a,o,l,c){var u=$(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,m=o,g=o=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=p(a,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(a,m),o=s(b,o,g),null===d?u=b:d.sibling=b,d=b,m=y}if(v.done)return n(a,m),ai&&Xa(a,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(a,v.value,c))&&(o=s(v,o,g),null===d?u=v:d.sibling=v,d=v);return ai&&Xa(a,g),u}for(m=r(a,m);!v.done;g++,v=l.next())null!==(v=f(m,a,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),o=s(v,o,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach((function(e){return t(a,e)})),ai&&Xa(a,g),u}return function e(r,i,s,l){if("object"===typeof s&&null!==s&&s.type===E&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case _:e:{for(var c=s.key,u=i;null!==u;){if(u.key===c){if((c=s.type)===E){if(7===u.tag){n(r,u.sibling),(i=a(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&vi(c)===u.type){n(r,u.sibling),(i=a(u,s.props)).ref=gi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===E?((i=$c(s.props.children,r.mode,l,s.key)).return=r,r=i):((l=Rc(s.type,s.key,s.props,null,r.mode,l)).ref=gi(r,i,s),l.return=r,r=l)}return o(r);case x:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=a(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Dc(s,r.mode,l)).return=r,r=i}return o(r);case A:return e(r,i,(u=s._init)(s._payload),l)}if(te(s))return m(r,i,s,l);if($(s))return g(r,i,s,l);yi(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,s)).return=r,r=i):(n(r,i),(i=Mc(s,r.mode,l)).return=r,r=i),o(r)):n(r,i)}}var wi=bi(!0),_i=bi(!1),xi=ka(null),Ei=null,ki=null,Si=null;function Oi(){Si=ki=Ei=null}function Pi(e){var t=xi.current;Sa(xi),e._currentValue=t}function Ti(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ni(e,t){Ei=e,Si=ki=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function ji(e){var t=e._currentValue;if(Si!==e)if(e={context:e,memoizedValue:t,next:null},null===ki){if(null===Ei)throw Error(i(308));ki=e,Ei.dependencies={lanes:0,firstContext:e}}else ki=ki.next=e;return t}var Ii=null;function Ai(e){null===Ii?Ii=[e]:Ii.push(e)}function Ci(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ai(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ri(e,r)}function Ri(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var $i=!1;function Li(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ui(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ri(e,n)}return null===(a=r.interleaved)?(t.next=t,Ai(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ri(e,n)}function zi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Fi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bi(e,t,n,r){var a=e.updateQueue;$i=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=a.baseState;for(s=0,u=c=l=null,o=i;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=M({},d,h);break e;case 2:$i=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ll|=s,e.lanes=s,e.memoizedState=d}}function Hi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Zi={},Vi=ka(Zi),qi=ka(Zi),Wi=ka(Zi);function Ki(e){if(e===Zi)throw Error(i(174));return e}function Yi(e,t){switch(Oa(Wi,t),Oa(qi,e),Oa(Vi,Zi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sa(Vi),Oa(Vi,t)}function Gi(){Sa(Vi),Sa(qi),Sa(Wi)}function Ji(e){Ki(Wi.current);var t=Ki(Vi.current),n=le(t,e.type);t!==n&&(Oa(qi,e),Oa(Vi,n))}function Xi(e){qi.current===e&&(Sa(Vi),Sa(qi))}var Qi=ka(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function ns(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var rs=w.ReactCurrentDispatcher,as=w.ReactCurrentBatchConfig,is=0,ss=null,os=null,ls=null,cs=!1,us=!1,ds=0,hs=0;function ps(){throw Error(i(321))}function fs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ms(e,t,n,r,a,s){if(is=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Xs:Qs,e=n(r,a),us){s=0;do{if(us=!1,ds=0,25<=s)throw Error(i(301));s+=1,ls=os=null,t.updateQueue=null,rs.current=eo,e=n(r,a)}while(us)}if(rs.current=Js,t=null!==os&&null!==os.next,is=0,ls=os=ss=null,cs=!1,t)throw Error(i(300));return e}function gs(){var e=0!==ds;return ds=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?ss.memoizedState=ls=e:ls=ls.next=e,ls}function vs(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===ls?ss.memoizedState:ls.next;if(null!==t)ls=t,os=e;else{if(null===e)throw Error(i(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===ls?ss.memoizedState=ls=e:ls=ls.next=e}return ls}function bs(e,t){return"function"===typeof t?t(e):t}function ws(e){var t=vs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=os,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((is&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,ss.lanes|=d,Ll|=d}u=u.next}while(null!==u&&u!==s);null===c?o=r:c.next=l,or(r,t.memoizedState)||(bo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,ss.lanes|=s,Ll|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _s(e){var t=vs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);or(s,t.memoizedState)||(bo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function xs(){}function Es(e,t){var n=ss,r=vs(),a=t(),s=!or(r.memoizedState,a);if(s&&(r.memoizedState=a,bo=!0),r=r.queue,$s(Os.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(n.flags|=2048,js(9,Ss.bind(null,n,r,a,t),void 0,null),null===Nl)throw Error(i(349));0!==(30&is)||ks(n,t,a)}return a}function ks(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ss(e,t,n,r){t.value=n,t.getSnapshot=r,Ps(t)&&Ts(e)}function Os(e,t,n){return n((function(){Ps(t)&&Ts(e)}))}function Ps(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ts(e){var t=Ri(e,1);null!==t&&nc(t,e,1,-1)}function Ns(e){var t=ys();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ws.bind(null,ss,e),[t.memoizedState,e]}function js(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Is(){return vs().memoizedState}function As(e,t,n,r){var a=ys();ss.flags|=e,a.memoizedState=js(1|t,n,void 0,void 0===r?null:r)}function Cs(e,t,n,r){var a=vs();r=void 0===r?null:r;var i=void 0;if(null!==os){var s=os.memoizedState;if(i=s.destroy,null!==r&&fs(r,s.deps))return void(a.memoizedState=js(t,n,i,r))}ss.flags|=e,a.memoizedState=js(1|t,n,i,r)}function Rs(e,t){return As(8390656,8,e,t)}function $s(e,t){return Cs(2048,8,e,t)}function Ls(e,t){return Cs(4,2,e,t)}function Ms(e,t){return Cs(4,4,e,t)}function Ds(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Us(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Cs(4,4,Ds.bind(null,t,e),n)}function zs(){}function Fs(e,t){var n=vs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Bs(e,t){var n=vs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hs(e,t,n){return 0===(21&is)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),ss.lanes|=n,Ll|=n,e.baseState=!0),t)}function Zs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=as.transition;as.transition={};try{e(!1),t()}finally{bt=n,as.transition=r}}function Vs(){return vs().memoizedState}function qs(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ks(e))Ys(t,n);else if(null!==(n=Ci(e,t,n,r))){nc(n,e,r,ec()),Gs(n,t,r)}}function Ws(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ks(e))Ys(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,or(o,s)){var l=t.interleaved;return null===l?(a.next=a,Ai(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ci(e,t,a,r))&&(nc(n,e,r,a=ec()),Gs(n,t,r))}}function Ks(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Ys(e,t){us=cs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Gs(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Js={readContext:ji,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},Xs={readContext:ji,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:ji,useEffect:Rs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,As(4194308,4,Ds.bind(null,t,e),n)},useLayoutEffect:function(e,t){return As(4194308,4,e,t)},useInsertionEffect:function(e,t){return As(4,2,e,t)},useMemo:function(e,t){var n=ys();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ys();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=qs.bind(null,ss,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:Ns,useDebugValue:zs,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=Ns(!1),t=e[0];return e=Zs.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ss,a=ys();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Nl)throw Error(i(349));0!==(30&is)||ks(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Rs(Os.bind(null,r,s,e),[e]),r.flags|=2048,js(9,Ss.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ys(),t=Nl.identifierPrefix;if(ai){var n=Ja;t=":"+t+"R"+(n=(Ga&~(1<<32-st(Ga)-1)).toString(32)+n),0<(n=ds++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qs={readContext:ji,useCallback:Fs,useContext:ji,useEffect:$s,useImperativeHandle:Us,useInsertionEffect:Ls,useLayoutEffect:Ms,useMemo:Bs,useReducer:ws,useRef:Is,useState:function(){return ws(bs)},useDebugValue:zs,useDeferredValue:function(e){return Hs(vs(),os.memoizedState,e)},useTransition:function(){return[ws(bs)[0],vs().memoizedState]},useMutableSource:xs,useSyncExternalStore:Es,useId:Vs,unstable_isNewReconciler:!1},eo={readContext:ji,useCallback:Fs,useContext:ji,useEffect:$s,useImperativeHandle:Us,useInsertionEffect:Ls,useLayoutEffect:Ms,useMemo:Bs,useReducer:_s,useRef:Is,useState:function(){return _s(bs)},useDebugValue:zs,useDeferredValue:function(e){var t=vs();return null===os?t.memoizedState=e:Hs(t,os.memoizedState,e)},useTransition:function(){return[_s(bs)[0],vs().memoizedState]},useMutableSource:xs,useSyncExternalStore:Es,useId:Vs,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ui(e,i,a))&&(nc(t,e,a,r),zi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Di(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ui(e,i,a))&&(nc(t,e,a,r),zi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Di(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Ui(e,a,r))&&(nc(t,e,r,n),zi(t,e,r))}};function ao(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,i))}function io(e,t,n){var r=!1,a=Pa,i=t.contextType;return"object"===typeof i&&null!==i?i=ji(i):(a=Aa(t)?ja:Ta.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ia(e,a):Pa),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function so(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Li(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=ji(i):(i=Aa(t)?ja:Ta.current,a.context=Ia(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(no(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ro.enqueueReplaceState(a,a.state,null),Bi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=F(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Zl||(Zl=!0,Vl=r),uo(0,t)},n}function fo(e,t,n){(n=Di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){uo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Di(-1,1)).tag=2,Ui(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var vo=w.ReactCurrentOwner,bo=!1;function wo(e,t,n,r){t.child=null===e?_i(t,null,n,r):wi(t,e.child,n,r)}function _o(e,t,n,r,a){n=n.render;var i=t.ref;return Ni(t,a),r=ms(e,t,n,r,i,a),n=gs(),null===e||bo?(ai&&n&&ei(t),t.flags|=1,wo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Zo(e,t,a))}function xo(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Ac(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Eo(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Zo(e,t,a)}return t.flags|=1,(e=Cc(i,r)).ref=t.ref,e.return=t,t.child=e}function Eo(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(bo=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Zo(e,t,a);0!==(131072&e.flags)&&(bo=!0)}}return Oo(e,t,n,r,a)}function ko(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oa(Cl,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Oa(Cl,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Oa(Cl,Al),Al|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Oa(Cl,Al),Al|=r;return wo(e,t,a,n),t.child}function So(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Oo(e,t,n,r,a){var i=Aa(n)?ja:Ta.current;return i=Ia(t,i),Ni(t,a),n=ms(e,t,n,r,i,a),r=gs(),null===e||bo?(ai&&r&&ei(t),t.flags|=1,wo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Zo(e,t,a))}function Po(e,t,n,r,a){if(Aa(n)){var i=!0;La(t)}else i=!1;if(Ni(t,a),null===t.stateNode)Ho(e,t),io(t,n,r),oo(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=ji(c):c=Ia(t,c=Aa(n)?ja:Ta.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==c)&&so(t,s,r,c),$i=!1;var h=t.memoizedState;s.state=h,Bi(t,r,s,a),l=t.memoizedState,o!==r||h!==l||Na.current||$i?("function"===typeof u&&(no(t,n,u,r),l=t.memoizedState),(o=$i||ao(t,n,o,r,h,l,c))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Mi(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),s.props=c,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=ji(l):l=Ia(t,l=Aa(n)?ja:Ta.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||h!==l)&&so(t,s,r,l),$i=!1,h=t.memoizedState,s.state=h,Bi(t,r,s,a);var f=t.memoizedState;o!==d||h!==f||Na.current||$i?("function"===typeof p&&(no(t,n,p,r),f=t.memoizedState),(c=$i||ao(t,n,c,r,h,f,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return To(e,t,n,r,i,a)}function To(e,t,n,r,a,i){So(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&Ma(t,n,!1),Zo(e,t,i);r=t.stateNode,vo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,o,i)):wo(e,t,o,i),t.memoizedState=r.state,a&&Ma(t,n,!0),t.child}function No(e){var t=e.stateNode;t.pendingContext?Ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(0,t.context,!1),Yi(e,t.containerInfo)}function jo(e,t,n,r,a){return pi(),fi(a),t.flags|=256,wo(e,t,n,r),t.child}var Io,Ao,Co,Ro,$o={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mo(e,t,n){var r,a=t.pendingProps,s=Qi.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Oa(Qi,1&s),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Lc(l,a,0,null),e=$c(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Lo(n),t.memoizedState=$o,e):Do(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,r=co(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(s=$c(s,a,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&wi(t,e.child,null,o),t.child.memoizedState=Lo(o),t.memoizedState=$o,s);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Uo(e,t,o,r=co(s=Error(i(419)),r,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(r=Nl)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Ri(e,a),nc(r,e,a,-1))}return mc(),Uo(e,t,o,r=co(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Pc.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Wa[Ka++]=Ga,Wa[Ka++]=Ja,Wa[Ka++]=Ya,Ga=e.id,Ja=e.overflow,Ya=t),t=Do(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,s,n);if(o){o=a.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Cc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Cc(r,o):(o=$c(o,l,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Lo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=$o,a}return e=(o=e.child).sibling,a=Cc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Do(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,r){return null!==r&&fi(r),wi(t,e.child,null,n),(e=Do(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ti(e.return,t,n)}function Fo(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Bo(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=Qi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Oa(Qi,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===es(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Fo(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===es(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Fo(t,!0,n,null,i);break;case"together":Fo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Cc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Cc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vo(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Wo(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Aa(t.type)&&Ca(),qo(t),null;case 3:return r=t.stateNode,Gi(),Sa(Na),Sa(Ta),ns(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sc(ii),ii=null))),Ao(e,t),qo(t),null;case 5:Xi(t);var a=Ki(Wi.current);if(n=t.type,null!==e&&null!=t.stateNode)Co(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qo(t),null}if(e=Ki(Vi.current),di(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ha]=t,r[pa]=s,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(a=0;a<$r.length;a++)Ur($r[a],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":G(r,s),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ur("invalid",r);break;case"textarea":ae(r,s),Ur("invalid",r)}for(var l in ve(n,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":q(r),Q(r,s,!0);break;case"textarea":q(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Qr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=r,Io(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),a=r;break;case"iframe":case"object":case"embed":Ur("load",e),a=r;break;case"video":case"audio":for(a=0;a<$r.length;a++)Ur($r[a],e);a=r;break;case"source":Ur("error",e),a=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),a=r;break;case"details":Ur("toggle",e),a=r;break;case"input":G(e,r),a=Y(e,r),Ur("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Ur("invalid",e)}for(s in ve(n,a),c=a)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Ur("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":q(e),Q(e,r,!1);break;case"textarea":q(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Z(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Qr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Ro(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Ki(Wi.current),Ki(Vi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(s=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return qo(t),null;case 13:if(Sa(Qi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),pi(),t.flags|=98560,s=!1;else if(s=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[ha]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),s=!1}else null!==ii&&(sc(ii),ii=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Qi.current)?0===Rl&&(Rl=3):mc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Gi(),Ao(e,t),null===e&&Br(t.stateNode.containerInfo),qo(t),null;case 10:return Pi(t.type._context),qo(t),null;case 19:if(Sa(Qi),null===(s=t.memoizedState))return qo(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Vo(s,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=es(e))){for(t.flags|=128,Vo(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Oa(Qi,1&Qi.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Bl&&(t.flags|=128,r=!0,Vo(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=es(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ai)return qo(t),null}else 2*Je()-s.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Vo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=Qi.current,Oa(Qi,r?1&n|2:1&n),t):(qo(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Al)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ko(e,t){switch(ti(t),t.tag){case 1:return Aa(t.type)&&Ca(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Gi(),Sa(Na),Sa(Ta),ns(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xi(t),null;case 13:if(Sa(Qi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sa(Qi),null;case 4:return Gi(),null;case 10:return Pi(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Io=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ao=function(){},Co=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Ki(Vi.current);var i,s=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),s=[];break;case"select":a=M({},a,{value:void 0}),r=M({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Qr)}for(u in ve(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Ro=function(e,t,n,r){n!==r&&(t.flags|=4)};var Yo=!1,Go=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Xo=null;function Qo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){kc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&el(t,n,i)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[ma],delete t[ga],delete t[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:Go||Qo(n,t);case 6:var r=ul,a=dl;ul=null,hl(e,t,n),dl=a,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Bt(e)):la(ul,n.stateNode));break;case 4:r=ul,a=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=a;break;case 0:case 11:case 14:case 15:if(!Go&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&el(n,t,s),a=a.next}while(a!==r)}hl(e,t,n);break;case 1:if(!Go&&(Qo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){kc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Go=(r=Go)||null!==n.memoizedState,hl(e,t,n),Go=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach((function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(i(160));pl(s,o,a),ul=null,dl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){kc(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){kc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Qo(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Qo(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){kc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&J(a,s),be(l,o);var u=be(l,s);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):b(a,d,h,u)}switch(l){case"input":X(a,s);break;case"textarea":ie(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?ne(a,!!s.multiple,f,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[pa]=s}catch(g){kc(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){kc(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Fl=Je())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Go=(u=Go)||d,ml(t,e),Go=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xo=e,d=e.child;null!==d;){for(h=Xo=d;null!==Xo;){switch(f=(p=Xo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Qo(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){kc(r,n,g)}}break;case 5:Qo(p,p.return);break;case 22:if(null!==p.memoizedState){_l(h);continue}}null!==f?(f.return=p,Xo=f):_l(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){kc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),yl(e),4&r&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cl(e,ol(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(i(161))}}catch(o){kc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Xo=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Xo;){var a=Xo,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Yo;if(!s){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Go;o=Yo;var c=Go;if(Yo=s,(Go=l)&&!c)for(Xo=a;null!==Xo;)l=(s=Xo).child,22===s.tag&&null!==s.memoizedState?xl(a):null!==l?(l.return=s,Xo=l):xl(a);for(;null!==i;)Xo=i,bl(i,t,n),i=i.sibling;Xo=a,Yo=o,Go=c}wl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Xo=i):wl(e)}}function wl(e){for(;null!==Xo;){var t=Xo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Go||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Go)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Hi(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hi(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(i(163))}Go||512&t.flags&&al(t)}catch(p){kc(t,t.return,p)}}if(t===e){Xo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xo=n;break}Xo=t.return}}function _l(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xo=n;break}Xo=t.return}}function xl(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){kc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){kc(t,a,l)}}var i=t.return;try{al(t)}catch(l){kc(t,i,l)}break;case 5:var s=t.return;try{al(t)}catch(l){kc(t,s,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var El,kl=Math.ceil,Sl=w.ReactCurrentDispatcher,Ol=w.ReactCurrentOwner,Pl=w.ReactCurrentBatchConfig,Tl=0,Nl=null,jl=null,Il=0,Al=0,Cl=ka(0),Rl=0,$l=null,Ll=0,Ml=0,Dl=0,Ul=null,zl=null,Fl=0,Bl=1/0,Hl=null,Zl=!1,Vl=null,ql=null,Wl=!1,Kl=null,Yl=0,Gl=0,Jl=null,Xl=-1,Ql=0;function ec(){return 0!==(6&Tl)?Je():-1!==Xl?Xl:Xl=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Il?Il&-Il:null!==mi.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function nc(e,t,n,r){if(50<Gl)throw Gl=0,Jl=null,Error(i(185));yt(e,n,r),0!==(2&Tl)&&e===Nl||(e===Nl&&(0===(2&Tl)&&(Ml|=n),4===Rl&&oc(e,Il)),rc(e,r),1===n&&0===Tl&&0===(1&t.mode)&&(Bl=Je()+500,Ua&&Ba()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Nl?Il:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Ua=!0,Fa(e)}(lc.bind(null,e)):Fa(lc.bind(null,e)),sa((function(){0===(6&Tl)&&Ba()})),n=null;else{switch(wt(r)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Xl=-1,Ql=0,0!==(6&Tl))throw Error(i(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=ht(e,e===Nl?Il:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=Tl;Tl|=2;var s=fc();for(Nl===e&&Il===t||(Hl=null,Bl=Je()+500,hc(e,t));;)try{vc();break}catch(l){pc(e,l)}Oi(),Sl.current=s,Tl=a,null!==jl?t=0:(Nl=null,Il=0,t=Rl)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=ic(e,a))),1===t)throw n=$l,hc(e,0),oc(e,r),rc(e,Je()),n;if(6===t)oc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!or(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(s=ft(e))&&(r=s,t=ic(e,s))),1===t))throw n=$l,hc(e,0),oc(e,r),rc(e,Je()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:_c(e,zl,Hl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Fl+500-Je())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(_c.bind(null,e,zl,Hl),t);break}_c(e,zl,Hl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>a&&(a=o),r&=~s}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=ra(_c.bind(null,e,zl,Hl),r);break}_c(e,zl,Hl);break;default:throw Error(i(329))}}}return rc(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&sc(t)),e}function sc(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Dl,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Tl))throw Error(i(327));xc();var t=ht(e,0);if(0===(1&t))return rc(e,Je()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=$l,hc(e,0),oc(e,t),rc(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,zl,Hl),rc(e,Je()),null}function cc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(Bl=Je()+500,Ua&&Ba())}}function uc(e){null!==Kl&&0===Kl.tag&&0===(6&Tl)&&xc();var t=Tl;Tl|=1;var n=Pl.transition,r=bt;try{if(Pl.transition=null,bt=1,e)return e()}finally{bt=r,Pl.transition=n,0===(6&(Tl=t))&&Ba()}}function dc(){Al=Cl.current,Sa(Cl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==jl)for(n=jl.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ca();break;case 3:Gi(),Sa(Na),Sa(Ta),ns();break;case 5:Xi(r);break;case 4:Gi();break;case 13:case 19:Sa(Qi);break;case 10:Pi(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Nl=e,jl=e=Cc(e.current,null),Il=Al=t,Rl=0,$l=null,Dl=Ml=Ll=0,zl=Ul=null,null!==Ii){for(t=0;t<Ii.length;t++)if(null!==(r=(n=Ii[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}Ii=null}return e}function pc(e,t){for(;;){var n=jl;try{if(Oi(),rs.current=Js,cs){for(var r=ss.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}cs=!1}if(is=0,ls=os=ss=null,us=!1,ds=0,Ol.current=null,null===n||null===n.return){Rl=1,$l=t,jl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,yo(f,o,l,0,t),1&f.mode&&mo(s,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(s,u,t),mc();break e}c=Error(i(426))}else if(ai&&1&l.mode){var y=go(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),fi(lo(c,l));break e}}s=c=lo(c,l),4!==Rl&&(Rl=2),null===Ul?Ul=[s]:Ul.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Fi(s,po(0,c,t));break e;case 1:l=c;var v=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===ql||!ql.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Fi(s,fo(s,l,t));break e}}s=s.return}while(null!==s)}wc(n)}catch(w){t=w,jl===n&&null!==n&&(jl=n=n.return);continue}break}}function fc(){var e=Sl.current;return Sl.current=Js,null===e?Js:e}function mc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Nl||0===(268435455&Ll)&&0===(268435455&Ml)||oc(Nl,Il)}function gc(e,t){var n=Tl;Tl|=2;var r=fc();for(Nl===e&&Il===t||(Hl=null,hc(e,t));;)try{yc();break}catch(a){pc(e,a)}if(Oi(),Tl=n,Sl.current=r,null!==jl)throw Error(i(261));return Nl=null,Il=0,Rl}function yc(){for(;null!==jl;)bc(jl)}function vc(){for(;null!==jl&&!Ye();)bc(jl)}function bc(e){var t=El(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?wc(e):jl=t,Ol.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Wo(n,t,Al)))return void(jl=n)}else{if(null!==(n=Ko(n,t)))return n.flags&=32767,void(jl=n);if(null===e)return Rl=6,void(jl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(jl=t);jl=t=e}while(null!==t);0===Rl&&(Rl=5)}function _c(e,t,n){var r=bt,a=Pl.transition;try{Pl.transition=null,bt=1,function(e,t,n,r){do{xc()}while(null!==Kl);if(0!==(6&Tl))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,s),e===Nl&&(jl=Nl=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wl||(Wl=!0,Nc(tt,(function(){return xc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Pl.transition,Pl.transition=null;var o=bt;bt=1;var l=Tl;Tl|=4,Ol.current=null,function(e,t){if(ea=Zt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(_){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===a&&(l=o),p===s&&++d===r&&(c=o),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Zt=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(_){kc(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}m=tl,tl=!1}(e,n),gl(n,e),fr(ta),Zt=!!ea,ta=ea=null,e.current=n,vl(n,e,a),Ge(),Tl=l,bt=o,Pl.transition=s}else e.current=n;if(Wl&&(Wl=!1,Kl=e,Yl=a),s=e.pendingLanes,0===s&&(ql=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Zl)throw Zl=!1,e=Vl,Vl=null,e;0!==(1&Yl)&&0!==e.tag&&xc(),s=e.pendingLanes,0!==(1&s)?e===Jl?Gl++:(Gl=0,Jl=e):Gl=0,Ba()}(e,t,n,r)}finally{Pl.transition=a,bt=r}return null}function xc(){if(null!==Kl){var e=wt(Yl),t=Pl.transition,n=bt;try{if(Pl.transition=null,bt=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Yl=0,0!==(6&Tl))throw Error(i(331));var a=Tl;for(Tl|=4,Xo=e.current;null!==Xo;){var s=Xo,o=s.child;if(0!==(16&Xo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Xo=u;null!==Xo;){var d=Xo;switch(d.tag){case 0:case 11:case 15:nl(8,d,s)}var h=d.child;if(null!==h)h.return=d,Xo=h;else for(;null!==Xo;){var p=(d=Xo).sibling,f=d.return;if(il(d),d===u){Xo=null;break}if(null!==p){p.return=f,Xo=p;break}Xo=f}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Xo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Xo=o;else e:for(;null!==Xo;){if(0!==(2048&(s=Xo).flags))switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Xo=v;break e}Xo=s.return}}var b=e.current;for(Xo=b;null!==Xo;){var w=(o=Xo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Xo=w;else e:for(o=b;null!==Xo;){if(0!==(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(x){kc(l,l.return,x)}if(l===o){Xo=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Xo=_;break e}Xo=l.return}}if(Tl=a,Ba(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(x){}r=!0}return r}finally{bt=n,Pl.transition=t}}return!1}function Ec(e,t,n){e=Ui(e,t=po(0,t=lo(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function kc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ql||!ql.has(r))){t=Ui(t,e=fo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Nl===e&&(Il&n)===n&&(4===Rl||3===Rl&&(130023424&Il)===Il&&500>Je()-Fl?hc(e,0):Dl|=n),rc(e,t)}function Oc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ri(e,t))&&(yt(e,t,n),rc(e,n))}function Pc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Oc(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Oc(e,n)}function Nc(e,t){return We(e,t)}function jc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,r){return new jc(e,t,n,r)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Cc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,r,a,s){var o=2;if(r=e,"function"===typeof e)Ac(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case E:return $c(n.children,a,s,t);case k:o=8,a|=8;break;case S:return(e=Ic(12,n,t,2|a)).elementType=S,e.lanes=s,e;case N:return(e=Ic(13,n,t,a)).elementType=N,e.lanes=s,e;case j:return(e=Ic(19,n,t,a)).elementType=j,e.lanes=s,e;case C:return Lc(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case O:o=10;break e;case P:o=9;break e;case T:o=11;break e;case I:o=14;break e;case A:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Ic(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function $c(e,t,n,r){return(e=Ic(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Ic(22,e,r,t)).elementType=C,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Dc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,a,i,s,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ic(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Li(i),e}function Fc(e){if(!e)return Pa;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Aa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Aa(n))return $a(e,n,t)}return t}function Bc(e,t,n,r,a,i,s,o,l){return(e=zc(n,r,!0,e,0,i,0,o,l)).context=Fc(null),n=e.current,(i=Di(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Ui(n,i,a),e.current.lanes=a,yt(e,a,r),rc(e,r),e}function Hc(e,t,n,r){var a=t.current,i=ec(),s=tc(a);return n=Fc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Di(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ui(a,t,s))&&(nc(e,a,s,i),zi(e,a,s)),s}function Zc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Na.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:No(t),pi();break;case 5:Ji(t);break;case 1:Aa(t.type)&&La(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Oa(xi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Oa(Qi,1&Qi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Mo(e,t,n):(Oa(Qi,1&Qi.current),null!==(e=Zo(e,t,n))?e.sibling:null);Oa(Qi,1&Qi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Oa(Qi,Qi.current),r)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,n)}return Zo(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,ai&&0!==(1048576&t.flags)&&Qa(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var a=Ia(t,Ta.current);Ni(t,n),a=ms(null,t,r,e,a,n);var s=gs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Aa(r)?(s=!0,La(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Li(t),a.updater=ro,t.stateNode=a,a._reactInternals=t,oo(t,r,e,n),t=To(null,t,r,!0,s,n)):(t.tag=0,ai&&s&&ei(t),wo(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===I)return 14}return 2}(r),e=to(r,e),a){case 0:t=Oo(null,t,r,e,n);break e;case 1:t=Po(null,t,r,e,n);break e;case 11:t=_o(null,t,r,e,n);break e;case 14:t=xo(null,t,r,to(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Oo(e,t,r,a=t.elementType===r?a:to(r,a),n);case 1:return r=t.type,a=t.pendingProps,Po(e,t,r,a=t.elementType===r?a:to(r,a),n);case 3:e:{if(No(t),null===e)throw Error(i(387));r=t.pendingProps,a=(s=t.memoizedState).element,Mi(e,t),Bi(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=jo(e,t,r,n,a=lo(Error(i(423)),t));break e}if(r!==a){t=jo(e,t,r,n,a=lo(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=_i(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===a){t=Zo(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return Ji(t),null===e&&ci(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,na(r,a)?o=null:null!==s&&na(r,s)&&(t.flags|=32),So(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Mo(e,t,n);case 4:return Yi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,_o(e,t,r,a=t.elementType===r?a:to(r,a),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Oa(xi,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===a.children&&!Na.current){t=Zo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=Di(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ti(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ti(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ni(t,n),r=r(a=ji(a)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return a=to(r=t.type,t.pendingProps),xo(e,t,r,a=to(r.type,a),n);case 15:return Eo(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:to(r,a),Ho(e,t),t.tag=1,Aa(r)?(e=!0,La(t)):e=!1,Ni(t,n),io(t,r,a),oo(t,r,a,n),To(null,t,r,!0,e,n);case 19:return Bo(e,t,n);case 22:return ko(e,t,n)}throw Error(i(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Gc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Qc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=Zc(s);o.call(e)}}Hc(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Zc(s);i.call(e)}}var s=Bc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[fa]=s.current,Br(8===e.nodeType?e.parentNode:e),uc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=Zc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[fa]=l.current,Br(8===e.nodeType?e.parentNode:e),uc((function(){Hc(t,l,n,r)})),l}(n,t,e,a,r);return Zc(s)}Yc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hc(e,t,null,null)},Yc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Hc(null,e,null,null)})),t[fa]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ct.length&&0!==t&&t<Ct[n].priority;n++);Ct.splice(n,0,e),0===n&&Mt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Je()),0===(6&Tl)&&(Bl=Je()+500,Ba()))}break;case 13:uc((function(){var t=Ri(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),qc(e,1)}},xt=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)nc(t,e,134217728,ec());qc(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),n=Ri(e,t);if(null!==n)nc(n,e,t,ec());qc(e,t)}},kt=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},xe=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=_a(r);if(!a)throw Error(i(90));W(r),X(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,Ne=uc;var eu={usingClientEntryPoint:!1,Events:[ba,wa,_a,Oe,Pe,cc]},tu={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{at=ru.inject(nu),it=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Gc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Gc(e))throw Error(i(299));var n=!1,r="",a=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,Br(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return Qc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Gc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",o=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,a,0,s,o),e[fa]=t.current,Br(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Yc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return Qc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(uc((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fa]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Qc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},1153:(e,t,n)=>{"use strict";var r=n(5043),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,m(w,y.prototype),w.isPureReactComponent=!0;var _=Array.isArray,x=Object.prototype.hasOwnProperty,E={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)x.call(t,a)&&!k.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:n,type:e,key:s,ref:o,props:i,_owner:E.current}}function O(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var P=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===i?"."+T(l,0):i,_(s)?(a="",null!=e&&(a=e.replace(P,"$&/")+"/"),N(s,t,a,"",(function(e){return e}))):null!=s&&(O(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(P,"$&/")+"/")+e)),t.push(s)),1;if(l=0,i=""===i?".":i+":",_(e))for(var c=0;c<e.length;c++){var u=i+T(o=e[c],c);l+=N(o,t,a,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=N(o=o.value,t,a,u=i+T(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function j(e,t,n){if(null==e)return e;var r=[],a=0;return N(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function I(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},C={transition:null},R={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:C,ReactCurrentOwner:E};function $(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:j,forEach:function(e,t,n){j(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return j(e,(function(){t++})),t},toArray:function(e){return j(e,(function(e){return e}))||[]},only:function(e){if(!O(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=$,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!k.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=O,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.transition;C.transition={};try{e()}finally{C.transition=t}},t.unstable_act=$,t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.3.1"},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},579:(e,t,n)=>{"use strict";e.exports=n(1153)},302:(e,t,n)=>{e.exports=n(3944)},3944:(e,t,n)=>{var r=n(5790);t.operation=function(e){var n=t.timeouts(e);return new r(n,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],a=0;a<t.retries;a++)r.push(this.createTimeout(a,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(a,t)),r.sort((function(e,t){return e-t})),r},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return r=Math.min(r,t.maxTimeout)},t.wrap=function(e,n,r){if(n instanceof Array&&(r=n,n=null),!r)for(var a in r=[],e)"function"===typeof e[a]&&r.push(a);for(var i=0;i<r.length;i++){var s=r[i],o=e[s];e[s]=function(r){var a=t.operation(n),i=Array.prototype.slice.call(arguments,1),s=i.pop();i.push((function(e){a.retry(e)||(e&&(arguments[0]=a.mainError()),s.apply(this,arguments))})),a.attempt((function(){r.apply(e,i)}))}.bind(e,o),e[s].options=n}}},5790:e=>{function t(e,t){"boolean"===typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1)}var r=this;return this._timer=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var a=this._errors[r],i=a.message,s=(e[i]||0)+1;e[i]=s,s>=n&&(t=a,n=s)}return t}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,C(x);else{var t=r(u);null!==t&&R(_,t.startTime-e)}}function x(e,n){m=!1,g&&(g=!1,v(O),O=-1),f=!0;var i=p;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&a(c),w(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&R(_,d.startTime-n),l=!1}return l}finally{h=null,p=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,k=!1,S=null,O=-1,P=5,T=-1;function N(){return!(t.unstable_now()-T<P)}function j(){if(null!==S){var e=t.unstable_now();T=e;var n=!0;try{n=S(!0,e)}finally{n?E():(k=!1,S=null)}}else k=!1}if("function"===typeof b)E=function(){b(j)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,A=I.port2;I.port1.onmessage=j,E=function(){A.postMessage(null)}}else E=function(){y(j,0)};function C(e){S=e,k||(k=!0,E())}function R(e,n){O=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,C(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(g?(v(O),O=-1):g=!0,R(_,i-s))):(e.sortIndex=o,n(c,e),m||f||(m=!0,C(x))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},3383:(e,t,n)=>{const r=Symbol("SemVer ANY");class a{static get ANY(){return r}constructor(e,t){if(t=i(t),e instanceof a){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?s[o.COMPARATORLOOSE]:s[o.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new u(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"===typeof e)try{e=new u(e,this.options)}catch(t){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof a))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):(!(t=i(t)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}e.exports=a;const i=n(6272),{safeRe:s,t:o}=n(1323),l=n(538),c=n(1411),u=n(8207),d=n(7458)},7458:(e,t,n)=>{const r=/\s+/g;class a{constructor(e,t){if(t=s(t),e instanceof a)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new a(e.raw,t);if(e instanceof o)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(r," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!y(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&v(t[0])){this.set=[t];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&m)|(this.options.loose&&g))+":"+e,n=i.get(t);if(n)return n;const r=this.options.loose,a=r?u[d.HYPHENRANGELOOSE]:u[d.HYPHENRANGE];e=e.replace(a,j(this.options.includePrerelease)),l("hyphen replace",e),e=e.replace(u[d.COMPARATORTRIM],h),l("comparator trim",e),e=e.replace(u[d.TILDETRIM],p),l("tilde trim",e),e=e.replace(u[d.CARETTRIM],f),l("caret trim",e);let s=e.split(" ").map((e=>w(e,this.options))).join(" ").split(/\s+/).map((e=>N(e,this.options)));r&&(s=s.filter((e=>(l("loose invalid filter",e,this.options),!!e.match(u[d.COMPARATORLOOSE]))))),l("range list",s);const c=new Map,v=s.map((e=>new o(e,this.options)));for(const i of v){if(y(i))return[i];c.set(i.value,i)}c.size>1&&c.has("")&&c.delete("");const b=[...c.values()];return i.set(t,b),b}intersects(e,t){if(!(e instanceof a))throw new TypeError("a Range is required");return this.set.some((n=>b(n,t)&&e.set.some((e=>b(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"===typeof e)try{e=new c(e,this.options)}catch(t){return!1}for(let n=0;n<this.set.length;n++)if(I(this.set[n],e,this.options))return!0;return!1}}e.exports=a;const i=new(n(4371)),s=n(6272),o=n(3383),l=n(1411),c=n(8207),{safeRe:u,t:d,comparatorTrimReplace:h,tildeTrimReplace:p,caretTrimReplace:f}=n(1323),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:g}=n(6225),y=e=>"<0.0.0-0"===e.value,v=e=>""===e.value,b=(e,t)=>{let n=!0;const r=e.slice();let a=r.pop();for(;n&&r.length;)n=r.every((e=>a.intersects(e,t))),a=r.pop();return n},w=(e,t)=>(l("comp",e,t),e=k(e,t),l("caret",e),e=x(e,t),l("tildes",e),e=O(e,t),l("xrange",e),e=T(e,t),l("stars",e),e),_=e=>!e||"x"===e.toLowerCase()||"*"===e,x=(e,t)=>e.trim().split(/\s+/).map((e=>E(e,t))).join(" "),E=(e,t)=>{const n=t.loose?u[d.TILDELOOSE]:u[d.TILDE];return e.replace(n,((t,n,r,a,i)=>{let s;return l("tilde",e,t,n,r,a,i),_(n)?s="":_(r)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:_(a)?s=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:i?(l("replaceTilde pr",i),s=`>=${n}.${r}.${a}-${i} <${n}.${+r+1}.0-0`):s=`>=${n}.${r}.${a} <${n}.${+r+1}.0-0`,l("tilde return",s),s}))},k=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{l("caret",e,t);const n=t.loose?u[d.CARETLOOSE]:u[d.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,a,i,s)=>{let o;return l("caret",e,t,n,a,i,s),_(n)?o="":_(a)?o=`>=${n}.0.0${r} <${+n+1}.0.0-0`:_(i)?o="0"===n?`>=${n}.${a}.0${r} <${n}.${+a+1}.0-0`:`>=${n}.${a}.0${r} <${+n+1}.0.0-0`:s?(l("replaceCaret pr",s),o="0"===n?"0"===a?`>=${n}.${a}.${i}-${s} <${n}.${a}.${+i+1}-0`:`>=${n}.${a}.${i}-${s} <${n}.${+a+1}.0-0`:`>=${n}.${a}.${i}-${s} <${+n+1}.0.0-0`):(l("no pr"),o="0"===n?"0"===a?`>=${n}.${a}.${i}${r} <${n}.${a}.${+i+1}-0`:`>=${n}.${a}.${i}${r} <${n}.${+a+1}.0-0`:`>=${n}.${a}.${i} <${+n+1}.0.0-0`),l("caret return",o),o}))},O=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map((e=>P(e,t))).join(" ")),P=(e,t)=>{e=e.trim();const n=t.loose?u[d.XRANGELOOSE]:u[d.XRANGE];return e.replace(n,((n,r,a,i,s,o)=>{l("xRange",e,n,r,a,i,s,o);const c=_(a),u=c||_(i),d=u||_(s),h=d;return"="===r&&h&&(r=""),o=t.includePrerelease?"-0":"",c?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&h?(u&&(i=0),s=0,">"===r?(r=">=",u?(a=+a+1,i=0,s=0):(i=+i+1,s=0)):"<="===r&&(r="<",u?a=+a+1:i=+i+1),"<"===r&&(o="-0"),n=`${r+a}.${i}.${s}${o}`):u?n=`>=${a}.0.0${o} <${+a+1}.0.0-0`:d&&(n=`>=${a}.${i}.0${o} <${a}.${+i+1}.0-0`),l("xRange return",n),n}))},T=(e,t)=>(l("replaceStars",e,t),e.trim().replace(u[d.STAR],"")),N=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),j=e=>(t,n,r,a,i,s,o,l,c,u,d,h)=>`${n=_(r)?"":_(a)?`>=${r}.0.0${e?"-0":""}`:_(i)?`>=${r}.${a}.0${e?"-0":""}`:s?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=_(c)?"":_(u)?`<${+c+1}.0.0-0`:_(d)?`<${c}.${+u+1}.0-0`:h?`<=${c}.${u}.${d}-${h}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),I=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(l(e[n].semver),e[n].semver!==o.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},8207:(e,t,n)=>{const r=n(1411),{MAX_LENGTH:a,MAX_SAFE_INTEGER:i}=n(6225),{safeRe:s,t:o}=n(1323),l=n(6272),{compareIdentifiers:c}=n(9520);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!==typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[o.LOOSE]:s[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"===typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],a=e.prerelease[t];if(r("prerelease compare",t,n,a),void 0===n&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===n)return-1;if(n!==a)return c(n,a)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const n=this.build[t],a=e.build[t];if(r("build compare",t,n,a),void 0===n&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===n)return-1;if(n!==a)return c(n,a)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"===typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},4747:(e,t,n)=>{const r=n(4501);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},538:(e,t,n)=>{const r=n(7814),a=n(9930),i=n(6187),s=n(9896),o=n(7508),l=n(4369);e.exports=(e,t,n,c)=>{switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e===n;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,c);case"!=":return a(e,n,c);case">":return i(e,n,c);case">=":return s(e,n,c);case"<":return o(e,n,c);case"<=":return l(e,n,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},7525:(e,t,n)=>{const r=n(8207),a=n(4501),{safeRe:i,t:s}=n(1323);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;let n=null;if((t=t||{}).rtl){const r=t.includePrerelease?i[s.COERCERTLFULL]:i[s.COERCERTL];let a;for(;(a=r.exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&a.index+a[0].length===n.index+n[0].length||(n=a),r.lastIndex=a.index+a[1].length+a[2].length;r.lastIndex=-1}else n=e.match(t.includePrerelease?i[s.COERCEFULL]:i[s.COERCE]);if(null===n)return null;const o=n[2],l=n[3]||"0",c=n[4]||"0",u=t.includePrerelease&&n[5]?`-${n[5]}`:"",d=t.includePrerelease&&n[6]?`+${n[6]}`:"";return a(`${o}.${l}.${c}${u}${d}`,t)}},8356:(e,t,n)=>{const r=n(8207);e.exports=(e,t,n)=>{const a=new r(e,n),i=new r(t,n);return a.compare(i)||a.compareBuild(i)}},5094:(e,t,n)=>{const r=n(3193);e.exports=(e,t)=>r(e,t,!0)},3193:(e,t,n)=>{const r=n(8207);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},6627:(e,t,n)=>{const r=n(4501);e.exports=(e,t)=>{const n=r(e,null,!0),a=r(t,null,!0),i=n.compare(a);if(0===i)return null;const s=i>0,o=s?n:a,l=s?a:n,c=!!o.prerelease.length;if(!!l.prerelease.length&&!c)return l.patch||l.minor?o.patch?"patch":o.minor?"minor":"major":"major";const u=c?"pre":"";return n.major!==a.major?u+"major":n.minor!==a.minor?u+"minor":n.patch!==a.patch?u+"patch":"prerelease"}},7814:(e,t,n)=>{const r=n(3193);e.exports=(e,t,n)=>0===r(e,t,n)},6187:(e,t,n)=>{const r=n(3193);e.exports=(e,t,n)=>r(e,t,n)>0},9896:(e,t,n)=>{const r=n(3193);e.exports=(e,t,n)=>r(e,t,n)>=0},3974:(e,t,n)=>{const r=n(8207);e.exports=(e,t,n,a,i)=>{"string"===typeof n&&(i=a,a=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,a,i).version}catch(s){return null}}},7508:(e,t,n)=>{const r=n(3193);e.exports=(e,t,n)=>r(e,t,n)<0},4369:(e,t,n)=>{const r=n(3193);e.exports=(e,t,n)=>r(e,t,n)<=0},7963:(e,t,n)=>{const r=n(8207);e.exports=(e,t)=>new r(e,t).major},1647:(e,t,n)=>{const r=n(8207);e.exports=(e,t)=>new r(e,t).minor},9930:(e,t,n)=>{const r=n(3193);e.exports=(e,t,n)=>0!==r(e,t,n)},4501:(e,t,n)=>{const r=n(8207);e.exports=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e instanceof r)return e;try{return new r(e,t)}catch(a){if(!n)return null;throw a}}},4760:(e,t,n)=>{const r=n(8207);e.exports=(e,t)=>new r(e,t).patch},3390:(e,t,n)=>{const r=n(4501);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},3033:(e,t,n)=>{const r=n(3193);e.exports=(e,t,n)=>r(t,e,n)},8020:(e,t,n)=>{const r=n(8356);e.exports=(e,t)=>e.sort(((e,n)=>r(n,e,t)))},7263:(e,t,n)=>{const r=n(7458);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(a){return!1}return t.test(e)}},8644:(e,t,n)=>{const r=n(8356);e.exports=(e,t)=>e.sort(((e,n)=>r(e,n,t)))},2192:(e,t,n)=>{const r=n(4501);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},500:(e,t,n)=>{const r=n(1323),a=n(6225),i=n(8207),s=n(9520),o=n(4501),l=n(2192),c=n(4747),u=n(3974),d=n(6627),h=n(7963),p=n(1647),f=n(4760),m=n(3390),g=n(3193),y=n(3033),v=n(5094),b=n(8356),w=n(8644),_=n(8020),x=n(6187),E=n(7508),k=n(7814),S=n(9930),O=n(9896),P=n(4369),T=n(538),N=n(7525),j=n(3383),I=n(7458),A=n(7263),C=n(4074),R=n(2285),$=n(3359),L=n(1390),M=n(1061),D=n(7724),U=n(256),z=n(7497),F=n(7941),B=n(536),H=n(7853);e.exports={parse:o,valid:l,clean:c,inc:u,diff:d,major:h,minor:p,patch:f,prerelease:m,compare:g,rcompare:y,compareLoose:v,compareBuild:b,sort:w,rsort:_,gt:x,lt:E,eq:k,neq:S,gte:O,lte:P,cmp:T,coerce:N,Comparator:j,Range:I,satisfies:A,toComparators:C,maxSatisfying:R,minSatisfying:$,minVersion:L,validRange:M,outside:D,gtr:U,ltr:z,intersects:F,simplifyRange:B,subset:H,SemVer:i,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:a.SEMVER_SPEC_VERSION,RELEASE_TYPES:a.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}},6225:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},1411:e=>{const t="object"===typeof process&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{};e.exports=t},9520:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),a=t.test(n);return r&&a&&(e=+e,n=+n),e===n?0:r&&!a?-1:a&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},4371:e=>{e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},6272:e=>{const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!==typeof e?t:e:n},1323:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:a,MAX_LENGTH:i}=n(6225),s=n(1411),o=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.t={};let d=0;const h="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",i],[h,a]],f=(e,t,n)=>{const r=(e=>{for(const[t,n]of p)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),a=d++;s(e,a,t),u[e]=a,c[a]=t,o[a]=new RegExp(t,n?"g":void 0),l[a]=new RegExp(r,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),f("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${c[u.NUMERICIDENTIFIER]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NUMERICIDENTIFIERLOOSE]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${h}+`),f("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`),f("FULL",`^${c[u.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`),f("LOOSE",`^${c[u.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?)?)?`),f("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),f("COERCE",`${c[u.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",c[u.COERCEPLAIN]+`(?:${c[u.PRERELEASE]})?`+`(?:${c[u.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",c[u.COERCE],!0),f("COERCERTLFULL",c[u.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})\\s+-\\s+(${c[u.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[u.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},256:(e,t,n)=>{const r=n(7724);e.exports=(e,t,n)=>r(e,t,">",n)},7941:(e,t,n)=>{const r=n(7458);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t,n))},7497:(e,t,n)=>{const r=n(7724);e.exports=(e,t,n)=>r(e,t,"<",n)},2285:(e,t,n)=>{const r=n(8207),a=n(7458);e.exports=(e,t,n)=>{let i=null,s=null,o=null;try{o=new a(t,n)}catch(l){return null}return e.forEach((e=>{o.test(e)&&(i&&-1!==s.compare(e)||(i=e,s=new r(i,n)))})),i}},3359:(e,t,n)=>{const r=n(8207),a=n(7458);e.exports=(e,t,n)=>{let i=null,s=null,o=null;try{o=new a(t,n)}catch(l){return null}return e.forEach((e=>{o.test(e)&&(i&&1!==s.compare(e)||(i=e,s=new r(i,n)))})),i}},1390:(e,t,n)=>{const r=n(8207),a=n(7458),i=n(6187);e.exports=(e,t)=>{e=new a(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let a=0;a<e.set.length;++a){const t=e.set[a];let s=null;t.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!i(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||n&&!i(n,s)||(n=s)}return n&&e.test(n)?n:null}},7724:(e,t,n)=>{const r=n(8207),a=n(3383),{ANY:i}=a,s=n(7458),o=n(7263),l=n(6187),c=n(7508),u=n(4369),d=n(9896);e.exports=(e,t,n,h)=>{let p,f,m,g,y;switch(e=new r(e,h),t=new s(t,h),n){case">":p=l,f=u,m=c,g=">",y=">=";break;case"<":p=c,f=d,m=l,g="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,h))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let s=null,o=null;if(n.forEach((e=>{e.semver===i&&(e=new a(">=0.0.0")),s=s||e,o=o||e,p(e.semver,s.semver,h)?s=e:m(e.semver,o.semver,h)&&(o=e)})),s.operator===g||s.operator===y)return!1;if((!o.operator||o.operator===g)&&f(e,o.semver))return!1;if(o.operator===y&&m(e,o.semver))return!1}return!0}},536:(e,t,n)=>{const r=n(7263),a=n(3193);e.exports=(e,t,n)=>{const i=[];let s=null,o=null;const l=e.sort(((e,t)=>a(e,t,n)));for(const a of l){r(a,t,n)?(o=a,s||(s=a)):(o&&i.push([s,o]),o=null,s=null)}s&&i.push([s,null]);const c=[];for(const[r,a]of i)r===a?c.push(r):a||r!==l[0]?a?r===l[0]?c.push(`<=${a}`):c.push(`${r} - ${a}`):c.push(`>=${r}`):c.push("*");const u=c.join(" || "),d="string"===typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},7853:(e,t,n)=>{const r=n(7458),a=n(3383),{ANY:i}=a,s=n(7263),o=n(3193),l=[new a(">=0.0.0-0")],c=[new a(">=0.0.0")],u=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=n.includePrerelease?l:c}if(1===t.length&&t[0].semver===i){if(n.includePrerelease)return!0;t=c}const r=new Set;let a,u,p,f,m,g,y;for(const i of e)">"===i.operator||">="===i.operator?a=d(a,i,n):"<"===i.operator||"<="===i.operator?u=h(u,i,n):r.add(i.semver);if(r.size>1)return null;if(a&&u){if(p=o(a.semver,u.semver,n),p>0)return null;if(0===p&&(">="!==a.operator||"<="!==u.operator))return null}for(const i of r){if(a&&!s(i,String(a),n))return null;if(u&&!s(i,String(u),n))return null;for(const e of t)if(!s(i,String(e),n))return!1;return!0}let v=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver,b=!(!a||n.includePrerelease||!a.semver.prerelease.length)&&a.semver;v&&1===v.prerelease.length&&"<"===u.operator&&0===v.prerelease[0]&&(v=!1);for(const i of t){if(y=y||">"===i.operator||">="===i.operator,g=g||"<"===i.operator||"<="===i.operator,a)if(b&&i.semver.prerelease&&i.semver.prerelease.length&&i.semver.major===b.major&&i.semver.minor===b.minor&&i.semver.patch===b.patch&&(b=!1),">"===i.operator||">="===i.operator){if(f=d(a,i,n),f===i&&f!==a)return!1}else if(">="===a.operator&&!s(a.semver,String(i),n))return!1;if(u)if(v&&i.semver.prerelease&&i.semver.prerelease.length&&i.semver.major===v.major&&i.semver.minor===v.minor&&i.semver.patch===v.patch&&(v=!1),"<"===i.operator||"<="===i.operator){if(m=h(u,i,n),m===i&&m!==u)return!1}else if("<="===u.operator&&!s(u.semver,String(i),n))return!1;if(!i.operator&&(u||a)&&0!==p)return!1}return!(a&&g&&!u&&0!==p)&&(!(u&&y&&!a&&0!==p)&&(!b&&!v))},d=(e,t,n)=>{if(!e)return t;const r=o(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},h=(e,t,n)=>{if(!e)return t;const r=o(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;e=new r(e,n),t=new r(t,n);let a=!1;e:for(const r of e.set){for(const e of t.set){const t=u(r,e,n);if(a=a||null!==t,t)continue e}if(a)return!1}return!0}},4074:(e,t,n)=>{const r=n(7458);e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},1061:(e,t,n)=>{const r=n(7458);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(n){return null}}},8139:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,i(n)))}return e}function i(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=s(t,n));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},9915:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var r=n(8693),a=n(7623),i=n(4070);class s{}class o extends s{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,(0,a.Z)(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:"false"===(0,i.Az)("LANGCHAIN_CALLBACKS_BACKGROUND")}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return a.y.prototype.toJSON.call(this)}toJSONNotImplemented(){return a.y.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){return new class extends o{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:r.A()}),Object.assign(this,e)}}}}},6480:(e,t,n)=>{"use strict";n.d(t,{Td:()=>N,tW:()=>j,H_:()=>x});var r=n(8693),a=n(9915),i=n(6503),s=n(3653);function o(e,t){return`${e.open}${t}${e.close}`}function l(e,t){try{return JSON.stringify(e,null,2)}catch(n){return t}}function c(e){return"string"===typeof e?e.trim():null===e||void 0===e?e:l(e,e.toString())}function u(e){if(!e.end_time)return"";const t=e.end_time-e.start_time;return t<1e3?`${t}ms`:`${(t/1e3).toFixed(2)}s`}const{color:d}=i;class h extends s.J{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let n=e;for(;n.parent_run_id;){const e=this.runMap.get(n.parent_run_id);if(!e)break;t.push(e),n=e}return t}getBreadcrumbs(e){const t=[...this.getParents(e).reverse(),e].map(((e,t,n)=>{const r=`${e.execution_order}:${e.run_type}:${e.name}`;return t===n.length-1?o(i.bold,r):r})).join(" > ");return o(d.grey,t)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.green,"[chain/start]")} [${t}] Entering Chain run with input: ${l(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.cyan,"[chain/end]")} [${t}] [${u(e)}] Exiting Chain run with output: ${l(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.red,"[chain/error]")} [${t}] [${u(e)}] Chain run errored with error: ${l(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map((e=>e.trim()))}:e.inputs;console.log(`${o(d.green,"[llm/start]")} [${t}] Entering LLM run with input: ${l(n,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.cyan,"[llm/end]")} [${t}] [${u(e)}] Exiting LLM run with output: ${l(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.red,"[llm/error]")} [${t}] [${u(e)}] LLM run errored with error: ${l(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.green,"[tool/start]")} [${t}] Entering Tool run with input: "${c(e.inputs.input)}"`)}onToolEnd(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.cyan,"[tool/end]")} [${t}] [${u(e)}] Exiting Tool run with output: "${c(e.outputs?.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.red,"[tool/error]")} [${t}] [${u(e)}] Tool run errored with error: ${l(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${l(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.cyan,"[retriever/end]")} [${t}] [${u(e)}] Exiting Retriever run with output: ${l(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${o(d.red,"[retriever/error]")} [${t}] [${u(e)}] Retriever run errored with error: ${l(e.error,"[error]")}`)}onAgentAction(e){const t=e,n=this.getBreadcrumbs(e);console.log(`${o(d.blue,"[agent/action]")} [${n}] Agent selected action: ${l(t.actions[t.actions.length-1],"[action]")}`)}}var p=n(3753),f=n(4070),m=n(572),g=n(8365),y=n(3703);class v extends s.J{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:n,client:r}=e;this.projectName=n??(0,f.Az)("LANGCHAIN_PROJECT")??(0,f.Az)("LANGCHAIN_SESSION"),this.exampleId=t;const a="false"===(0,f.Az)("LANGCHAIN_CALLBACKS_BACKGROUND")?{blockOnRootRunFinalization:!0}:{};this.client=r??new m.Kj(a);const i=v.getTraceableRunTree();i&&this.updateFromRunTree(i)}async _convertToCreate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return{...e,extra:{...e.extra,runtime:await(0,f.Ec)()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let t=e;const n=new Set;for(;t.parent_run&&!n.has(t.id)&&(n.add(t.id),t.parent_run);)t=t.parent_run;n.clear();const r=[t];for(;r.length>0;){const e=r.shift();e&&!n.has(e.id)&&(n.add(e.id),this.runMap.set(e.id,e),e.child_runs&&r.push(...e.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const t={},n=[];for(const[r,a]of this.runMap){const e=new g.gk({...a,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});t[r]=e,n.push([r,a.dotted_order])}n.sort(((e,t)=>e[1]&&t[1]?e[1].localeCompare(t[1]):0));for(const[r]of n){const e=this.runMap.get(r),n=t[r];if(e&&n&&e.parent_run_id){const r=t[e.parent_run_id];r&&(r.child_runs.push(n),n.parent_run=r)}}return t[e]}static getTraceableRunTree(){try{return(0,y.vR)()}catch{return}}}var b=n(5623);let w;async function _(e,t){!0===t?await e():("undefined"===typeof w&&(w=new(0,b.default)({autoStart:!0,concurrency:1})),w.add(e))}function x(e){return e?Array.isArray(e)||"name"in e?{callbacks:e}:e:{}}class E{setHandler(e){return this.setHandlers([e])}}class k{constructor(e,t,n,r,a,i,s,o){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:o})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map((t=>_((async()=>{try{await(t.handleText?.(e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${n}`),t.raiseError)throw n}}),t.awaitHandlers))))}async handleCustomEvent(e,t,n,r,a){await Promise.all(this.handlers.map((n=>_((async()=>{try{await(n.handleCustomEvent?.(e,t,this.runId,this.tags,this.metadata))}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleCustomEvent: ${r}`),n.raiseError)throw r}}),n.awaitHandlers))))}}class S extends k{getChild(e){const t=new N(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreRetriever)try{await(t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw n}}),t.awaitHandlers))))}async handleRetrieverError(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreRetriever)try{await(t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${n}`),t.raiseError)throw e}}),t.awaitHandlers))))}}class O extends k{async handleLLMNewToken(e,t,n,r,a,i){await Promise.all(this.handlers.map((n=>_((async()=>{if(!n.ignoreLLM)try{await(n.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,i))}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleLLMNewToken: ${r}`),n.raiseError)throw r}}),n.awaitHandlers))))}async handleLLMError(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreLLM)try{await(t.handleLLMError?.(e,this.runId,this._parentRunId,this.tags))}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMError: ${e}`),t.raiseError)throw e}}),t.awaitHandlers))))}async handleLLMEnd(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreLLM)try{await(t.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleLLMEnd: ${n}`),t.raiseError)throw n}}),t.awaitHandlers))))}}class P extends k{getChild(e){const t=new N(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,n,r,a){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreChain)try{await(t.handleChainError?.(e,this.runId,this._parentRunId,this.tags,a))}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleChainError: ${e}`),t.raiseError)throw e}}),t.awaitHandlers))))}async handleChainEnd(e,t,n,r,a){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreChain)try{await(t.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,a))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleChainEnd: ${n}`),t.raiseError)throw n}}),t.awaitHandlers))))}async handleAgentAction(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreAgent)try{await(t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${n}`),t.raiseError)throw n}}),t.awaitHandlers))))}async handleAgentEnd(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreAgent)try{await(t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${n}`),t.raiseError)throw n}}),t.awaitHandlers))))}}class T extends k{getChild(e){const t=new N(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreAgent)try{await(t.handleToolError?.(e,this.runId,this._parentRunId,this.tags))}catch(e){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${e}`),t.raiseError)throw e}}),t.awaitHandlers))))}async handleToolEnd(e){await Promise.all(this.handlers.map((t=>_((async()=>{if(!t.ignoreAgent)try{await(t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(n){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${n}`),t.raiseError)throw n}}),t.awaitHandlers))))}}class N extends E{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=t?.handlers??this.handlers,this.inheritableHandlers=t?.inheritableHandlers??this.inheritableHandlers,this.tags=t?.tags??this.tags,this.inheritableTags=t?.inheritableTags??this.inheritableTags,this.metadata=t?.metadata??this.metadata,this.inheritableMetadata=t?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;return Promise.all(t.map((async(t,o)=>{const l=0===o&&n?n:(0,r.A)();return await Promise.all(this.handlers.map((n=>{if(!n.ignoreLLM)return(0,s.j)(n)&&n._createRunForLLMStart(e,[t],l,this._parentRunId,a,this.tags,this.metadata,i),_((async()=>{try{await(n.handleLLMStart?.(e,[t],l,this._parentRunId,a,this.tags,this.metadata,i))}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleLLMStart: ${r}`),n.raiseError)throw r}}),n.awaitHandlers)}))),new O(l,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)})))}async handleChatModelStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;return Promise.all(t.map((async(t,o)=>{const l=0===o&&n?n:(0,r.A)();return await Promise.all(this.handlers.map((n=>{if(!n.ignoreLLM)return(0,s.j)(n)&&n._createRunForChatModelStart(e,[t],l,this._parentRunId,a,this.tags,this.metadata,i),_((async()=>{try{if(n.handleChatModelStart)await(n.handleChatModelStart?.(e,[t],l,this._parentRunId,a,this.tags,this.metadata,i));else if(n.handleLLMStart){const r=(0,p.Sw)(t);await(n.handleLLMStart?.(e,[r],l,this._parentRunId,a,this.tags,this.metadata,i))}}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleLLMStart: ${r}`),n.raiseError)throw r}}),n.awaitHandlers)}))),new O(l,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)})))}async handleChainStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,r.A)(),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return await Promise.all(this.handlers.map((r=>{if(!r.ignoreChain)return(0,s.j)(r)&&r._createRunForChainStart(e,t,n,this._parentRunId,this.tags,this.metadata,a,i),_((async()=>{try{await(r.handleChainStart?.(e,t,n,this._parentRunId,this.tags,this.metadata,a,i))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleChainStart: ${s}`),r.raiseError)throw s}}),r.awaitHandlers)}))),new P(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,r.A)(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return await Promise.all(this.handlers.map((r=>{if(!r.ignoreAgent)return(0,s.j)(r)&&r._createRunForToolStart(e,t,n,this._parentRunId,this.tags,this.metadata,a),_((async()=>{try{await(r.handleToolStart?.(e,t,n,this._parentRunId,this.tags,this.metadata,a))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleToolStart: ${i}`),r.raiseError)throw i}}),r.awaitHandlers)}))),new T(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,r.A)(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return await Promise.all(this.handlers.map((r=>{if(!r.ignoreRetriever)return(0,s.j)(r)&&r._createRunForRetrieverStart(e,t,n,this._parentRunId,this.tags,this.metadata,a),_((async()=>{try{await(r.handleRetrieverStart?.(e,t,n,this._parentRunId,this.tags,this.metadata,a))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleRetrieverStart: ${i}`),r.raiseError)throw i}}),r.awaitHandlers)}))),new S(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,n,r,a){await Promise.all(this.handlers.map((r=>_((async()=>{if(!r.ignoreCustomEvent)try{await(r.handleCustomEvent?.(e,t,n,this.tags,this.metadata))}catch(a){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleCustomEvent: ${a}`),r.raiseError)throw a}}),r.awaitHandlers))))}addHandler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter((t=>t!==e)),this.inheritableHandlers=this.inheritableHandlers.filter((t=>t!==e))}setHandlers(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.handlers=[],this.inheritableHandlers=[];for(const n of e)this.addHandler(n,t)}addTags(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter((t=>!e.includes(t))),this.inheritableTags=this.inheritableTags.filter((t=>!e.includes(t)))}addMetadata(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=new N(this._parentRunId);for(const r of this.handlers){const e=this.inheritableHandlers.includes(r);n.addHandler(r,e)}for(const r of this.tags){const e=this.inheritableTags.includes(r);n.addTags([r],e)}for(const r of Object.keys(this.metadata)){const e=Object.keys(this.inheritableMetadata).includes(r);n.addMetadata({[r]:this.metadata[r]},e)}for(const r of e)n.handlers.filter((e=>"console_callback_handler"===e.name)).some((e=>e.name===r.name))||n.addHandler(r,t);return n}static fromHandlers(e){class t extends a.N{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:(0,r.A)()}),Object.assign(this,e)}}const n=new this;return n.addHandler(new t),n}static configure(e,t,n,r,a,i,s){return this._configureSync(e,t,n,r,a,i,s)}static _configureSync(e,t,n,r,a,i,s){let o;(e||t)&&(Array.isArray(e)||!e?(o=new N,o.setHandlers(e?.map(j)??[],!0)):o=e,o=o.copy(Array.isArray(t)?t.map(j):t?.handlers,!1));const l="true"===(0,f.Az)("LANGCHAIN_VERBOSE")||s?.verbose,c=v.getTraceableRunTree()?.tracingEnabled||(e=>void 0!==e?e:!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find((e=>"true"===(0,f.Az)(e))))(),u=c||((0,f.Az)("LANGCHAIN_TRACING")??!1);if(l||u){if(o||(o=new N),l&&!o.handlers.some((e=>e.name===h.prototype.name))){const e=new h;o.addHandler(e,!0)}if(u&&!o.handlers.some((e=>"langchain_tracer"===e.name))&&c){const e=new v;o.addHandler(e,!0),o._parentRunId=v.getTraceableRunTree()?.id??o._parentRunId}}return(n||r)&&o&&(o.addTags(n??[]),o.addTags(r??[],!1)),(a||i)&&o&&(o.addMetadata(a??{}),o.addMetadata(i??{},!1)),o}}function j(e){return"name"in e?e:a.N.fromMethods(e)}},5527:(e,t,n)=>{"use strict";function r(e,t){return e.lc_error_code=t,e.message=`${e.message}\n\nTroubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/\n`,e}n.d(t,{Y:()=>r})},7623:(e,t,n)=>{"use strict";n.d(t,{y:()=>c,Z:()=>l});var r=n(3047);n(9894);function a(e,t){return t?.[e]||r(e)}function i(e,t,n){const r={};for(const a in e)Object.hasOwn(e,a)&&(r[t(a,n)]=e[a]);return r}function s(e){return Array.isArray(e)?[...e]:{...e}}function o(e,t){const n=s(e);for(const[r,a]of Object.entries(t)){const[e,...t]=r.split(".").reverse();let i=n;for(const n of t.reverse()){if(void 0===i[n])break;i[n]=s(i[n]),i=i[n]}void 0!==i[e]&&(i[e]={lc:1,type:"secret",id:[a]})}return n}function l(e){const t=Object.getPrototypeOf(e);return"function"===typeof e.lc_name&&("function"!==typeof t.lc_name||e.lc_name()!==t.lc_name())?e.lc_name():e.name}class c{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,l(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof c||"object"!==typeof this.lc_kwargs||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},n=Object.keys(this.lc_kwargs).reduce(((e,t)=>(e[t]=t in this?this[t]:this.lc_kwargs[t],e)),{});for(let r=Object.getPrototypeOf(this);r;r=Object.getPrototypeOf(r))Object.assign(e,Reflect.get(r,"lc_aliases",this)),Object.assign(t,Reflect.get(r,"lc_secrets",this)),Object.assign(n,Reflect.get(r,"lc_attributes",this));return Object.keys(t).forEach((e=>{let t=this,r=n;const[a,...i]=e.split(".").reverse();for(const n of i.reverse()){if(!(n in t)||void 0===t[n])return;n in r&&void 0!==r[n]||("object"===typeof t[n]&&null!=t[n]?r[n]={}:Array.isArray(t[n])&&(r[n]=[])),t=t[n],r=r[n]}a in t&&void 0!==t[a]&&(r[a]=r[a]||t[a])})),{lc:1,type:"constructor",id:this.lc_id,kwargs:i(Object.keys(t).length?o(n,t):n,a,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}},1388:(e,t,n)=>{"use strict";n.d(t,{H:()=>c,KX:()=>o,Od:()=>s,jm:()=>l});var r=n(9523),a=n(543),i=n(6628);class s extends a.XQ{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){let n;if("string"===typeof e)n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{n=e;const t=n.additional_kwargs?.tool_calls,a=n.tool_calls;null!=t&&t.length>0&&(void 0===a||0===a.length)&&console.warn(["New LangChain packages are available that more efficiently handle","tool calling.\n\nPlease upgrade your packages to versions that set","message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(null!=t&&void 0===a){const[e,r]=(0,i.p1)(t);n.tool_calls=e??[],n.invalid_tool_calls=r??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch(r){n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"string"!==typeof n&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function o(e){return"ai"===e._getType()}function l(e){return"ai"===e._getType()}class c extends a.gj{constructor(e){let t;if("string"===typeof e)t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(void 0===e.tool_call_chunks)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:void 0!==e.usage_metadata?e.usage_metadata:void 0};else{const a=[],i=[];for(const t of e.tool_call_chunks){let e={};try{if(e=(0,r.d)(t.args||"{}"),null===e||"object"!==typeof e||Array.isArray(e))throw new Error("Malformed tool call chunk args.");a.push({name:t.name??"",args:e,id:t.id,type:"tool_call"})}catch(n){i.push({name:t.name,args:t.args,id:t.id,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:a,invalid_tool_calls:i,usage_metadata:void 0!==e.usage_metadata?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const t={content:(0,a._I)(this.content,e.content),additional_kwargs:(0,a.ns)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,a.ns)(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(void 0!==this.tool_call_chunks||void 0!==e.tool_call_chunks){const n=(0,a.Vt)(this.tool_call_chunks,e.tool_call_chunks);void 0!==n&&n.length>0&&(t.tool_call_chunks=n)}if(void 0!==this.usage_metadata||void 0!==e.usage_metadata){const n={...(void 0!==this.usage_metadata?.input_token_details?.audio||void 0!==e.usage_metadata?.input_token_details?.audio)&&{audio:(this.usage_metadata?.input_token_details?.audio??0)+(e.usage_metadata?.input_token_details?.audio??0)},...(void 0!==this.usage_metadata?.input_token_details?.cache_read||void 0!==e.usage_metadata?.input_token_details?.cache_read)&&{cache_read:(this.usage_metadata?.input_token_details?.cache_read??0)+(e.usage_metadata?.input_token_details?.cache_read??0)},...(void 0!==this.usage_metadata?.input_token_details?.cache_creation||void 0!==e.usage_metadata?.input_token_details?.cache_creation)&&{cache_creation:(this.usage_metadata?.input_token_details?.cache_creation??0)+(e.usage_metadata?.input_token_details?.cache_creation??0)}},r={...(void 0!==this.usage_metadata?.output_token_details?.audio||void 0!==e.usage_metadata?.output_token_details?.audio)&&{audio:(this.usage_metadata?.output_token_details?.audio??0)+(e.usage_metadata?.output_token_details?.audio??0)},...(void 0!==this.usage_metadata?.output_token_details?.reasoning||void 0!==e.usage_metadata?.output_token_details?.reasoning)&&{reasoning:(this.usage_metadata?.output_token_details?.reasoning??0)+(e.usage_metadata?.output_token_details?.reasoning??0)}},a=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},i=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},s={input_tokens:a.input_tokens+i.input_tokens,output_tokens:a.output_tokens+i.output_tokens,total_tokens:a.total_tokens+i.total_tokens,...Object.keys(n).length>0&&{input_token_details:n},...Object.keys(r).length>0&&{output_token_details:r}};t.usage_metadata=s}return new c(t)}}},543:(e,t,n)=>{"use strict";n.d(t,{AJ:()=>p,F7:()=>c,Iv:()=>i,Vt:()=>l,XQ:()=>s,_I:()=>a,dp:()=>d,gj:()=>u,ns:()=>o,ny:()=>h});var r=n(7623);function a(e,t){return"string"===typeof e?"string"===typeof t?e+t:[{type:"text",text:e},...t]:Array.isArray(t)?l(e,t)??[...e,...t]:[...e,{type:"text",text:t}]}function i(e,t){return"error"===e||"error"===t?"error":"success"}class s extends r.y{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return"string"===typeof this.content?this.content:""}getType(){return this._getType()}constructor(e,t){"string"===typeof e&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(null===e)return this;const t=(n=this._printableFields,r=Math.max(4,e),JSON.stringify(function e(t,n){if("object"!==typeof t||null===t||void 0===t)return t;if(n>=r)return Array.isArray(t)?"[Array]":"[Object]";if(Array.isArray(t))return t.map((t=>e(t,n+1)));const a={};for(const r of Object.keys(t))a[r]=e(t[r],n+1);return a}(n,0),null,2));var n,r;return`${this.constructor.lc_name()} ${t}`}}function o(e,t){const n={...e};for(const[r,a]of Object.entries(t))if(null==n[r])n[r]=a;else{if(null==a)continue;if(typeof n[r]!==typeof a||Array.isArray(n[r])!==Array.isArray(a))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if("string"===typeof n[r]){if("type"===r)continue;n[r]+=a}else if("object"!==typeof n[r]||Array.isArray(n[r]))if(Array.isArray(n[r]))n[r]=l(n[r],a);else{if(n[r]===a)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}else n[r]=o(n[r],a)}return n}function l(e,t){if(void 0!==e||void 0!==t){if(void 0===e||void 0===t)return e||t;{const n=[...e];for(const e of t)if("object"===typeof e&&"index"in e&&"number"===typeof e.index){const t=n.findIndex((t=>t.index===e.index));-1!==t?n[t]=o(n[t],e):n.push(e)}else{if("object"===typeof e&&"text"in e&&""===e.text)continue;n.push(e)}return n}}}function c(e,t){if(!e&&!t)throw new Error("Cannot merge two undefined objects.");if(e&&t){if(typeof e!==typeof t)throw new Error(`Cannot merge objects of different types.\nLeft ${typeof e}\nRight ${typeof t}`);if("string"===typeof e&&"string"===typeof t)return e+t;if(Array.isArray(e)&&Array.isArray(t))return l(e,t);if("object"===typeof e&&"object"===typeof t)return o(e,t);if(e===t)return e;throw new Error(`Can not merge objects of different types.\nLeft ${e}\nRight ${t}`)}return e||t}class u extends s{}function d(e){return"string"===typeof e.role}function h(e){return"function"===typeof e?._getType}function p(e){return h(e)&&"function"===typeof e.concat}},8024:(e,t,n)=>{"use strict";n.d(t,{XU:()=>i,cM:()=>a});var r=n(543);class a extends r.XQ{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return a}constructor(e,t){"string"===typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return"generic"===e._getType()}get _printableFields(){return{...super._printableFields,role:this.role}}}class i extends r.gj{static lc_name(){return"ChatMessageChunk"}constructor(e,t){"string"===typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new i({content:(0,r._I)(this.content,e.content),additional_kwargs:(0,r.ns)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,r.ns)(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}},7522:(e,t,n)=>{"use strict";n.d(t,{FK:()=>i,mg:()=>a});var r=n(543);class a extends r.XQ{static lc_name(){return"FunctionMessage"}constructor(e,t){"string"===typeof e&&(e={content:e,name:t}),super(e)}_getType(){return"function"}}class i extends r.gj{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new i({content:(0,r._I)(this.content,e.content),additional_kwargs:(0,r.ns)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,r.ns)(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}},141:(e,t,n)=>{"use strict";n.d(t,{a7:()=>i,xc:()=>a});var r=n(543);class a extends r.XQ{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class i extends r.gj{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new i({content:(0,r._I)(this.content,e.content),additional_kwargs:(0,r.ns)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,r.ns)(this.response_metadata,e.response_metadata),id:this.id??e.id})}}},5255:(e,t,n)=>{"use strict";n.d(t,{Od:()=>r.Od,H:()=>r.H,XQ:()=>a.XQ,cM:()=>i.cM,XU:()=>i.XU,FK:()=>s.FK,xc:()=>o.xc,a7:()=>o.a7,tn:()=>l.tn,uU:()=>l.uU,dr:()=>d.dr,K0:()=>c.K0,ih:()=>c.ih,Sw:()=>c.Sw,KX:()=>r.KX,jm:()=>r.jm,ny:()=>a.ny});var r=n(1388),a=n(543),i=n(8024),s=n(7522),o=n(141),l=n(8027),c=n(3753);n(4085);class u extends a.XQ{constructor(e){super({...e,content:""}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e.id}_getType(){return"remove"}get _printableFields(){return{...super._printableFields,id:this.id}}}var d=n(6628);o.xc,o.a7,r.Od,r.H,l.tn,l.uU,d.uf,d.dr,s.mg,s.FK,i.cM,i.XU},8027:(e,t,n)=>{"use strict";n.d(t,{tn:()=>a,uU:()=>i});var r=n(543);class a extends r.XQ{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class i extends r.gj{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new i({content:(0,r._I)(this.content,e.content),additional_kwargs:(0,r.ns)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,r.ns)(this.response_metadata,e.response_metadata),id:this.id??e.id})}}},6628:(e,t,n)=>{"use strict";n.d(t,{dr:()=>i,p1:()=>s,uf:()=>a});var r=n(543);class a extends r.XQ{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,n){"string"===typeof e&&(e={content:e,name:n,tool_call_id:t}),super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return"tool"===e._getType()}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}class i extends r.gj{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new i({content:(0,r._I)(this.content,e.content),additional_kwargs:(0,r.ns)(this.additional_kwargs,e.additional_kwargs),response_metadata:(0,r.ns)(this.response_metadata,e.response_metadata),artifact:(0,r.F7)(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:(0,r.Iv)(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function s(e){const t=[],n=[];for(const a of e)if(a.function){const e=a.function.name;try{const n={name:e||"",args:JSON.parse(a.function.arguments)||{},id:a.id};t.push(n)}catch(r){n.push({name:e,args:a.function.arguments,id:a.id,error:"Malformed args."})}}return[t,n]}},3753:(e,t,n)=>{"use strict";n.d(t,{K0:()=>f,Sw:()=>m,ih:()=>g});var r=n(5527),a=n(4614),i=n(1388),s=n(543),o=n(8024),l=n(7522),c=n(141),u=n(8027),d=n(6628);function h(e){return(0,a.K)(e)?e:"string"===typeof e.id&&"function"===e.type&&"object"===typeof e.function&&null!==e.function&&"arguments"in e.function&&"string"===typeof e.function.arguments&&"name"in e.function&&"string"===typeof e.function.name?{id:e.id,args:JSON.parse(e.function.arguments),name:e.function.name,type:"tool_call"}:e}function p(e){let t,n;if("object"===typeof(a=e)&&null!=a&&1===a.lc&&Array.isArray(a.id)&&null!=a.kwargs&&"object"===typeof a.kwargs){const r=e.id.at(-1);t="HumanMessage"===r||"HumanMessageChunk"===r?"user":"AIMessage"===r||"AIMessageChunk"===r?"assistant":"SystemMessage"===r||"SystemMessageChunk"===r?"system":"unknown",n=e.kwargs}else{const{type:r,...a}=e;t=r,n=a}var a;if("human"===t||"user"===t)return new c.xc(n);if("ai"===t||"assistant"===t){const{tool_calls:e,...t}=n;if(!Array.isArray(e))return new i.Od(n);const r=e.map(h);return new i.Od({...t,tool_calls:r})}if("system"===t)return new u.tn(n);if("tool"===t&&"tool_call_id"in n)return new d.uf({...n,content:n.content,tool_call_id:n.tool_call_id,name:n.name});throw(0,r.Y)(new Error(`Unable to coerce message from array: only human, AI, system, or tool message coercion is currently supported.\n\nReceived: ${JSON.stringify(e,null,2)}`),"MESSAGE_COERCION_FAILURE")}function f(e){if("string"===typeof e)return new c.xc(e);if((0,s.ny)(e))return e;if(Array.isArray(e)){const[t,n]=e;return p({type:t,content:n})}if((0,s.dp)(e)){const{role:t,...n}=e;return p({...n,type:t})}return p(e)}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Human",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AI";const r=[];for(const a of e){let e;if("human"===a._getType())e=t;else if("ai"===a._getType())e=n;else if("system"===a._getType())e="System";else if("function"===a._getType())e="Function";else if("tool"===a._getType())e="Tool";else{if("generic"!==a._getType())throw new Error(`Got unsupported message type: ${a._getType()}`);e=a.role}const i=a.name?`${a.name}, `:"",s="string"===typeof a.content?a.content:JSON.stringify(a.content,null,2);r.push(`${e}: ${i}${s}`)}return r.join("\n")}function g(e){const t=e._getType();if("human"===t)return new c.a7({...e});if("ai"===t){let t={...e};return"tool_calls"in t&&(t={...t,tool_call_chunks:t.tool_calls?.map((e=>({...e,type:"tool_call_chunk",index:void 0,args:JSON.stringify(e.args)})))}),new i.H({...t})}if("system"===t)return new u.uU({...e});if("function"===t)return new l.FK({...e});if(o.cM.isInstance(e))return new o.XU({...e});throw new Error("Unknown message type.")}},1713:(e,t,n)=>{"use strict";n.d(t,{Cf:()=>i,SP:()=>r,mu:()=>a});const r="__run";class a{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new a({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class i extends a{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new i({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}},1774:(e,t,n)=>{"use strict";n.d(t,{HY:()=>o,aB:()=>l,vX:()=>c});var r=n(7623),a=n(141),i=n(3753);class s extends r.y{}class o extends s{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new a.xc(this.value)]}}class l extends s{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return(0,i.Sw)(this.messages)}toChatMessages(){return this.messages}}class c extends s{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new a.xc({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}},4778:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var r=n(4085);class a extends r.YN{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},n={};for(const[r,a]of Object.entries(t))n[r]="string"===typeof a?a:await a();return{...n,...e}}async invoke(e,t){return this._callWithConfig((e=>this.formatPromptValue(e)),e,{...t,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Promise.resolve().then(n.bind(n,6933));return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Promise.resolve().then(n.bind(n,6933));return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await Promise.resolve().then(n.bind(n,3492));return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}},7717:(e,t,n)=>{"use strict";n.d(t,{GL:()=>p,RZ:()=>x,qF:()=>m});var r=n(5255),a=n(1774),i=n(4085),s=n(454),o=n(4778),l=n(6933),c=n(3330),u=n(3849),d=n(5527);class h extends i.YN{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,t){return this._callWithConfig((e=>this.formatMessages(e)),e,{...t,runType:"prompt"})}}class p extends h{static lc_name(){return"MessagesPlaceholder"}constructor(e){"string"===typeof e&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}async formatMessages(e){const t=e[this.variableName];if(this.optional&&!t)return[];if(!t){const e=new Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw e.name="InputFormatError",e}let n;try{n=Array.isArray(t)?t.map(r.K0):[(0,r.K0)(t)]}catch(a){const e="string"===typeof t?t:JSON.stringify(t,null,2),n=new Error([`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.`,`Received value: ${e}`,`Additional message: ${a.message}`].join("\n\n"));throw n.name="InputFormatError",n.lc_error_code=a.lc_error_code,n}return n}}class f extends h{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class m extends o.m{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const t=await this.formatMessages(e);return new a.aB(t)}}class g extends f{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,t){"prompt"in e||(e={prompt:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new r.cM(await this.prompt.format(e),this.role)}static fromTemplate(e,t,n){return new this(l.PromptTemplate.fromTemplate(e,{templateFormat:n?.templateFormat}),t)}}class y extends h{static _messageClass(){throw new Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,t){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let e=[];this.prompt.forEach((t=>{"inputVariables"in t&&(e=e.concat(t.inputVariables))})),this.inputVariables=e}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=t??this.additionalOptions}createMessage(e){const t=this.constructor;if(t._messageClass()){return new(t._messageClass())({content:e})}if(t.chatMessageClass){const n=t.chatMessageClass();return new n({content:e,role:this.getRoleFromMessageClass(n.lc_name())})}throw new Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw new Error("Invalid message class name")}}static fromTemplate(e,t){if("string"===typeof e)return new this(l.PromptTemplate.fromTemplate(e,t));const n=[];for(const r of e)if("string"===typeof r||"object"===typeof r&&"text"in r){let e="";"string"===typeof r?e=r:"string"===typeof r.text&&(e=r.text??"");const a={...t,..."string"!==typeof r?{additionalContentFields:r}:{}};n.push(l.PromptTemplate.fromTemplate(e,a))}else if("object"===typeof r&&"image_url"in r){let e,a=r.image_url??"",i=[];if("string"===typeof a){let n;n="mustache"===t?.templateFormat?(0,u.g2)(a):(0,u.D4)(a);const s=n.flatMap((e=>"variable"===e.type?[e.name]:[]));if((s?.length??0)>0){if(s.length>1)throw new Error(`Only one format variable allowed per image template.\nGot: ${s}\nFrom: ${a}`);i=[s[0]]}else i=[];a={url:a},e=new c.C({template:a,inputVariables:i,templateFormat:t?.templateFormat,additionalContentFields:r})}else{if("object"!==typeof a)throw new Error("Invalid image template");if("url"in a){let e;e="mustache"===t?.templateFormat?(0,u.g2)(a.url):(0,u.D4)(a.url),i=e.flatMap((e=>"variable"===e.type?[e.name]:[]))}else i=[];e=new c.C({template:a,inputVariables:i,templateFormat:t?.templateFormat,additionalContentFields:r})}n.push(e)}return new this({prompt:n,additionalOptions:t})}async format(e){if(this.prompt instanceof s.L){const t=await this.prompt.format(e);return this.createMessage(t)}{const t=[];for(const n of this.prompt){let r={};if(!("inputVariables"in n))throw new Error(`Prompt ${n} does not have inputVariables defined.`);for(const t of n.inputVariables)r||(r={[t]:e[t]}),r={...r,[t]:e[t]};if(n instanceof s.L){const e=await n.format(r);let a;"additionalContentFields"in n&&(a=n.additionalContentFields),t.push({...a,type:"text",text:e})}else if(n instanceof c.C){const e=await n.format(r);let a;"additionalContentFields"in n&&(a=n.additionalContentFields),t.push({...a,type:"image_url",image_url:e})}}return this.createMessage(t)}}async formatMessages(e){return[await this.format(e)]}}class v extends y{static _messageClass(){return r.xc}static lc_name(){return"HumanMessagePromptTemplate"}}class b extends y{static _messageClass(){return r.Od}static lc_name(){return"AIMessagePromptTemplate"}}class w extends y{static _messageClass(){return r.tn}static lc_name(){return"SystemMessagePromptTemplate"}}function _(e,t){if("function"===typeof e.formatMessages||(0,r.ny)(e))return e;if(Array.isArray(e)&&"placeholder"===e[0]){const t=e[1];if("string"!==typeof t||"{"!==t[0]||"}"!==t[t.length-1])throw new Error(`Invalid placeholder template: "${e[1]}". Expected a variable name surrounded by curly braces.`);const n=t.slice(1,-1);return new p({variableName:n,optional:!0})}const n=(0,r.K0)(e);let a;if(a="string"===typeof n.content?n.content:n.content.map((e=>"text"in e?{...e,text:e.text}:"image_url"in e?{...e,image_url:e.image_url}:e)),"human"===n._getType())return v.fromTemplate(a,t);if("ai"===n._getType())return b.fromTemplate(a,t);if("system"===n._getType())return w.fromTemplate(a,t);if(r.cM.isInstance(n))return g.fromTemplate(n.content,n.role,t);throw new Error(`Could not coerce message prompt template from input. Received message type: "${n._getType()}".`)}class x extends m{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),"mustache"===e.templateFormat&&void 0===e.validateTemplate&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){const e=new Set;for(const s of this.promptMessages)if(!(s instanceof r.XQ))for(const t of s.inputVariables)e.add(t);const t=this.inputVariables,n=new Set(this.partialVariables?t.concat(Object.keys(this.partialVariables)):t),a=new Set([...n].filter((t=>!e.has(t))));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const i=new Set([...e].filter((e=>!n.has(e))));if(i.size>0)throw new Error(`Input variables \`${[...i]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,t){if("string"===typeof e.content)return e;const n=await Promise.all(e.content.map((async e=>{if("image_url"!==e.type)return e;let n="";n="string"===typeof e.image_url?e.image_url:e.image_url.url;const r=l.PromptTemplate.fromTemplate(n,{templateFormat:this.templateFormat}),a=await r.format(t);return"string"!==typeof e.image_url&&"url"in e.image_url?e.image_url.url=a:e.image_url=a,e})));return e.content=n,e}async formatMessages(e){const t=await this.mergePartialAndUserVariables(e);let n=[];for(const a of this.promptMessages)if(a instanceof r.XQ)n.push(await this._parseImagePrompts(a,t));else{const e=a.inputVariables.reduce(((e,n)=>{if(!(n in t)&&("MessagesPlaceholder"!==a.constructor.lc_name()||!a.optional)){throw(0,d.Y)(new Error(`Missing value for input variable \`${n.toString()}\``),"INVALID_PROMPT_INPUT")}return e[n]=t[n],e}),{}),r=await a.formatMessages(e);n=n.concat(r)}return n}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new x(r)}static fromTemplate(e,t){const n=l.PromptTemplate.fromTemplate(e,t),r=new v({prompt:n});return this.fromMessages([r])}static fromMessages(e,t){const n=e.reduce(((e,n)=>e.concat(n instanceof x?n.promptMessages:[_(n,t)])),[]),a=e.reduce(((e,t)=>t instanceof x?Object.assign(e,t.partialVariables):e),Object.create(null)),i=new Set;for(const s of n)if(!(s instanceof r.XQ))for(const e of s.inputVariables)e in a||i.add(e);return new this({...t,inputVariables:[...i],promptMessages:n,partialVariables:a,templateFormat:t?.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}},3492:(e,t,n)=>{"use strict";n.d(t,{FewShotPromptTemplate:()=>o});var r=n(454),a=n(3849),i=n(6933),s=n(7717);class o extends r.L{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:"\n\n"}),Object.defineProperty(this,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),void 0!==this.examples&&void 0!==this.exampleSelector)throw new Error("Only one of 'examples' and 'example_selector' should be provided");if(void 0===this.examples&&void 0===this.exampleSelector)throw new Error("One of 'examples' and 'example_selector' should be provided");if(this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,a.Ns)(this.prefix+this.suffix,this.templateFormat,e)}}_getPromptType(){return"few_shot"}static lc_name(){return"FewShotPromptTemplate"}async getExamples(e){if(void 0!==this.examples)return this.examples;if(void 0!==this.exampleSelector)return this.exampleSelector.selectExamples(e);throw new Error("One of 'examples' and 'example_selector' should be provided")}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new o(r)}async format(e){const t=await this.mergePartialAndUserVariables(e),n=await this.getExamples(t),r=await Promise.all(n.map((e=>this.examplePrompt.format(e)))),i=[this.prefix,...r,this.suffix].join(this.exampleSeparator);return(0,a.Xm)(i,this.templateFormat,t)}serialize(){if(this.exampleSelector||!this.examples)throw new Error("Serializing an example selector is not currently supported");if(void 0!==this.outputParser)throw new Error("Serializing an output parser is not currently supported");return{_type:this._getPromptType(),input_variables:this.inputVariables,example_prompt:this.examplePrompt.serialize(),example_separator:this.exampleSeparator,suffix:this.suffix,prefix:this.prefix,template_format:this.templateFormat,examples:this.examples}}static async deserialize(e){const{example_prompt:t}=e;if(!t)throw new Error("Missing example prompt");const n=await i.PromptTemplate.deserialize(t);let r;if(!Array.isArray(e.examples))throw new Error("Invalid examples format. Only list or string are supported.");return r=e.examples,new o({inputVariables:e.input_variables,examplePrompt:n,examples:r,exampleSeparator:e.example_separator,prefix:e.prefix,suffix:e.suffix,templateFormat:e.template_format})}}s.qF},3330:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});var r=n(1774),a=n(4778),i=n(3849);class s extends a.m{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.additionalContentFields=e.additionalContentFields,this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,i.Ns)([{type:"image_url",image_url:this.template}],this.templateFormat,e)}}_getPromptType(){return"prompt"}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new s(r)}async format(e){const t={};for(const[s,o]of Object.entries(this.template))t[s]="string"===typeof o?(0,i.Xm)(o,this.templateFormat,e):o;const n=e.url||t.url,r=e.detail||t.detail;if(!n)throw new Error("Must provide either an image URL.");if("string"!==typeof n)throw new Error("url must be a string.");const a={url:n};return r&&(a.detail=r),a}async formatPromptValue(e){const t=await this.format(e);return new r.vX(t)}}},6933:(e,t,n)=>{"use strict";n.d(t,{PromptTemplate:()=>i});var r=n(454),a=n(3849);class i extends r.L{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"mustache"===e.templateFormat&&void 0===e.validateTemplate&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if("mustache"===this.templateFormat)throw new Error("Mustache templates cannot be validated.");let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,a.Ns)(this.template,this.templateFormat,e)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return(0,a.Xm)(this.template,this.templateFormat,t)}static fromExamples(e,t,n){const r=[arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",...e,t].join(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\n\n");return new i({inputVariables:n,template:r})}static fromTemplate(e,t){const{templateFormat:n="f-string",...r}=t??{},s=new Set;return(0,a.QC)(e,n).forEach((e=>{"variable"===e.type&&s.add(e.name)})),new i({inputVariables:[...s],templateFormat:n,template:e,...r})}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),n={...this.partialVariables??{},...e},r={...this,inputVariables:t,partialVariables:n};return new i(r)}serialize(){if(void 0!==this.outputParser)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new i({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}},454:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});var r=n(1774),a=n(4778);class i extends a.m{async formatPromptValue(e){const t=await this.format(e);return new r.HY(t)}}},3849:(e,t,n)=>{"use strict";n.d(t,{Ns:()=>I,D4:()=>S,g2:()=>O,QC:()=>j,Xm:()=>N});var r=Object.prototype.toString,a=Array.isArray||function(e){return"[object Array]"===r.call(e)};function i(e){return"function"===typeof e}function s(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"===typeof e&&t in e}var l=RegExp.prototype.test;var c=/\S/;function u(e){return!function(e,t){return l.call(e,t)}(c,e)}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var h=/\s*/,p=/\s+/,f=/\s*=/,m=/\s*\}/,g=/#|\^|\/|>|\{|&|=|!/;function y(e){this.string=e,this.tail=e,this.pos=0}function v(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function b(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}y.prototype.eos=function(){return""===this.tail},y.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},y.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},v.prototype.push=function(e){return new v(e,this)},v.prototype.lookup=function(e){var t,n,r,a=this.cache;if(a.hasOwnProperty(e))t=a[e];else{for(var s,l,c,u=this,d=!1;u;){if(e.indexOf(".")>0)for(s=u.view,l=e.split("."),c=0;null!=s&&c<l.length;)c===l.length-1&&(d=o(s,l[c])||(n=s,r=l[c],null!=n&&"object"!==typeof n&&n.hasOwnProperty&&n.hasOwnProperty(r))),s=s[l[c++]];else s=u.view[e],d=o(u.view,e);if(d){t=s;break}u=u.parent}a[e]=t}return i(t)&&(t=t.call(this.view)),t},b.prototype.clearCache=function(){"undefined"!==typeof this.templateCache&&this.templateCache.clear()},b.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||w.tags).join(":"),i="undefined"!==typeof n,o=i?n.get(r):void 0;return void 0==o&&(o=function(e,t){if(!e)return[];var n,r,i,o=!1,l=[],c=[],d=[],v=!1,b=!1,_="",x=0;function E(){if(v&&!b)for(;d.length;)delete c[d.pop()];else d=[];v=!1,b=!1}function k(e){if("string"===typeof e&&(e=e.split(p,2)),!a(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(s(e[0])+"\\s*"),r=new RegExp("\\s*"+s(e[1])),i=new RegExp("\\s*"+s("}"+e[1]))}k(t||w.tags);for(var S,O,P,T,N,j,I=new y(e);!I.eos();){if(S=I.pos,P=I.scanUntil(n))for(var A=0,C=P.length;A<C;++A)u(T=P.charAt(A))?(d.push(c.length),_+=T):(b=!0,o=!0,_+=" "),c.push(["text",T,S,S+1]),S+=1,"\n"===T&&(E(),_="",x=0,o=!1);if(!I.scan(n))break;if(v=!0,O=I.scan(g)||"name",I.scan(h),"="===O?(P=I.scanUntil(f),I.scan(f),I.scanUntil(r)):"{"===O?(P=I.scanUntil(i),I.scan(m),I.scanUntil(r),O="&"):P=I.scanUntil(r),!I.scan(r))throw new Error("Unclosed tag at "+I.pos);if(N=">"==O?[O,P,S,I.pos,_,x,o]:[O,P,S,I.pos],x++,c.push(N),"#"===O||"^"===O)l.push(N);else if("/"===O){if(!(j=l.pop()))throw new Error('Unopened section "'+P+'" at '+S);if(j[1]!==P)throw new Error('Unclosed section "'+j[1]+'" at '+S)}else"name"===O||"{"===O||"&"===O?b=!0:"="===O&&k(P)}if(E(),j=l.pop())throw new Error('Unclosed section "'+j[1]+'" at '+I.pos);return function(e){for(var t,n=[],r=n,a=[],i=0,s=e.length;i<s;++i)switch((t=e[i])[0]){case"#":case"^":r.push(t),a.push(t),r=t[4]=[];break;case"/":a.pop()[5]=t[2],r=a.length>0?a[a.length-1][4]:n;break;default:r.push(t)}return n}(function(e){for(var t,n,r=[],a=0,i=e.length;a<i;++a)(t=e[a])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}(c))}(e,t),i&&n.set(r,o)),o},b.prototype.render=function(e,t,n,r){var a=this.getConfigTags(r),i=this.parse(e,a),s=t instanceof v?t:new v(t,void 0);return this.renderTokens(i,s,n,e,r)},b.prototype.renderTokens=function(e,t,n,r,a){for(var i,s,o,l="",c=0,u=e.length;c<u;++c)o=void 0,"#"===(s=(i=e[c])[0])?o=this.renderSection(i,t,n,r,a):"^"===s?o=this.renderInverted(i,t,n,r,a):">"===s?o=this.renderPartial(i,t,n,a):"&"===s?o=this.unescapedValue(i,t):"name"===s?o=this.escapedValue(i,t,a):"text"===s&&(o=this.rawValue(i)),void 0!==o&&(l+=o);return l},b.prototype.renderSection=function(e,t,n,r,s){var o=this,l="",c=t.lookup(e[1]);if(c){if(a(c))for(var u=0,d=c.length;u<d;++u)l+=this.renderTokens(e[4],t.push(c[u]),n,r,s);else if("object"===typeof c||"string"===typeof c||"number"===typeof c)l+=this.renderTokens(e[4],t.push(c),n,r,s);else if(i(c)){if("string"!==typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(t.view,r.slice(e[3],e[5]),(function(e){return o.render(e,t,n,s)})))&&(l+=c)}else l+=this.renderTokens(e[4],t,n,r,s);return l}},b.prototype.renderInverted=function(e,t,n,r,i){var s=t.lookup(e[1]);if(!s||a(s)&&0===s.length)return this.renderTokens(e[4],t,n,r,i)},b.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),a=e.split("\n"),i=0;i<a.length;i++)a[i].length&&(i>0||!n)&&(a[i]=r+a[i]);return a.join("\n")},b.prototype.renderPartial=function(e,t,n,r){if(n){var a=this.getConfigTags(r),s=i(n)?n(e[1]):n[e[1]];if(null!=s){var o=e[6],l=e[5],c=e[4],u=s;0==l&&c&&(u=this.indentPartial(s,c,o));var d=this.parse(u,a);return this.renderTokens(d,t,n,u,r)}}},b.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},b.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||w.escape,a=t.lookup(e[1]);if(null!=a)return"number"===typeof a&&r===w.escape?String(a):r(a)},b.prototype.rawValue=function(e){return e[1]},b.prototype.getConfigTags=function(e){return a(e)?e:e&&"object"===typeof e?e.tags:void 0},b.prototype.getConfigEscape=function(e){return e&&"object"===typeof e&&!a(e)?e.escape:void 0};var w={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){_.templateCache=e},get templateCache(){return _.templateCache}},_=new b;w.clearCache=function(){return _.clearCache()},w.parse=function(e,t){return _.parse(e,t)},w.render=function(e,t,n,r){if("string"!==typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+((a(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)'));var i;return _.render(e,t,n,r)},w.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return d[e]}))},w.Scanner=y,w.Context=v,w.Writer=b;const x=w;var E=n(5527);function k(){x.escape=e=>e}const S=e=>{const t=e.split(""),n=[],r=(e,n)=>{for(let r=n;r<t.length;r+=1)if(e.includes(t[r]))return r;return-1};let a=0;for(;a<t.length;)if("{"===t[a]&&a+1<t.length&&"{"===t[a+1])n.push({type:"literal",text:"{"}),a+=2;else if("}"===t[a]&&a+1<t.length&&"}"===t[a+1])n.push({type:"literal",text:"}"}),a+=2;else if("{"===t[a]){const e=r("}",a);if(e<0)throw new Error("Unclosed '{' in template.");n.push({type:"variable",name:t.slice(a+1,e).join("")}),a=e+1}else{if("}"===t[a])throw new Error("Single '}' in template.");{const e=r("{}",a),i=(e<0?t.slice(a):t.slice(a,e)).join("");n.push({type:"literal",text:i}),a=e<0?t.length:e}}return n},O=e=>{k();return(e=>e.map((e=>"name"===e[0]?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:["#","&","^",">"].includes(e[0])?{type:"variable",name:e[1]}:{type:"literal",text:e[1]})))(x.parse(e))},P={"f-string":(e,t)=>S(e).reduce(((e,n)=>{if("variable"===n.type){if(n.name in t){return e+("string"===typeof t[n.name]?t[n.name]:JSON.stringify(t[n.name]))}throw new Error(`(f-string) Missing value for input ${n.name}`)}return e+n.text}),""),mustache:(e,t)=>(k(),x.render(e,t))},T={"f-string":S,mustache:O},N=(e,t,n)=>{try{return P[t](e,n)}catch(r){throw(0,E.Y)(r,"INVALID_PROMPT_INPUT")}},j=(e,t)=>T[t](e),I=(e,t,n)=>{if(!(t in P)){const e=Object.keys(P);throw new Error(`Invalid template format. Got \`${t}\`;\n                         should be one of ${e}`)}try{const r=n.reduce(((e,t)=>(e[t]="foo",e)),{});Array.isArray(e)?e.forEach((e=>{if("text"===e.type)N(e.text,t,r);else{if("image_url"!==e.type)throw new Error(`Invalid message template received. ${JSON.stringify(e,null,2)}`);if("string"===typeof e.image_url)N(e.image_url,t,r);else{const n=e.image_url.url;N(n,t,r)}}})):N(e,t,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}}},4085:(e,t,n)=>{"use strict";n.d(t,{YN:()=>L,B2:()=>q,fJ:()=>M,jY:()=>H,ck:()=>F,zZ:()=>z,GH:()=>$,Bp:()=>V});var r=n(7665),a=n(6659),i=n(8693),s=n(3703),o=n(6031),l=n(4385),c=n(7623),u=n(261),d=n(1021),h=n(1430),p=n(9263),f=n(3653);class m extends f.J{constructor(e){let{config:t,onStart:n,onEnd:r,onError:a}=e;super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=t,this.argOnStart=n,this.argOnEnd=r,this.argOnError=a}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function g(e){return!!e&&e.lc_runnable}class y{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let n=void 0===this.includeNames&&void 0===this.includeTypes&&void 0===this.includeTags;const r=e.tags??[];return void 0!==this.includeNames&&(n=n||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(n=n||this.includeTypes.includes(t)),void 0!==this.includeTags&&(n=n||r.some((e=>this.includeTags?.includes(e)))),void 0!==this.excludeNames&&(n=n&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(n=n&&!this.excludeTypes.includes(t)),void 0!==this.excludeTags&&(n=n&&r.every((e=>!this.excludeTags?.includes(e)))),n}}var v=n(9582),b=n(6139);const w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;const _=function(e){return"string"===typeof e&&w.test(e)};function x(e){return e.replace(/[^a-zA-Z-_0-9]/g,"_")}const E=["*","_","`"];function k(e,t,n){const{firstNode:r,lastNode:a,nodeColors:i,withStyles:s=!0,curveStyle:o="linear",wrapLabelNWords:l=9}=n??{};let c=s?`%%{init: {'flowchart': {'curve': '${o}'}}}%%\ngraph TD;\n`:"graph TD;\n";if(s){const t="default",n={[t]:"{0}({1})"};void 0!==r&&(n[r]="{0}([{1}]):::first"),void 0!==a&&(n[a]="{0}([{1}]):::last");for(const[r,a]of Object.entries(e)){const e=a.name.split(":").pop()??"";let i=E.some((t=>e.startsWith(t)&&e.endsWith(t)))?`<p>${e}</p>`:e;Object.keys(a.metadata??{}).length&&(i+=`<hr/><small><em>${Object.entries(a.metadata??{}).map((e=>{let[t,n]=e;return`${t} = ${n}`})).join("\n")}</em></small>`);const s=(n[r]??n[t]).replace("{0}",x(r)).replace("{1}",i);c+=`\t${s}\n`}}const u={};for(const p of t){const e=p.source.split(":"),t=p.target.split(":"),n=e.filter(((e,n)=>e===t[n])).join(":");u[n]||(u[n]=[]),u[n].push(p)}const d=new Set;function h(e,t){const n=1===e.length&&e[0].source===e[0].target;if(t&&!n){const e=t.split(":").pop();if(d.has(e))throw new Error(`Found duplicate subgraph '${e}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);d.add(e),c+=`\tsubgraph ${e}\n`}for(const r of e){const{source:e,target:t,data:n,conditional:a}=r;let i="";if(void 0!==n){let e=n;const t=e.split(" ");t.length>l&&(e=Array.from({length:Math.ceil(t.length/l)},((e,n)=>t.slice(n*l,(n+1)*l).join(" "))).join("&nbsp;<br>&nbsp;")),i=a?` -. &nbsp;${e}&nbsp; .-> `:` -- &nbsp;${e}&nbsp; --\x3e `}else i=a?" -.-> ":" --\x3e ";c+=`\t${x(e)}${i}${x(t)};\n`}for(const r in u)r.startsWith(`${t}:`)&&r!==t&&h(u[r],r);t&&!n&&(c+="\tend\n")}h(u[""]??[],"");for(const p in u)p.includes(":")||""===p||h(u[p],p);return s&&(c+=function(e){let t="";for(const[n,r]of Object.entries(e))t+=`\tclassDef ${n} ${r};\n`;return t}(i??{})),c}function S(e,t){if(void 0!==e&&!_(e))return e;if(!g(t))return t.name??"UnknownSchema";try{let e=t.getName();return e=e.startsWith("Runnable")?e.slice(8):e,e}catch(n){return t.getName()}}function O(e){return g(e.data)?{type:"runnable",data:{id:e.data.lc_id,name:e.data.getName()}}:{type:"schema",data:{...(0,b.Ik)(e.data.schema),title:e.data.name}}}class P{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=e?.nodes??this.nodes,this.edges=e?.edges??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach(((t,n)=>{e[t.id]=_(t.id)?n:t.id})),{nodes:Object.values(this.nodes).map((t=>({id:e[t.id],...O(t)}))),edges:this.edges.map((t=>{const n={source:e[t.source],target:e[t.target]};return"undefined"!==typeof t.data&&(n.data=t.data),"undefined"!==typeof t.conditional&&(n.conditional=t.conditional),n}))}}addNode(e,t,n){if(void 0!==t&&void 0!==this.nodes[t])throw new Error(`Node with id ${t} already exists`);const r=t??(0,i.A)(),a={id:r,data:e,name:S(t,e),metadata:n};return this.nodes[r]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter((t=>t.source!==e.id&&t.target!==e.id))}addEdge(e,t,n,r){if(void 0===this.nodes[e.id])throw new Error(`Source node ${e.id} not in graph`);if(void 0===this.nodes[t.id])throw new Error(`Target node ${t.id} not in graph`);const a={source:e.id,target:t.id,data:n,conditional:r};return this.edges.push(a),a}firstNode(){return T(this)}lastNode(){return N(this)}extend(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object.values(e.nodes).map((e=>e.id)).every(_)&&(t="");const n=e=>t?`${t}:${e}`:e;Object.entries(e.nodes).forEach((e=>{let[t,r]=e;this.nodes[n(t)]={...r,id:n(t)}}));const r=e.edges.map((e=>({...e,source:n(e.source),target:n(e.target)})));this.edges=[...this.edges,...r];const a=e.firstNode(),i=e.lastNode();return[a?{id:n(a.id),data:a.data}:void 0,i?{id:n(i.id),data:i.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&T(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&N(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map((e=>[e.id,e.name]))),t=new Map;Object.values(e).forEach((e=>{t.set(e,(t.get(e)||0)+1)}));const n=n=>{const r=e[n];return _(n)&&1===t.get(r)?r:n};return new P({nodes:Object.fromEntries(Object.entries(this.nodes).map((e=>{let[t,r]=e;return[n(t),{...r,id:n(t)}]}))),edges:this.edges.map((e=>({...e,source:n(e.source),target:n(e.target)})))})}drawMermaid(e){const{withStyles:t,curveStyle:n,nodeColors:r={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},i=this.reid(),s=i.firstNode(),o=i.lastNode();return k(i.nodes,i.edges,{firstNode:s?.id,lastNode:o?.id,withStyles:t,curveStyle:n,nodeColors:r,wrapLabelNWords:a})}async drawMermaidPng(e){return async function(e,t){let{backgroundColor:n="white"}=t??{};const r=btoa(e);void 0!==n&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(n)||(n=`!${n}`));const a=`https://mermaid.ink/img/${r}?bgColor=${n}`,i=await fetch(a);if(!i.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${i.status}`,`Status text: ${i.statusText}`].join("\n"));return await i.blob()}(this.drawMermaid(e),{backgroundColor:e?.backgroundColor})}}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=new Set(e.edges.filter((e=>!t.includes(e.source))).map((e=>e.target))),r=[];for(const a of Object.values(e.nodes))t.includes(a.id)||n.has(a.id)||r.push(a);return 1===r.length?r[0]:void 0}function N(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=new Set(e.edges.filter((e=>!t.includes(e.target))).map((e=>e.source))),r=[];for(const a of Object.values(e.nodes))t.includes(a.id)||n.has(a.id)||r.push(a);return 1===r.length?r[0]:void 0}function j(e){return"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.iterator]&&"function"===typeof e.next}function I(e){return"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.asyncIterator]}function*A(e,t){for(;;){const{value:n,done:r}=v.Nx.runWithConfig(e,t.next.bind(t),!0);if(r)break;yield n}}async function*C(e,t){const n=t[Symbol.asyncIterator]();for(;;){const{value:r,done:a}=await v.Nx.runWithConfig(e,n.next.bind(t),!0);if(a)break;yield r}}var R=n(4614);function $(e,t){return!e||Array.isArray(e)||e instanceof Date||"object"!==typeof e?{[t]:e}:e}class L extends c.y{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new M({bound:this,kwargs:e,config:{}})}map(){return new D({bound:this})}withRetry(e){return new U({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new M({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new Z({runnable:this,fallbacks:t})}_getOptionsList(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(h.ZI);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(e).filter((e=>{let[t]=e;return"runId"!==t})));return Array.from({length:t},((t,r)=>(0,h.ZI)(0===r?e:n)))}return Array.from({length:t},(()=>(0,h.ZI)(e)))}async batch(e,t,n){const r=this._getOptionsList(t??{},e.length),a=r[0]?.maxConcurrency??n?.maxConcurrency,i=new p.g({maxConcurrency:a,onFailedAttempt:e=>{throw e}}),s=e.map(((e,t)=>i.call((async()=>{try{return await this.invoke(e,r[t])}catch(a){if(n?.returnExceptions)return a;throw a}}))));return Promise.all(s)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const n=(0,h.ZI)(t),r=new u.Tr({generator:this._streamIterator(e,n),config:n});return await r.setup,u.bO.fromAsyncGenerator(r)}_separateRunnableConfigFromCallOptions(e){let t;t=void 0===e?(0,h.ZI)(e):(0,h.ZI)({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[t,n]}async _callWithConfig(e,t,n){const r=(0,h.ZI)(n),a=await(0,h.kJ)(r),i=await(a?.handleChainStart(this.toJSON(),$(t,"input"),r.runId,r?.runType,void 0,void 0,r?.runName??this.getName()));let s;delete r.runId;try{const a=e.call(this,t,r,i);s=await(0,d.o)(a,n?.signal)}catch(o){throw await(i?.handleChainError(o)),o}return await(i?.handleChainEnd($(s,"output"))),s}async _batchWithConfig(e,t,n,r){const a=this._getOptionsList(n??{},t.length),i=await Promise.all(a.map(h.kJ)),s=await Promise.all(i.map((async(e,n)=>{const r=await(e?.handleChainStart(this.toJSON(),$(t[n],"input"),a[n].runId,a[n].runType,void 0,void 0,a[n].runName??this.getName()));return delete a[n].runId,r})));let o;try{const n=e.call(this,t,a,s,r);o=await(0,d.o)(n,a?.[0]?.signal)}catch(l){throw await Promise.all(s.map((e=>e?.handleChainError(l)))),l}return await Promise.all(s.map((e=>e?.handleChainEnd($(o,"output"))))),o}async*_transformStreamWithConfig(e,t,n){let r,a,i=!0,s=!0;const c=(0,h.ZI)(n),d=await(0,h.kJ)(c);let p;try{const h=await(0,u.DS)(t.bind(this),async function*(){for await(const t of e){if(i)if(void 0===r)r=t;else try{r=(0,u.xW)(r,t)}catch{r=void 0,i=!1}yield t}}(),(async()=>d?.handleChainStart(this.toJSON(),{input:""},c.runId,c.runType,void 0,void 0,c.runName??this.getName())),n?.signal,c);delete c.runId,p=h.setup;const f=p?.handlers.find(l.K);let m=h.output;void 0!==f&&void 0!==p&&(m=f.tapOutputIterable(p.runId,m));const g=p?.handlers.find(o.l7);void 0!==g&&void 0!==p&&(m=g.tapOutputIterable(p.runId,m));for await(const e of m)if(yield e,s)if(void 0===a)a=e;else try{a=(0,u.xW)(a,e)}catch{a=void 0,s=!1}}catch(f){throw await(p?.handleChainError(f,void 0,void 0,void 0,{inputs:$(r,"input")})),f}await(p?.handleChainEnd(a??{},void 0,void 0,void 0,{inputs:$(r,"input")}))}getGraph(e){const t=new P,n=t.addNode({name:`${this.getName()}Input`,schema:r.z.any()}),a=t.addNode(this),i=t.addNode({name:`${this.getName()}Output`,schema:r.z.any()});return t.addEdge(n,a),t.addEdge(a,i),t}pipe(e){return new z({first:this,last:V(e)})}pick(e){return this.pipe(new W(e))}assign(e){return this.pipe(new q(new F({steps:e})))}async*transform(e,t){let n;for await(const r of e)n=void 0===n?r:(0,u.xW)(n,r);yield*this._streamIterator(n,(0,h.ZI)(t))}async*streamLog(e,t,n){const r=new o.y9({...n,autoClose:!1,_schemaFormat:"original"}),a=(0,h.ZI)(t);yield*this._streamLog(e,r,a)}async*_streamLog(e,t,n){const{callbacks:r}=n;if(void 0===r)n.callbacks=[t];else if(Array.isArray(r))n.callbacks=r.concat([t]);else{const e=r.copy();e.addHandler(t,!0),n.callbacks=e}const a=this.stream(e,n);const i=async function(){try{const e=await a;for await(const n of e){const e=new o.Od({ops:[{op:"add",path:"/streamed_output/-",value:n}]});await t.writer.write(e)}}finally{await t.writer.close()}}();try{for await(const e of t)yield e}finally{await i}}streamEvents(e,t,n){let r;if("v1"===t.version)r=this._streamEventsV1(e,t,n);else{if("v2"!==t.version)throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');r=this._streamEventsV2(e,t,n)}return"text/event-stream"===t.encoding?function(e){const t=new TextEncoder,n=new ReadableStream({async start(n){for await(const r of e)n.enqueue(t.encode(`event: data\ndata: ${JSON.stringify(r)}\n\n`));n.enqueue(t.encode("event: end\n\n")),n.close()}});return u.bO.fromReadableStream(n)}(r):u.bO.fromAsyncGenerator(r)}async*_streamEventsV2(e,t,n){const r=new l.s({...n,autoClose:!1}),a=(0,h.ZI)(t),s=a.runId??(0,i.A)();a.runId=s;const o=a.callbacks;if(void 0===o)a.callbacks=[r];else if(Array.isArray(o))a.callbacks=o.concat(r);else{const e=o.copy();e.addHandler(r,!0),a.callbacks=e}const c=this;const u=async function(){try{const t=await c.stream(e,a),n=r.tapOutputIterable(s,t);for await(const e of n);}finally{await r.finish()}}();let d,p=!1;try{for await(const t of r)p?(t.run_id===d&&t.event.endsWith("_end")&&t.data?.input&&delete t.data.input,yield t):(t.data.input=e,p=!0,d=t.run_id,yield t)}finally{await u}}async*_streamEventsV1(e,t,n){let r,a=!1;const i=(0,h.ZI)(t),s=i.tags??[],l=i.metadata??{},c=i.runName??this.getName(),u=new o.y9({...n,autoClose:!1,_schemaFormat:"streaming_events"}),d=new y({...n}),p=this._streamLog(e,u,i);for await(const h of p){if(r=r?r.concat(h):o.sD.fromRunLogPatch(h),void 0===r.state)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const t={...r.state},n={run_id:t.id,event:`on_${t.type}_start`,name:c,tags:s,metadata:l,data:{input:e}};d.includeEvent(n,t.type)&&(yield n)}const t=h.ops.filter((e=>e.path.startsWith("/logs/"))).map((e=>e.path.split("/")[2])),n=[...new Set(t)];for(const e of n){let t,n={};const a=r.state.logs[e];if(t=void 0===a.end_time?a.streamed_output.length>0?"stream":"start":"end","start"===t)void 0!==a.inputs&&(n.input=a.inputs);else if("end"===t)void 0!==a.inputs&&(n.input=a.inputs),n.output=a.final_output;else if("stream"===t){const e=a.streamed_output.length;if(1!==e)throw new Error(`Expected exactly one chunk of streamed output, got ${e} instead. Encountered in: "${a.name}"`);n={chunk:a.streamed_output[0]},a.streamed_output=[]}yield{event:`on_${a.type}_${t}`,name:a.name,run_id:a.id,tags:a.tags,metadata:a.metadata,data:n}}const{state:i}=r;if(i.streamed_output.length>0){const e=i.streamed_output.length;if(1!==e)throw new Error(`Expected exactly one chunk of streamed output, got ${e} instead. Encountered in: "${i.name}"`);const t={chunk:i.streamed_output[0]};i.streamed_output=[];const n={event:`on_${i.type}_stream`,run_id:i.id,tags:s,metadata:l,name:c,data:t};d.includeEvent(n,i.type)&&(yield n)}}const f=r?.state;if(void 0!==f){const e={event:`on_${f.type}_end`,name:c,run_id:f.id,tags:s,metadata:l,data:{output:f.final_output}};d.includeEvent(e,f.type)&&(yield e)}}static isRunnable(e){return g(e)}withListeners(e){let{onStart:t,onEnd:n,onError:r}=e;return new M({bound:this,config:{},configFactories:[e=>({callbacks:[new m({config:e,onStart:t,onEnd:n,onError:r})]})]})}asTool(e){return function(e,t){const n=t.name??e.getName(),a=t.description??t.schema?.description;if(t.schema.constructor===r.z.ZodString)return new K({name:n,description:a,schema:r.z.object({input:r.z.string()}).transform((e=>e.input)),bound:e});return new K({name:n,description:a,schema:t.schema,bound:e})}(this,e)}}class M extends L{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=(0,h.SV)(this.config,...t);return(0,h.SV)(r,...this.configFactories?await Promise.all(this.configFactories.map((async e=>await e(r)))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig((0,h.ZI)(t),this.kwargs))}async batch(e,t,n){const r=Array.isArray(t)?await Promise.all(t.map((async e=>this._mergeConfig((0,h.ZI)(e),this.kwargs)))):await this._mergeConfig((0,h.ZI)(t),this.kwargs);return this.bound.batch(e,r,n)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig((0,h.ZI)(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig((0,h.ZI)(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig((0,h.ZI)(t),this.kwargs))}streamEvents(e,t,n){const r=this;return u.bO.fromAsyncGenerator(async function*(){yield*r.bound.streamEvents(e,{...await r._mergeConfig((0,h.ZI)(t),r.kwargs),version:t.version},n)}())}static isRunnableBinding(e){return e.bound&&L.isRunnable(e.bound)}withListeners(e){let{onStart:t,onEnd:n,onError:r}=e;return new M({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[e=>({callbacks:[new m({config:e,onStart:t,onEnd:n,onError:r})]})]})}}class D extends L{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new D({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,n){return this.bound.batch(e,(0,h.tn)(t,{callbacks:n?.getChild()}))}withListeners(e){let{onStart:t,onEnd:n,onError:r}=e;return new D({bound:this.bound.withListeners({onStart:t,onEnd:n,onError:r})})}}class U extends M{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,n){const r=e>1?`retry:attempt:${e}`:void 0;return(0,h.tn)(t,{callbacks:n?.getChild(r)})}async _invoke(e,t,n){return a((r=>super.invoke(e,this._patchConfigForRetry(r,t,n))),{onFailedAttempt:t=>this.onFailedAttempt(t,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,n,r){const i={};try{await a((async a=>{const s=e.map(((e,t)=>t)).filter((e=>void 0===i[e.toString()]||i[e.toString()]instanceof Error)),o=s.map((t=>e[t])),l=s.map((e=>this._patchConfigForRetry(a,t?.[e],n?.[e]))),c=await super.batch(o,l,{...r,returnExceptions:!0});let u;for(let e=0;e<c.length;e+=1){const t=c[e],n=s[e];t instanceof Error&&void 0===u&&(u=t,u.input=o[e]),i[n.toString()]=t}if(u)throw u;return c}),{onFailedAttempt:e=>this.onFailedAttempt(e,e.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(s){if(!0!==r?.returnExceptions)throw s}return Object.keys(i).sort(((e,t)=>parseInt(e,10)-parseInt(t,10))).map((e=>i[parseInt(e,10)]))}async batch(e,t,n){return this._batchWithConfig(this._batch.bind(this),e,t,n)}}class z extends L{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){const n=(0,h.ZI)(t),r=await(0,h.kJ)(n),a=await(r?.handleChainStart(this.toJSON(),$(e,"input"),n.runId,void 0,void 0,void 0,n?.runName));delete n.runId;let i,s=e;try{const e=[this.first,...this.middle];for(let r=0;r<e.length;r+=1){const i=e[r].invoke(s,(0,h.tn)(n,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${r+1}`)}));s=await(0,d.o)(i,t?.signal)}if(t?.signal?.aborted)throw new Error("Aborted");i=await this.last.invoke(s,(0,h.tn)(n,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(o){throw await(a?.handleChainError(o)),o}return await(a?.handleChainEnd($(i,"output"))),i}async batch(e,t,n){const r=this._getOptionsList(t??{},e.length),a=await Promise.all(r.map(h.kJ)),i=await Promise.all(a.map((async(t,n)=>{const a=await(t?.handleChainStart(this.toJSON(),$(e[n],"input"),r[n].runId,void 0,void 0,void 0,r[n].runName));return delete r[n].runId,a})));let s=e;try{for(let e=0;e<this.steps.length;e+=1){const t=this.steps[e].batch(s,i.map(((t,n)=>{const a=t?.getChild(this.omitSequenceTags?void 0:`seq:step:${e+1}`);return(0,h.tn)(r[n],{callbacks:a})})),n);s=await(0,d.o)(t,r[0]?.signal)}}catch(o){throw await Promise.all(i.map((e=>e?.handleChainError(o)))),o}return await Promise.all(i.map((e=>e?.handleChainEnd($(s,"output"))))),s}async*_streamIterator(e,t){const n=await(0,h.kJ)(t),{runId:r,...a}=t??{},i=await(n?.handleChainStart(this.toJSON(),$(e,"input"),r,void 0,void 0,void 0,a?.runName)),s=[this.first,...this.middle,this.last];let o,l=!0;try{let n=s[0].transform(async function*(){yield e}(),(0,h.tn)(a,{callbacks:i?.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let e=1;e<s.length;e+=1){const t=s[e];n=await t.transform(n,(0,h.tn)(a,{callbacks:i?.getChild(this.omitSequenceTags?void 0:`seq:step:${e+1}`)}))}for await(const e of n)if(t?.signal?.throwIfAborted(),yield e,l)if(void 0===o)o=e;else try{o=(0,u.xW)(o,e)}catch(c){o=void 0,l=!1}}catch(c){throw await(i?.handleChainError(c)),c}await(i?.handleChainEnd($(o,"output")))}getGraph(e){const t=new P;let n=null;return this.steps.forEach(((r,a)=>{const i=r.getGraph(e);0!==a&&i.trimFirstNode(),a!==this.steps.length-1&&i.trimLastNode(),t.extend(i);const s=i.firstNode();if(!s)throw new Error(`Runnable ${r} has no first node`);n&&t.addEdge(n,s),n=i.lastNode()})),t}pipe(e){return z.isRunnableSequence(e)?new z({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new z({first:this.first,middle:[...this.middle,this.last],last:V(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&L.isRunnable(e)}static from(e,t){let[n,...r]=e,a={};return"string"===typeof t?a.name=t:void 0!==t&&(a=t),new z({...a,first:V(n),middle:r.slice(0,-1).map(V),last:V(r[r.length-1])})}}class F extends L{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,n]of Object.entries(e.steps))this.steps[t]=V(n)}static from(e){return new F({steps:e})}async invoke(e,t){const n=(0,h.ZI)(t),r=await(0,h.kJ)(n),a=await(r?.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,n?.runName));delete n.runId;const i={};try{const r=Object.entries(this.steps).map((async t=>{let[r,s]=t;i[r]=await s.invoke(e,(0,h.tn)(n,{callbacks:a?.getChild(`map:key:${r}`)}))}));await(0,d.o)(Promise.all(r),t?.signal)}catch(s){throw await(a?.handleChainError(s)),s}return await(a?.handleChainEnd(i)),i}async*_transform(e,t,n){const r={...this.steps},a=(0,u.gI)(e,Object.keys(r).length),i=new Map(Object.entries(r).map(((e,r)=>{let[i,s]=e;const o=s.transform(a[r],(0,h.tn)(n,{callbacks:t?.getChild(`map:key:${i}`)}));return[i,o.next().then((e=>({key:i,gen:o,result:e})))]})));for(;i.size;){const e=Promise.race(i.values()),{key:t,result:r,gen:a}=await(0,d.o)(e,n?.signal);i.delete(t),r.done||(yield{[t]:r.value},i.set(t,a.next().then((e=>({key:t,gen:a,result:e})))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){const n=(0,h.ZI)(t),r=new u.Tr({generator:this.transform(async function*(){yield e}(),n),config:n});return await r.setup,u.bO.fromAsyncGenerator(r)}}class B extends L{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!(0,s.GZ)(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[n]=this._getOptionsList(t??{},1),r=await(0,h.kJ)(n),a=this.func((0,h.tn)(n,{callbacks:r}),e);return(0,d.o)(a,n?.signal)}async*_streamIterator(e,t){const[n]=this._getOptionsList(t??{},1),r=await this.invoke(e,t);var a;if(I(r))for await(const i of r)n?.signal?.throwIfAborted(),yield i;else if(null!=(a=r)&&"object"===typeof a&&"next"in a&&"function"===typeof a.next)for(;;){n?.signal?.throwIfAborted();const e=r.next();if(e.done)break;yield e.value}else yield r}static from(e){return new B({func:e})}}class H extends L{static lc_name(){return"RunnableLambda"}constructor(e){if((0,s.GZ)(e.func))return B.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),function(e){if((0,s.GZ)(e))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}(e.func),this.func=e.func}static from(e){return new H({func:e})}async _invoke(e,t,n){return new Promise(((r,a)=>{const i=(0,h.tn)(t,{callbacks:n?.getChild(),recursionLimit:(t?.recursionLimit??h.p_)-1});v.Nx.runWithConfig(i,(async()=>{try{let a=await this.func(e,{...i});if(a&&L.isRunnable(a)){if(0===t?.recursionLimit)throw new Error("Recursion limit reached.");a=await a.invoke(e,{...i,recursionLimit:(i.recursionLimit??h.p_)-1})}else if(I(a)){let e;for await(const r of C(i,a))if(t?.signal?.throwIfAborted(),void 0===e)e=r;else try{e=(0,u.xW)(e,r)}catch(n){e=r}a=e}else if(j(a)){let e;for(const r of A(i,a))if(t?.signal?.throwIfAborted(),void 0===e)e=r;else try{e=(0,u.xW)(e,r)}catch(n){e=r}a=e}r(a)}catch(n){a(n)}}))}))}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,n){let r;for await(const o of e)if(void 0===r)r=o;else try{r=(0,u.xW)(r,o)}catch(s){r=o}const a=(0,h.tn)(n,{callbacks:t?.getChild(),recursionLimit:(n?.recursionLimit??h.p_)-1}),i=await new Promise(((e,t)=>{v.Nx.runWithConfig(a,(async()=>{try{const t=await this.func(r,{...a,config:a});e(t)}catch(s){t(s)}}))}));if(i&&L.isRunnable(i)){if(0===n?.recursionLimit)throw new Error("Recursion limit reached.");const e=await i.stream(r,a);for await(const t of e)yield t}else if(I(i))for await(const o of C(a,i))n?.signal?.throwIfAborted(),yield o;else if(j(i))for(const o of A(a,i))n?.signal?.throwIfAborted(),yield o;else yield i}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){const n=(0,h.ZI)(t),r=new u.Tr({generator:this.transform(async function*(){yield e}(),n),config:n});return await r.setup,u.bO.fromAsyncGenerator(r)}}class Z extends L{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const n=(0,h.ZI)(t),r=await(0,h.kJ)(t),{runId:a,...i}=n,s=await(r?.handleChainStart(this.toJSON(),$(e,"input"),a,void 0,void 0,void 0,i?.runName));let o;for(const c of this.runnables()){n?.signal?.throwIfAborted();try{const t=await c.invoke(e,(0,h.tn)(i,{callbacks:s?.getChild()}));return await(s?.handleChainEnd($(t,"output"))),t}catch(l){void 0===o&&(o=l)}}if(void 0===o)throw new Error("No error stored at end of fallback.");throw await(s?.handleChainError(o)),o}async*_streamIterator(e,t){const n=(0,h.ZI)(t),r=await(0,h.kJ)(t),{runId:a,...i}=n,s=await(r?.handleChainStart(this.toJSON(),$(e,"input"),a,void 0,void 0,void 0,i?.runName));let o,l,c;for(const u of this.runnables()){n?.signal?.throwIfAborted();const t=(0,h.tn)(i,{callbacks:s?.getChild()});try{l=await u.stream(e,t);break}catch(d){void 0===o&&(o=d)}}if(void 0===l){const e=o??new Error("No error stored at end of fallback.");throw await(s?.handleChainError(e)),e}try{for await(const e of l){yield e;try{c=void 0===c?c:(0,u.xW)(c,e)}catch(d){c=void 0}}}catch(d){throw await(s?.handleChainError(d)),d}await(s?.handleChainEnd($(c,"output")))}async batch(e,t,n){if(n?.returnExceptions)throw new Error("Not implemented.");const r=this._getOptionsList(t??{},e.length),a=await Promise.all(r.map((e=>(0,h.kJ)(e)))),i=await Promise.all(a.map((async(t,n)=>{const a=await(t?.handleChainStart(this.toJSON(),$(e[n],"input"),r[n].runId,void 0,void 0,void 0,r[n].runName));return delete r[n].runId,a})));let s;for(const l of this.runnables()){r[0].signal?.throwIfAborted();try{const t=await l.batch(e,i.map(((e,t)=>(0,h.tn)(r[t],{callbacks:e?.getChild()}))),n);return await Promise.all(i.map(((e,n)=>e?.handleChainEnd($(t[n],"output"))))),t}catch(o){void 0===s&&(s=o)}}if(!s)throw new Error("No error stored at end of fallbacks.");throw await Promise.all(i.map((e=>e?.handleChainError(s)))),s}}function V(e){if("function"===typeof e)return new H({func:e});if(L.isRunnable(e))return e;if(Array.isArray(e)||"object"!==typeof e)throw new Error("Expected a Runnable, function or object.\nInstead got an unsupported type.");{const t={};for(const[n,r]of Object.entries(e))t[n]=V(r);return new F({steps:t})}}class q extends L{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof F&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const n=await this.mapper.invoke(e,t);return{...e,...n}}async*_transform(e,t,n){const r=this.mapper.getStepsKeys(),[a,i]=(0,u.gI)(e),s=this.mapper.transform(i,(0,h.tn)(n,{callbacks:t?.getChild()})),o=s.next();for await(const l of a){if("object"!==typeof l||Array.isArray(l))throw new Error("RunnableAssign can only be used with objects as input, got "+typeof l);const e=Object.fromEntries(Object.entries(l).filter((e=>{let[t]=e;return!r.includes(t)})));Object.keys(e).length>0&&(yield e)}yield(await o).value;for await(const l of s)yield l}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){const n=(0,h.ZI)(t),r=new u.Tr({generator:this.transform(async function*(){yield e}(),n),config:n});return await r.setup,u.bO.fromAsyncGenerator(r)}}class W extends L{static lc_name(){return"RunnablePick"}constructor(e){("string"===typeof e||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if("string"===typeof this.keys)return e[this.keys];{const t=this.keys.map((t=>[t,e[t]])).filter((e=>void 0!==e[1]));return 0===t.length?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const e=await this._pick(t);void 0!==e&&(yield e)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){const n=(0,h.ZI)(t),r=new u.Tr({generator:this.transform(async function*(){yield e}(),n),config:n});return await r.setup,u.bO.fromAsyncGenerator(r)}}class K extends M{constructor(e){super({bound:z.from([H.from((async e=>{let t;if((0,R.K)(e))try{t=await this.schema.parseAsync(e.args)}catch(n){throw new R.q("Received tool input did not match expected schema",JSON.stringify(e.args))}else t=e;return t})).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name}),config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}},1430:(e,t,n)=>{"use strict";n.d(t,{SV:()=>o,ZI:()=>c,kJ:()=>s,p_:()=>i,tn:()=>u});var r=n(6480),a=n(9582);const i=25;async function s(e){return r.Td._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata)}function o(){const e={};for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];for(const i of n.filter((e=>!!e)))for(const t of Object.keys(i))if("metadata"===t)e[t]={...e[t],...i[t]};else if("tags"===t){const n=e[t]??[];e[t]=[...new Set(n.concat(i[t]??[]))]}else if("configurable"===t)e[t]={...e[t],...i[t]};else if("timeout"===t)void 0===e.timeout?e.timeout=i.timeout:void 0!==i.timeout&&(e.timeout=Math.min(e.timeout,i.timeout));else if("signal"===t)void 0===e.signal?e.signal=i.signal:void 0!==i.signal&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,i.signal]):e.signal=i.signal);else if("callbacks"===t){const t=e.callbacks,n=i.callbacks;if(Array.isArray(n))if(t)if(Array.isArray(t))e.callbacks=t.concat(n);else{const a=t.copy();for(const e of n)a.addHandler((0,r.tW)(e),!0);e.callbacks=a}else e.callbacks=n;else if(n)if(t)if(Array.isArray(t)){const a=n.copy();for(const e of t)a.addHandler((0,r.tW)(e),!0);e.callbacks=a}else e.callbacks=new r.Td(n._parentRunId,{handlers:t.handlers.concat(n.handlers),inheritableHandlers:t.inheritableHandlers.concat(n.inheritableHandlers),tags:Array.from(new Set(t.tags.concat(n.tags))),inheritableTags:Array.from(new Set(t.inheritableTags.concat(n.inheritableTags))),metadata:{...t.metadata,...n.metadata}});else e.callbacks=n}else{const n=t;e[n]=i[n]??e[n]}return e}const l=new Set(["string","number","boolean"]);function c(e){const t=a.Nx.getRunnableConfig();let n={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(t){const{runId:e,runName:r,...a}=t;n=Object.entries(a).reduce(((e,t)=>{let[n,r]=t;return void 0!==r&&(e[n]=r),e}),n)}if(e&&(n=Object.entries(e).reduce(((e,t)=>{let[n,r]=t;return void 0!==r&&(e[n]=r),e}),n)),n?.configurable)for(const r of Object.keys(n.configurable))l.has(typeof n.configurable[r])&&!n.metadata?.[r]&&(n.metadata||(n.metadata={}),n.metadata[r]=n.configurable[r]);if(void 0!==n.timeout){if(n.timeout<=0)throw new Error("Timeout must be a positive number");const e=AbortSignal.timeout(n.timeout);void 0!==n.signal?"any"in AbortSignal&&(n.signal=AbortSignal.any([n.signal,e])):n.signal=e,delete n.timeout}return n}function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{callbacks:t,maxConcurrency:n,recursionLimit:r,runName:a,configurable:i,runId:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=c(e);return void 0!==t&&(delete o.runName,o.callbacks=t),void 0!==r&&(o.recursionLimit=r),void 0!==n&&(o.maxConcurrency=n),void 0!==a&&(o.runName=a),void 0!==i&&(o.configurable={...o.configurable,...i}),void 0!==s&&delete o.runId,o}},9582:(e,t,n)=>{"use strict";n.d(t,{Nx:()=>c});var r=n(572),a=n(6480);const i=new class{getStore(){}run(e,t){return t()}enterWith(e){}},s=Symbol.for("ls:tracing_async_local_storage"),o=Symbol.for("lc:child_config"),l=Symbol.for("lc:context_variables");const c=new class{getInstance(){return globalThis[s]??i}getRunnableConfig(){const e=this.getInstance();return e.getStore()?.extra?.[o]}runWithConfig(e,t,n){const i=a.Td._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata),s=this.getInstance(),c=s.getStore(),u=i?.getParentRunId(),d=i?.handlers?.find((e=>"langchain_tracer"===e?.name));let h;return d&&u?h=d.convertToRunTree(u):n||(h=new r.gk({name:"<runnable_lambda>",tracingEnabled:!1})),h&&(h.extra={...h.extra,[o]:e}),void 0!==c&&void 0!==c[l]&&(h[l]=c[l]),s.run(h,t)}initializeGlobalInstance(e){void 0===globalThis[s]&&(globalThis[s]=e)}}},4614:(e,t,n)=>{"use strict";function r(e){return!(!e||"object"!==typeof e||!("type"in e)||"tool_call"!==e.type)}n.d(t,{K:()=>r,q:()=>a});class a extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}},3653:(e,t,n)=>{"use strict";n.d(t,{J:()=>s,j:()=>i});var r=n(9915);function a(e,t){return e&&!Array.isArray(e)&&"object"===typeof e?e:{[t]:e}}function i(e){return"function"===typeof e._addRunToRunMap}class s extends r.N{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`\n\n${e.stack}`:""):"string"===typeof e?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const t=function(e,t,n){const r=n.toFixed(0).slice(0,3).padStart(3,"0");return`${new Date(e).toISOString().slice(0,-1)}${r}Z`.replace(/[-:.]/g,"")+t}(e.start_time,e.id,e.execution_order),n={...e};if(void 0!==n.parent_run_id){const e=this.runMap.get(n.parent_run_id);e&&(this._addChildRun(e,n),e.child_execution_order=Math.max(e.child_execution_order,n.child_execution_order),n.trace_id=e.trace_id,void 0!==e.dotted_order&&(n.dotted_order=[e.dotted_order,t].join(".")))}else n.trace_id=n.id,n.dotted_order=t;return this.runMap.set(n.id,n),n}async _endTrace(e){const t=void 0!==e.parent_run_id&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await(this.onRunUpdate?.(e))}_getExecutionOrder(e){const t=void 0!==e&&this.runMap.get(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,n,r,a,i,s,o){const l=this._getExecutionOrder(r),c=Date.now(),u=s?{...a,metadata:s}:a,d={id:n,name:o??e.id[e.id.length-1],parent_run_id:r,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{prompts:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:u??{},tags:i||[]};return this._addRunToRunMap(d)}async handleLLMStart(e,t,n,r,a,i,s,o){const l=this.runMap.get(n)??this._createRunForLLMStart(e,t,n,r,a,i,s,o);return await(this.onRunCreate?.(l)),await(this.onLLMStart?.(l)),l}_createRunForChatModelStart(e,t,n,r,a,i,s,o){const l=this._getExecutionOrder(r),c=Date.now(),u=s?{...a,metadata:s}:a,d={id:n,name:o??e.id[e.id.length-1],parent_run_id:r,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{messages:t},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:u??{},tags:i||[]};return this._addRunToRunMap(d)}async handleChatModelStart(e,t,n,r,a,i,s,o){const l=this.runMap.get(n)??this._createRunForChatModelStart(e,t,n,r,a,i,s,o);return await(this.onRunCreate?.(l)),await(this.onLLMStart?.(l)),l}async handleLLMEnd(e,t){const n=this.runMap.get(t);if(!n||"llm"!==n?.run_type)throw new Error("No LLM run to end.");return n.end_time=Date.now(),n.outputs=e,n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await(this.onLLMEnd?.(n)),await this._endTrace(n),n}async handleLLMError(e,t){const n=this.runMap.get(t);if(!n||"llm"!==n?.run_type)throw new Error("No LLM run to end.");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await(this.onLLMError?.(n)),await this._endTrace(n),n}_createRunForChainStart(e,t,n,r,a,i,s,o){const l=this._getExecutionOrder(r),c=Date.now(),u={id:n,name:o??e.id[e.id.length-1],parent_run_id:r,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:t,execution_order:l,child_execution_order:l,run_type:s??"chain",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(u)}async handleChainStart(e,t,n,r,a,i,s,o){const l=this.runMap.get(n)??this._createRunForChainStart(e,t,n,r,a,i,s,o);return await(this.onRunCreate?.(l)),await(this.onChainStart?.(l)),l}async handleChainEnd(e,t,n,r,i){const s=this.runMap.get(t);if(!s)throw new Error("No chain run to end.");return s.end_time=Date.now(),s.outputs=a(e,"output"),s.events.push({name:"end",time:new Date(s.end_time).toISOString()}),void 0!==i?.inputs&&(s.inputs=a(i.inputs,"input")),await(this.onChainEnd?.(s)),await this._endTrace(s),s}async handleChainError(e,t,n,r,i){const s=this.runMap.get(t);if(!s)throw new Error("No chain run to end.");return s.end_time=Date.now(),s.error=this.stringifyError(e),s.events.push({name:"error",time:new Date(s.end_time).toISOString()}),void 0!==i?.inputs&&(s.inputs=a(i.inputs,"input")),await(this.onChainError?.(s)),await this._endTrace(s),s}_createRunForToolStart(e,t,n,r,a,i,s){const o=this._getExecutionOrder(r),l=Date.now(),c={id:n,name:s??e.id[e.id.length-1],parent_run_id:r,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:t},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(c)}async handleToolStart(e,t,n,r,a,i,s){const o=this.runMap.get(n)??this._createRunForToolStart(e,t,n,r,a,i,s);return await(this.onRunCreate?.(o)),await(this.onToolStart?.(o)),o}async handleToolEnd(e,t){const n=this.runMap.get(t);if(!n||"tool"!==n?.run_type)throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await(this.onToolEnd?.(n)),await this._endTrace(n),n}async handleToolError(e,t){const n=this.runMap.get(t);if(!n||"tool"!==n?.run_type)throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await(this.onToolError?.(n)),await this._endTrace(n),n}async handleAgentAction(e,t){const n=this.runMap.get(t);if(!n||"chain"!==n?.run_type)return;const r=n;r.actions=r.actions||[],r.actions.push(e),r.events.push({name:"agent_action",time:(new Date).toISOString(),kwargs:{action:e}}),await(this.onAgentAction?.(n))}async handleAgentEnd(e,t){const n=this.runMap.get(t);n&&"chain"===n?.run_type&&(n.events.push({name:"agent_end",time:(new Date).toISOString(),kwargs:{action:e}}),await(this.onAgentEnd?.(n)))}_createRunForRetrieverStart(e,t,n,r,a,i,s){const o=this._getExecutionOrder(r),l=Date.now(),c={id:n,name:s??e.id[e.id.length-1],parent_run_id:r,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:t},execution_order:o,child_execution_order:o,run_type:"retriever",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(c)}async handleRetrieverStart(e,t,n,r,a,i,s){const o=this.runMap.get(n)??this._createRunForRetrieverStart(e,t,n,r,a,i,s);return await(this.onRunCreate?.(o)),await(this.onRetrieverStart?.(o)),o}async handleRetrieverEnd(e,t){const n=this.runMap.get(t);if(!n||"retriever"!==n?.run_type)throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await(this.onRetrieverEnd?.(n)),await this._endTrace(n),n}async handleRetrieverError(e,t){const n=this.runMap.get(t);if(!n||"retriever"!==n?.run_type)throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await(this.onRetrieverError?.(n)),await this._endTrace(n),n}async handleText(e,t){const n=this.runMap.get(t);n&&"chain"===n?.run_type&&(n.events.push({name:"text",time:(new Date).toISOString(),kwargs:{text:e}}),await(this.onText?.(n)))}async handleLLMNewToken(e,t,n,r,a,i){const s=this.runMap.get(n);if(!s||"llm"!==s?.run_type)throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return s.events.push({name:"new_token",time:(new Date).toISOString(),kwargs:{token:e,idx:t,chunk:i?.chunk}}),await(this.onLLMNewToken?.(s,e,{chunk:i?.chunk})),s}}},4385:(e,t,n)=>{"use strict";n.d(t,{K:()=>l,s:()=>c});var r=n(3653),a=n(261),i=n(1388),s=n(1713);function o(e){let{name:t,serialized:n}=e;return void 0!==t?t:void 0!==n?.name?n.name:void 0!==n?.id&&Array.isArray(n?.id)?n.id[n.id.length-1]:"Unnamed"}const l=e=>"event_stream_tracer"===e.name;class c extends r.J{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=a.bO.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let n=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(n=n||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(n=n||this.includeTypes.includes(e.runType)),void 0!==this.includeTags&&(n=n||void 0!==t.find((e=>this.includeTags?.includes(e)))),void 0!==this.excludeNames&&(n=n&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(n=n&&!this.excludeTypes.includes(e.runType)),void 0!==this.excludeTags&&(n=n&&t.every((e=>!this.excludeTags?.includes(e)))),n}async*tapOutputIterable(e,t){const n=await t.next();if(n.done)return;const r=this.runInfoMap.get(e);if(void 0===r)return void(yield n.value);function a(e,t){return"llm"===e&&"string"===typeof t?new s.mu({text:t}):t}let i=this.tappedPromises.get(e);if(void 0===i){let s;i=new Promise((e=>{s=e})),this.tappedPromises.set(e,i);try{const i={event:`on_${r.runType}_stream`,run_id:e,name:r.name,tags:r.tags,metadata:r.metadata,data:{}};await this.send({...i,data:{chunk:a(r.runType,n.value)}},r),yield n.value;for await(const e of t)"tool"!==r.runType&&"retriever"!==r.runType&&await this.send({...i,data:{chunk:a(r.runType,e)}},r),yield e}finally{s()}}else{yield n.value;for await(const e of t)yield e}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const n=this.tappedPromises.get(e.run_id);void 0!==n?n.then((()=>{this.send(e,t)})):await this.send(e,t)}async onLLMStart(e){const t=o(e),n=void 0!==e.inputs.messages?"chat_model":"llm",r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,r);const a=`on_${n}_start`;await this.send({event:a,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onLLMNewToken(e,t,n){const r=this.runInfoMap.get(e.id);let a,o;if(void 0===r)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(1!==this.runInfoMap.size){if("chat_model"===r.runType)o="on_chat_model_stream",a=void 0===n?.chunk?new i.H({content:t,id:`run-${e.id}`}):n.chunk.message;else{if("llm"!==r.runType)throw new Error(`Unexpected run type ${r.runType}`);o="on_llm_stream",a=void 0===n?.chunk?new s.mu({text:t}):n.chunk}await this.send({event:o,data:{chunk:a},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}}async onLLMEnd(e){const t=this.runInfoMap.get(e.id);let n;if(this.runInfoMap.delete(e.id),void 0===t)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const r=e.outputs?.generations;let a;if("chat_model"===t.runType){for(const e of r??[]){if(void 0!==a)break;a=e[0]?.message}n="on_chat_model_end"}else{if("llm"!==t.runType)throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);a={generations:r?.map((e=>e.map((e=>({text:e.text,generationInfo:e.generationInfo}))))),llmOutput:e.outputs?.llmOutput??{}},n="on_llm_end"}await this.sendEndEvent({event:n,data:{output:a,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){const t=o(e),n=e.run_type??"chain",r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:e.run_type};let a={};""===e.inputs.input&&1===Object.keys(e.inputs).length?(a={},r.inputs={}):void 0!==e.inputs.input?(a.input=e.inputs.input,r.inputs=e.inputs.input):(a.input=e.inputs,r.inputs=e.inputs),this.runInfoMap.set(e.id,r),await this.send({event:`on_${n}_start`,data:a,name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},r)}async onChainEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),void 0===t)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const n=`on_${e.run_type}_end`,r=e.inputs??t.inputs??{},a={output:e.outputs?.output??e.outputs,input:r};r.input&&1===Object.keys(r).length&&(a.input=r.input,t.inputs=r.input),await this.sendEndEvent({event:n,data:a,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){const t=o(e),n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:e.extra?.metadata??{}},n)}async onToolEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),void 0===t)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(void 0===t.inputs)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const n=void 0===e.outputs?.output?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){const t=o(e),n={tags:e.tags??[],metadata:e.extra?.metadata??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,n),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},n)}async onRetrieverEnd(e){const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),void 0===t)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:e.outputs?.documents??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,n){const r=this.runInfoMap.get(n);if(void 0===r)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:r.tags,metadata:r.metadata,data:t},r)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally((()=>{this.writer.close()}))}}},6031:(e,t,n)=>{"use strict";n.d(t,{Od:()=>o,l7:()=>c,sD:()=>l,y9:()=>h});var r=n(6922),a=n(3653),i=n(261),s=n(1388);class o{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),n=(0,r.X6)({},t);return new l({ops:t,state:n[n.length-1].newDocument})}}class l extends o{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),n=(0,r.X6)(this.state,e.ops);return new l({ops:t,state:n[n.length-1].newDocument})}static fromRunLogPatch(e){const t=(0,r.X6)({},e.ops);return new l({ops:e.ops,state:t[t.length-1].newDocument})}}const c=e=>"log_stream_tracer"===e.name;async function u(e,t){if("original"===t)throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:n}=e;return["retriever","llm","prompt"].includes(e.run_type)?n:1!==Object.keys(n).length||""!==n?.input?n.input:void 0}async function d(e,t){const{outputs:n}=e;return"original"===t||["retriever","llm","prompt"].includes(e.run_type)?n:void 0!==n&&1===Object.keys(n).length&&void 0!==n?.output?n.output:n}class h extends a.J{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=i.bO.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let n=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(n=n||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(n=n||this.includeTypes.includes(e.run_type)),void 0!==this.includeTags&&(n=n||void 0!==t.find((e=>this.includeTags?.includes(e)))),void 0!==this.excludeNames&&(n=n&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(n=n&&!this.excludeTypes.includes(e.run_type)),void 0!==this.excludeTags&&(n=n&&t.every((e=>!this.excludeTags?.includes(e)))),n}async*tapOutputIterable(e,t){for await(const n of t){if(e!==this.rootId){const t=this.keyMapByRunId[e];t&&await this.writer.write(new o({ops:[{op:"add",path:`/logs/${t}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){if(void 0===this.rootId&&(this.rootId=e.id,await this.writer.write(new o({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;void 0===this.counterMapByRunName[e.name]&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=1===t?e.name:`${e.name}:${t}`;const n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};"streaming_events"===this._schemaFormat&&(n.inputs=await u(e,this._schemaFormat)),await this.writer.write(new o({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(void 0===t)return;const n=[];"streaming_events"===this._schemaFormat&&n.push({op:"replace",path:`/logs/${t}/inputs`,value:await u(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${t}/final_output`,value:await d(e,this._schemaFormat)}),void 0!==e.end_time&&n.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const r=new o({ops:n});await this.writer.write(r)}finally{if(e.id===this.rootId){const t=new o({ops:[{op:"replace",path:"/final_output",value:await d(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,n){const r=this.keyMapByRunId[e.id];if(void 0===r)return;let a;var i;void 0!==e.inputs.messages?(i=n?.chunk,a=void 0!==i&&void 0!==i.message?n?.chunk:new s.H({id:`run-${e.id}`,content:t})):a=t;const l=new o({ops:[{op:"add",path:`/logs/${r}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${r}/streamed_output/-`,value:a}]});await this.writer.write(l)}}},9263:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});var r=n(6659),a=n(5623);const i=[400,401,402,403,404,405,406,407,409],s=e=>{if(e.message.startsWith("Cancel")||e.message.startsWith("AbortError")||"AbortError"===e.name)throw e;if("ECONNABORTED"===e?.code)throw e;const t=e?.response?.status??e?.status;if(t&&i.includes(+t))throw e;if("insufficient_quota"===e?.error?.code){const t=new Error(e?.message);throw t.name="InsufficientQuotaError",t}};class o{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??s;const t=a.default;this.queue=new t({concurrency:this.maxConcurrency})}call(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return this.queue.add((()=>r((()=>e(...n).catch((e=>{throw e instanceof Error?e:new Error(e)}))),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0})),{throwOnTimeout:!0})}callWithOptions(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return e.signal?Promise.race([this.call(t,...r),new Promise(((t,n)=>{e.signal?.addEventListener("abort",(()=>{n(new Error("AbortError"))}))}))]):this.call(t,...r)}fetch(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.call((()=>fetch(...t).then((e=>e.ok?e:Promise.reject(e)))))}}},4070:(e,t,n)=>{"use strict";n.d(t,{Az:()=>o,Ec:()=>s});const r=()=>"undefined"!==typeof Deno,a=()=>{let e;return e="undefined"!==typeof window&&"undefined"!==typeof window.document?"browser":"undefined"===typeof process||"undefined"===typeof process.versions||"undefined"===typeof process.versions.node||r()?"object"===typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!==typeof window&&"nodejs"===window.name||"undefined"!==typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":r()?"deno":"other":"node",e};let i;async function s(){if(void 0===i){const e=a();i={library:"langchain-js",runtime:e}}return i}function o(e){try{return"undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}?.[e]:void 0}catch(t){return}}},6922:(e,t,n)=>{"use strict";n.d(t,{X6:()=>w,UD:()=>O});var r={};n.r(r),n.d(r,{JsonPatchError:()=>f,_areEquals:()=>k,applyOperation:()=>b,applyPatch:()=>w,applyReducer:()=>_,deepClone:()=>m,getValueByPointer:()=>v,validate:()=>E,validator:()=>x});const a=Object.prototype.hasOwnProperty;function i(e,t){return a.call(e,t)}function s(e){if(Array.isArray(e)){const t=new Array(e.length);for(let e=0;e<t.length;e++)t[e]=""+e;return t}if(Object.keys)return Object.keys(e);let t=[];for(let n in e)i(e,n)&&t.push(n);return t}function o(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function l(e){let t=0;const n=e.length;let r;for(;t<n;){if(r=e.charCodeAt(t),!(r>=48&&r<=57))return!1;t++}return!0}function c(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function u(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function d(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(let n=0,r=e.length;n<r;n++)if(d(e[n]))return!0}else if("object"===typeof e){const n=s(e),r=n.length;for(var t=0;t<r;t++)if(d(e[n[t]]))return!0}return!1}function h(e,t){const n=[e];for(const r in t){const e="object"===typeof t[r]?JSON.stringify(t[r],null,2):t[r];"undefined"!==typeof e&&n.push(`${r}: ${e}`)}return n.join("\n")}class p extends Error{constructor(e,t,n,r,a){super(h(e,{name:t,index:n,operation:r,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=h(e,{name:t,index:n,operation:r,tree:a})}}const f=p,m=o,g={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){let r=v(n,this.path);r&&(r=o(r));const a=b(n,{op:"remove",path:this.from}).removed;return b(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:r}},copy:function(e,t,n){const r=v(n,this.from);return b(n,{op:"add",path:this.path,value:o(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:k(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}};var y={add:function(e,t,n){return l(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:g.move,copy:g.copy,test:g.test,_get:g._get};function v(e,t){if(""==t)return e;var n={op:"_get",path:t};return b(e,n),n.value}function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(n&&("function"==typeof n?n(t,0,e,t.path):x(t,0)),""===t.path){let r={newDocument:e};if("add"===t.op)return r.newDocument=t.value,r;if("replace"===t.op)return r.newDocument=t.value,r.removed=e,r;if("move"===t.op||"copy"===t.op)return r.newDocument=v(e,t.from),"move"===t.op&&(r.removed=e),r;if("test"===t.op){if(r.test=k(e,t.value),!1===r.test)throw new f("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return r.newDocument=e,r}if("remove"===t.op)return r.removed=e,r.newDocument=null,r;if("_get"===t.op)return t.value=e,r;if(n)throw new f("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return r}{r||(e=o(e));const s=(t.path||"").split("/");let c,d,h,p=e,m=1,v=s.length;for(h="function"==typeof n?n:x;;){if(d=s[m],d&&-1!=d.indexOf("~")&&(d=u(d)),a&&("__proto__"==d||"prototype"==d&&m>0&&"constructor"==s[m-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===c&&(void 0===p[d]?c=s.slice(0,m).join("/"):m==v-1&&(c=t.path),void 0!==c&&h(t,0,e,c)),m++,Array.isArray(p)){if("-"===d)d=p.length;else{if(n&&!l(d))throw new f("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);l(d)&&(d=~~d)}if(m>=v){if(n&&"add"===t.op&&d>p.length)throw new f("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);const r=y[t.op].call(t,p,d,e);if(!1===r.test)throw new f("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return r}}else if(m>=v){const n=g[t.op].call(t,p,d,e);if(!1===n.test)throw new f("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return n}if(p=p[d],n&&m<v&&(!p||"object"!==typeof p))throw new f("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}}function w(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(n&&!Array.isArray(t))throw new f("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=o(e));const i=new Array(t.length);for(let s=0,o=t.length;s<o;s++)i[s]=b(e,t[s],n,!0,a,s),e=i[s].newDocument;return i.newDocument=e,i}function _(e,t,n){const r=b(e,t);if(!1===r.test)throw new f("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function x(e,t,n,r){if("object"!==typeof e||null===e||Array.isArray(e))throw new f("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!g[e.op])throw new f("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!==typeof e.path)throw new f("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new f('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!==typeof e.from)throw new f("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new f("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&d(e.value))throw new f("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var a=e.path.split("/").length,i=r.split("/").length;if(a!==i+1&&a!==i)throw new f("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new f("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var s=E([{op:"_get",path:e.from,value:void 0}],n);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new f("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function E(e,t,n){try{if(!Array.isArray(e))throw new f("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)w(o(t),o(e),n||!0);else{n=n||x;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(a){if(a instanceof f)return a;throw a}}function k(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,a,i=Array.isArray(e),s=Array.isArray(t);if(i&&s){if((r=e.length)!=t.length)return!1;for(n=r;0!==n--;)if(!k(e[n],t[n]))return!1;return!0}if(i!=s)return!1;var o=Object.keys(e);if((r=o.length)!==Object.keys(t).length)return!1;for(n=r;0!==n--;)if(!t.hasOwnProperty(o[n]))return!1;for(n=r;0!==n--;)if(!k(e[a=o[n]],t[a]))return!1;return!0}return e!==e&&t!==t}new WeakMap;function S(e,t,n,r,a){if(t!==e){"function"===typeof t.toJSON&&(t=t.toJSON());for(var l=s(t),u=s(e),d=!1,h=u.length-1;h>=0;h--){var p=e[m=u[h]];if(!i(t,m)||void 0===t[m]&&void 0!==p&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+c(m),value:o(p)}),n.push({op:"remove",path:r+"/"+c(m)}),d=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var f=t[m];"object"==typeof p&&null!=p&&"object"==typeof f&&null!=f&&Array.isArray(p)===Array.isArray(f)?S(p,f,n,r+"/"+c(m),a):p!==f&&(a&&n.push({op:"test",path:r+"/"+c(m),value:o(p)}),n.push({op:"replace",path:r+"/"+c(m),value:o(f)}))}}if(d||l.length!=u.length)for(h=0;h<l.length;h++){var m;i(e,m=l[h])||void 0===t[m]||n.push({op:"add",path:r+"/"+c(m),value:o(t[m])})}}}function O(e,t){var n=[];return S(e,t,n,"",arguments.length>2&&void 0!==arguments[2]&&arguments[2]),n}},9523:(e,t,n)=>{"use strict";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;e=e.trim();const n=/```(json)?(.*)```/s.exec(e);return t(n?n[2]:e)}function a(e){if("undefined"===typeof e)return null;try{return JSON.parse(e)}catch(i){}let t="";const n=[];let r=!1,a=!1;for(let s of e){if(r)'"'!==s||a?"\n"!==s||a?a="\\"===s&&!a:s="\\n":r=!1;else if('"'===s)r=!0,a=!1;else if("{"===s)n.push("}");else if("["===s)n.push("]");else if("}"===s||"]"===s){if(!n||n[n.length-1]!==s)return null;n.pop()}t+=s}r&&(t+='"');for(let s=n.length-1;s>=0;s-=1)t+=n[s];try{return JSON.parse(t)}catch(i){return null}}n.d(t,{D:()=>r,d:()=>a})},1021:(e,t,n)=>{"use strict";async function r(e,t){if(void 0===t)return e;let n;return Promise.race([e.catch((e=>{if(!t?.aborted)throw e})),new Promise(((e,r)=>{n=()=>{r(new Error("Aborted"))},t.addEventListener("abort",n),t.aborted&&r(new Error("Aborted"))}))]).finally((()=>t.removeEventListener("abort",n)))}n.d(t,{o:()=>r})},261:(e,t,n)=>{"use strict";n.d(t,{DS:()=>c,Tr:()=>l,bO:()=>i,gI:()=>s,xW:()=>o});var r=n(9582),a=n(1021);class i extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new i({start:e=>function n(){return t.read().then((t=>{let{done:r,value:a}=t;if(!r)return e.enqueue(a),n();e.close()}))}(),cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new i({async pull(t){const{value:n,done:r}=await e.next();r&&t.close(),t.enqueue(n)},async cancel(t){await e.return(t)}})}}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;const n=Array.from({length:t},(()=>[]));return n.map((async function*(t){for(;;)if(0===t.length){const t=await e.next();for(const e of n)e.push(t)}else{if(t[0].done)return;yield t.shift().value}}))}function o(e,t){if(Array.isArray(e)&&Array.isArray(t))return e.concat(t);if("string"===typeof e&&"string"===typeof t)return e+t;if("number"===typeof e&&"number"===typeof t)return e+t;if("concat"in e&&"function"===typeof e.concat)return e.concat(t);if("object"===typeof e&&"object"===typeof t){const n={...e};for(const[e,r]of Object.entries(t))e in n&&!Array.isArray(n[e])?n[e]=o(n[e],r):n[e]=r;return n}throw new Error(`Cannot concat ${typeof e} and ${typeof t}`)}class l{constructor(e){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??this.config?.signal,this.setup=new Promise(((t,n)=>{r.Nx.runWithConfig(e.config,(async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(t,n):this.firstResult.then((e=>t(void 0)),n)}),!0)}))}async next(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.signal?.throwIfAborted(),this.firstResultUsed?r.Nx.runWithConfig(this.config,this.signal?async()=>(0,a.o)(this.generator.next(...t),this.signal):async()=>this.generator.next(...t),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function c(e,t,n,r){const a=new l({generator:t,startSetup:n,signal:r}),i=await a.setup;for(var s=arguments.length,o=new Array(s>4?s-4:0),c=4;c<s;c++)o[c-4]=arguments[c];return{output:e(a,i,...o),setup:i}}},8074:(e,t,n)=>{"use strict";n.d(t,{Kj:()=>$});var r=n(8502),a=n(6659),i=n(5623),s=n(9692);const o=[400,401,403,404,405,406,407,408],l=[409];class c{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.queue=new i.default({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e?.onFailedResponseHook}call(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=this.onFailedResponseHook;return this.queue.add((()=>a((()=>e(...n).catch((e=>{throw e instanceof Error?e:new Error(e)}))),{async onFailedAttempt(e){if(e.message.startsWith("Cancel")||e.message.startsWith("TimeoutError")||e.message.startsWith("AbortError"))throw e;if("ECONNABORTED"===e?.code)throw e;const t=e?.response,n=t?.status;if(n){if(o.includes(+n))throw e;if(l.includes(+n))return;i&&await i(t)}},retries:this.maxRetries,randomize:!0})),{throwOnTimeout:!0})}callWithOptions(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return e.signal?Promise.race([this.call(t,...r),new Promise(((t,n)=>{e.signal?.addEventListener("abort",(()=>{n(new Error("AbortError"))}))}))]):this.call(t,...r)}fetch(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.call((()=>(0,s.Y)()(...t).then((e=>e.ok?e:Promise.reject(e)))))}}function u(e){return"function"===typeof e?._getType}function d(e){const t={type:e._getType(),data:{content:e.content}};return e?.additional_kwargs&&Object.keys(e.additional_kwargs).length>0&&(t.data.additional_kwargs={...e.additional_kwargs}),t}var h=n(2344),p=n(7549);const f=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;const m=function(e){return"string"===typeof e&&f.test(e)};function g(e,t){if(!m(e)){throw new Error(void 0!==t?`Invalid UUID for ${t}: ${e}`:`Invalid UUID: ${e}`)}return e}var y=n(2031),v=n(500);function b(e){if(!e||e.split("/").length>2||e.startsWith("/")||e.endsWith("/")||e.split(":").length>2)throw new Error(`Invalid identifier format: ${e}`);const[t,n]=e.split(":"),r=n||"latest";if(t.includes("/")){const[n,a]=t.split("/",2);if(!n||!a)throw new Error(`Invalid identifier format: ${e}`);return[n,a,r]}if(!t)throw new Error(`Invalid identifier format: ${e}`);return["-",t,r]}class w extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function _(e,t,n){let r;if(e.ok)return void(n&&(r=await e.text()));r=await e.text();const a=`Failed to ${t}. Received status [${e.status}]: ${e.statusText}. Server response: ${r}`;if(409===e.status)throw new w(a);throw new Error(a)}var x="[...]",E={result:"[Circular]"},k=[],S=[];function O(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function P(e,t,n,r){try{return JSON.stringify(e,t,n)}catch(s){if(!s.message?.includes("Converting circular structure to JSON"))return console.warn("[WARNING]: LangSmith received unserializable value."),"[Unserializable]";var a;console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),"undefined"===typeof r&&(r=O()),N(e,"",0,[],void 0,0,r);try{a=0===S.length?JSON.stringify(e,t,n):JSON.stringify(e,j(t),n)}catch(o){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==k.length;){var i=k.pop();4===i.length?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return a}}function T(e,t,n,r){var a=Object.getOwnPropertyDescriptor(r,n);void 0!==a.get?a.configurable?(Object.defineProperty(r,n,{value:e}),k.push([r,n,t,a])):S.push([t,n,e]):(r[n]=e,k.push([r,n,t]))}function N(e,t,n,r,a,i,s){var o;if(i+=1,"object"===typeof e&&null!==e){for(o=0;o<r.length;o++)if(r[o]===e)return void T(E,e,t,a);if("undefined"!==typeof s.depthLimit&&i>s.depthLimit)return void T(x,e,t,a);if("undefined"!==typeof s.edgesLimit&&n+1>s.edgesLimit)return void T(x,e,t,a);if(r.push(e),Array.isArray(e))for(o=0;o<e.length;o++)N(e[o],o,o,r,e,i,s);else{var l=Object.keys(e);for(o=0;o<l.length;o++){var c=l[o];N(e[c],c,o,r,e,i,s)}}r.pop()}}function j(e){return e="undefined"!==typeof e?e:function(e,t){return t},function(t,n){if(S.length>0)for(var r=0;r<S.length;r++){var a=S[r];if(a[1]===t&&a[0]===n){n=a[2],S.splice(r,1);break}}return e.call(this,t,n)}}function I(e){const t=(0,h.Ec)(),n=(0,h.yk)(),r=e.extra??{},a=r.metadata;return e.extra={...r,runtime:{...t,...r?.runtime},metadata:{...n,...n.revision_id||e.revision_id?{revision_id:e.revision_id??n.revision_id}:{},...a}},e}function A(e){if(void 0!==e)return e.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const C=async e=>{if(429===e?.status){const t=1e3*parseInt(e.headers.get("retry-after")??"30",10);if(t>0)return await new Promise((e=>setTimeout(e,t))),!0}return!1};class R{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const n=new Promise((e=>{t=e})),r=P(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:n,size:r}),this.sizeBytes+=r,n}pop(e){if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let n=0;for(;n+(this.peek()?.size??0)<e&&this.items.length>0;){const e=this.items.shift();e&&(t.push(e),n+=e.size,this.sizeBytes-=e.size)}if(0===t.length&&this.items.length>0){const e=this.items.shift();t.push(e),n+=e.size,this.sizeBytes-=e.size}return[t.map((e=>({action:e.action,item:e.payload}))),()=>t.forEach((e=>e.itemPromiseResolve()))]}}class ${constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new R}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:"false"===(0,h.Az)("LANGSMITH_TRACING_BACKGROUND")}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=$.getDefaultClientConfig();if(this.tracingSampleRate=(()=>{const e=(0,h.Jz)("TRACING_SAMPLING_RATE");if(void 0===e)return;const t=parseFloat(e);if(t<0||t>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t})(),this.apiUrl=A(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=A(e.apiKey??t.apiKey),this.webUrl=A(e.webUrl??t.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new c(e.callerOptions??{}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new c({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:C}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{}}static getDefaultClientConfig(){const e=(0,h.Jz)("API_KEY");return{apiUrl:(0,h.Jz)("ENDPOINT")??"https://api.smith.langchain.com",apiKey:e,webUrl:void 0,hideInputs:"true"===(0,h.Jz)("HIDE_INPUTS"),hideOutputs:"true"===(0,h.Jz)("HIDE_OUTPUTS")}}getHostUrl(){return this.webUrl?this.webUrl:(e=>{const t=e.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return"localhost"===t||"127.0.0.1"===t||"::1"===t})(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${p.Ls}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return!1===this.hideInputs?e:!0===this.hideInputs?{}:"function"===typeof this.hideInputs?this.hideInputs(e):e}processOutputs(e){return!1===this.hideOutputs?e:!0===this.hideOutputs?{}:"function"===typeof this.hideOutputs?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const t={...e};return void 0!==t.inputs&&(t.inputs=this.processInputs(t.inputs)),void 0!==t.outputs&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){const n=t?.toString()??"",r=`${this.apiUrl}${e}?${n}`,a=await this.caller.call((0,s.Y)(),r,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await _(a,`Failed to fetch ${e}`),a}async _get(e,t){return(await this._getResponse(e,t)).json()}_getPaginated(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new URLSearchParams,r=arguments.length>2?arguments[2]:void 0;return async function*(){let a=Number(n.get("offset"))||0;const i=Number(n.get("limit"))||100;for(;;){n.set("offset",String(a)),n.set("limit",String(i));const o=`${t.apiUrl}${e}?${n}`,l=await t.caller.call((0,s.Y)(),o,{method:"GET",headers:t.headers,signal:AbortSignal.timeout(t.timeout_ms),...t.fetchOptions});await _(l,`Failed to fetch ${e}`);const c=r?r(await l.json()):await l.json();if(0===c.length)break;if(yield c,c.length<i)break;a+=c.length}}()}catch(n){return Promise.reject(n)}}_getCursorPaginatedList(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"runs";return async function*(){const i=n?{...n}:{};for(;;){const n=await t.caller.call((0,s.Y)(),`${t.apiUrl}${e}`,{method:r,headers:{...t.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(t.timeout_ms),...t.fetchOptions,body:JSON.stringify(i)}),o=await n.json();if(!o)break;if(!o[a])break;yield o[a];const l=o.cursors;if(!l)break;if(!l.next)break;i.cursor=l.next}}()}catch(n){return Promise.reject(n)}}_filterForSampling(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===this.tracingSampleRate)return e;if(t){const t=[];for(const n of e)this.filteredPostUuids.has(n.id)?this.filteredPostUuids.delete(n.id):t.push(n);return t}{const t=[];for(const n of e)n.id!==n.trace_id&&!this.filteredPostUuids.has(n.trace_id)||Math.random()<this.tracingSampleRate?t.push(n):this.filteredPostUuids.add(n.id);return t}}async _getBatchSizeLimitBytes(){const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??e.batch_ingest_config?.size_limit_bytes??20971520}drainAutoBatchQueue(e){for(;this.autoBatchQueue.items.length>0;){const[t,n]=this.autoBatchQueue.pop(e);if(!t.length){n();break}this._processBatch(t,n).catch(console.error)}}async _processBatch(e,t){if(e.length)try{const t={runCreates:e.filter((e=>"create"===e.action)).map((e=>e.item)),runUpdates:e.filter((e=>"update"===e.action)).map((e=>e.item))},n=await this._ensureServerInfo();n?.batch_ingest_config?.use_multipart_endpoint?await this.multipartIngestRuns(t):await this.batchIngestRuns(t)}finally{t()}else t()}async processRunOperation(e){const t=this.autoBatchTimeout;clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,"create"===e.action&&(e.item=I(e.item));const n=this.autoBatchQueue.push(e),r=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>r&&this.drainAutoBatchQueue(r),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout((()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(r)}),t?this.autoBatchAggregationDelayMs:this.autoBatchInitialDelayMs)),n}async _getServerInfo(){const e=await(0,s.Y)()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e3),...this.fetchOptions});return await _(e,"get server info"),e.json()}async _ensureServerInfo(){return void 0===this._getServerInfoPromise&&(this._getServerInfoPromise=(async()=>{if(void 0===this._serverInfo)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to single calls and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then((e=>(void 0===this._serverInfo&&(this._getServerInfoPromise=void 0),e)))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async createRun(e){if(!this._filterForSampling([e]).length)return;const t={...this.headers,"Content-Type":"application/json"},n=e.project_name;delete e.project_name;const r=this.prepareRunCreateOrUpdateInputs({session_name:n,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&void 0!==r.trace_id&&void 0!==r.dotted_order)return void this.processRunOperation({action:"create",item:r}).catch(console.error);const a=I(r),i=await this.caller.call((0,s.Y)(),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:P(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(i,"create run",!0)}async batchIngestRuns(e){let{runCreates:t,runUpdates:n}=e;if(void 0===t&&void 0===n)return;let r=t?.map((e=>this.prepareRunCreateOrUpdateInputs(e)))??[],a=n?.map((e=>this.prepareRunCreateOrUpdateInputs(e)))??[];if(r.length>0&&a.length>0){const e=r.reduce(((e,t)=>t.id?(e[t.id]=t,e):e),{}),t=[];for(const n of a)void 0!==n.id&&e[n.id]?e[n.id]={...e[n.id],...n}:t.push(n);r=Object.values(e),a=t}const i={post:this._filterForSampling(r),patch:this._filterForSampling(a,!0)};if(!i.post.length&&!i.patch.length)return;if(void 0===(await this._ensureServerInfo()).version){this.autoBatchTracing=!1;for(const e of i.post)await this.createRun(e);for(const e of i.patch)void 0!==e.id&&await this.updateRun(e.id,e);return}const s={post:[],patch:[]};for(const o of["post","patch"]){const e=o,t=i[e].reverse();let n=t.pop();for(;void 0!==n;)s[e].push(n),n=t.pop()}(s.post.length>0||s.patch.length>0)&&await this._postBatchIngestRuns(P(s))}async _postBatchIngestRuns(e){const t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},n=await this.batchIngestCaller.call((0,s.Y)(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(n,"batch create run",!0)}async multipartIngestRuns(e){let{runCreates:t,runUpdates:n}=e;if(void 0===t&&void 0===n)return;const r={};let a=[];for(const l of t??[]){const e=this.prepareRunCreateOrUpdateInputs(l);void 0!==e.id&&void 0!==e.attachments&&(r[e.id]=e.attachments),delete e.attachments,a.push(e)}let i=[];for(const l of n??[])i.push(this.prepareRunCreateOrUpdateInputs(l));if(void 0!==a.find((e=>void 0===e.trace_id||void 0===e.dotted_order)))throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(void 0!==i.find((e=>void 0===e.trace_id||void 0===e.dotted_order)))throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(a.length>0&&i.length>0){const e=a.reduce(((e,t)=>t.id?(e[t.id]=t,e):e),{}),t=[];for(const n of i)void 0!==n.id&&e[n.id]?e[n.id]={...e[n.id],...n}:t.push(n);a=Object.values(e),i=t}if(0===a.length&&0===i.length)return;const s=[],o=[];for(const[l,c]of[["post",a],["patch",i]])for(const e of c){const{inputs:t,outputs:n,events:a,...i}=e,c={inputs:t,outputs:n,events:a},u=P(i);o.push({name:`${l}.${i.id}`,payload:new Blob([u],{type:`application/json; length=${u.length}`})});for(const[e,r]of Object.entries(c)){if(void 0===r)continue;const t=P(r);o.push({name:`${l}.${i.id}.${e}`,payload:new Blob([t],{type:`application/json; length=${t.length}`})})}if(void 0!==i.id){const e=r[i.id];if(e){delete r[i.id];for(const[t,[n,r]]of Object.entries(e))o.push({name:`attachment.${i.id}.${t}`,payload:new Blob([r],{type:`${n}; length=${r.length}`})})}}s.push(`trace=${i.trace_id},id=${i.id}`)}await this._sendMultipartRequest(o,s.join("; "))}async _sendMultipartRequest(e,t){try{const t=new FormData;for(const n of e)t.append(n.name,n.payload);await this.batchIngestCaller.call((0,s.Y)(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers},body:t,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})}catch(n){let e="Failed to multipart ingest runs";n instanceof Error?e+=`: ${n.stack||n.message}`:e+=`: ${String(n)}`,console.warn(`${e.trim()}\n\nContext: ${t}`)}}async updateRun(e,t){g(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));const n={...t,id:e};if(!this._filterForSampling([n],!0).length)return;if(this.autoBatchTracing&&void 0!==n.trace_id&&void 0!==n.dotted_order)return void 0!==t.end_time&&void 0===n.parent_run_id&&this.blockOnRootRunFinalization?void await this.processRunOperation({action:"update",item:n}).catch(console.error):void this.processRunOperation({action:"update",item:n}).catch(console.error);const r={...this.headers,"Content-Type":"application/json"},a=await this.caller.call((0,s.Y)(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:r,body:P(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(a,"update run",!0)}async readRun(e){let{loadChildRuns:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{loadChildRuns:!1};g(e);let n=await this._get(`/runs/${e}`);return t&&n.child_run_ids&&(n=await this._loadChildRuns(n)),n}async getRunUrl(e){let{runId:t,run:n,projectOpts:r}=e;if(void 0!==n){let e;if(n.session_id)e=n.session_id;else if(r?.projectName)e=(await this.readProject({projectName:r?.projectName})).id;else if(r?.projectId)e=r?.projectId;else{e=(await this.readProject({projectName:(0,h.Jz)("PROJECT")||"default"})).id}const t=await this._getTenantId();return`${this.getHostUrl()}/o/${t}/projects/p/${e}/r/${n.id}?poll=true`}if(void 0!==t){const e=await this.readRun(t);if(!e.app_path)throw new Error(`Run ${t} has no app_path`);return`${this.getHostUrl()}${e.app_path}`}throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await async function(e){const t=[];for await(const n of e)t.push(n);return t}(this.listRuns({id:e.child_run_ids})),n={},r={};t.sort(((e,t)=>(e?.dotted_order??"").localeCompare(t?.dotted_order??"")));for(const a of t){if(null===a.parent_run_id||void 0===a.parent_run_id)throw new Error(`Child run ${a.id} has no parent`);a.parent_run_id in n||(n[a.parent_run_id]=[]),n[a.parent_run_id].push(a),r[a.id]=a}e.child_runs=n[e.id]||[];for(const a in n)a!==e.id&&(r[a].child_runs=n[a]);return e}async*listRuns(e){const{projectId:t,projectName:n,parentRunId:r,traceId:a,referenceExampleId:i,startTime:s,executionOrder:o,isRoot:l,runType:c,error:u,id:d,query:h,filter:p,traceFilter:f,treeFilter:m,limit:g,select:y}=e;let v=[];if(t&&(v=Array.isArray(t)?t:[t]),n){const e=Array.isArray(n)?n:[n],t=await Promise.all(e.map((e=>this.readProject({projectName:e}).then((e=>e.id)))));v.push(...t)}const b={session:v.length?v:null,run_type:c,reference_example:i,query:h,filter:p,trace_filter:f,tree_filter:m,execution_order:o,parent_run:r,start_time:s?s.toISOString():null,error:u,id:d,limit:g,trace:a,select:y||["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],is_root:l};let w=0;for await(const _ of this._getCursorPaginatedList("/runs/query",b))if(g){if(w>=g)break;if(_.length+w>g){const e=_.slice(0,g-w);yield*e;break}w+=_.length,yield*_}else yield*_}async getRunStats(e){let{id:t,trace:n,parentRun:r,runType:a,projectNames:i,projectIds:o,referenceExampleIds:l,startTime:c,endTime:u,error:d,query:h,filter:p,traceFilter:f,treeFilter:m,isRoot:g,dataSourceType:y}=e,v=o||[];i&&(v=[...o||[],...await Promise.all(i.map((e=>this.readProject({projectName:e}).then((e=>e.id)))))]);const b={id:t,trace:n,parent_run:r,run_type:a,session:v,reference_example:l,start_time:c,end_time:u,error:d,query:h,filter:p,trace_filter:f,tree_filter:m,is_root:g,data_source_type:y},w=Object.fromEntries(Object.entries(b).filter((e=>{let[t,n]=e;return void 0!==n}))),_=await this.caller.call((0,s.Y)(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(w),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await _.json()}async shareRun(e){let{shareId:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={run_id:e,share_token:t||r.A()};g(e);const a=await this.caller.call((0,s.Y)(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),i=await a.json();if(null===i||!("share_token"in i))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${i.share_token}/r`}async unshareRun(e){g(e);const t=await this.caller.call((0,s.Y)(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(t,"unshare run",!0)}async readRunSharedLink(e){g(e);const t=await this.caller.call((0,s.Y)(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await t.json();if(null!==n&&"share_token"in n)return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e){let{runIds:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new URLSearchParams({share_token:e});if(void 0!==t)for(const a of t)n.append("id",a);g(e);const r=await this.caller.call((0,s.Y)(),`${this.apiUrl}/public/${e}/runs${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await r.json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");if(!e){e=(await this.readDataset({datasetName:t})).id}g(e);const n=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await n.json();return r.url=`${this.getHostUrl()}/public/${r.share_token}/d`,r}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");if(!e){e=(await this.readDataset({datasetName:t})).id}const n={dataset_id:e};g(e);const r=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),a=await r.json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){g(e);const t=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(t,"unshare dataset",!0)}async readSharedDataset(e){g(e);const t=await this.caller.call((0,s.Y)(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await t.json()}async listSharedExamples(e,t){const n={};t?.exampleIds&&(n.id=t.exampleIds);const r=new URLSearchParams;Object.entries(n).forEach((e=>{let[t,n]=e;Array.isArray(n)?n.forEach((e=>r.append(t,e))):r.append(t,n)}));const a=await this.caller.call((0,s.Y)(),`${this.apiUrl}/public/${e}/examples?${r.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),i=await a.json();if(!a.ok){if("detail"in i)throw new Error(`Failed to list shared examples.\nStatus: ${a.status}\nMessage: ${i.detail.join("\n")}`);throw new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`)}return i.map((e=>({...e,_hostUrl:this.getHostUrl()})))}async createProject(e){let{projectName:t,description:n=null,metadata:r=null,upsert:a=!1,projectExtra:i=null,referenceDatasetId:o=null}=e;const l=a?"?upsert=true":"",c=`${this.apiUrl}/sessions${l}`,u=i||{};r&&(u.metadata=r);const d={name:t,extra:u,description:n};null!==o&&(d.reference_dataset_id=o);const h=await this.caller.call((0,s.Y)(),c,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(h,"create project");return await h.json()}async updateProject(e,t){let{name:n=null,description:r=null,metadata:a=null,projectExtra:i=null,endTime:o=null}=t;const l=`${this.apiUrl}/sessions/${e}`;let c=i;a&&(c={...c||{},metadata:a});const u={name:n,extra:c,description:r,end_time:o?new Date(o).toISOString():null},d=await this.caller.call((0,s.Y)(),l,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(d,"update project");return await d.json()}async hasProject(e){let{projectId:t,projectName:n}=e,r="/sessions";const a=new URLSearchParams;if(void 0!==t&&void 0!==n)throw new Error("Must provide either projectName or projectId, not both");if(void 0!==t)g(t),r+=`/${t}`;else{if(void 0===n)throw new Error("Must provide projectName or projectId");a.append("name",n)}const i=await this.caller.call((0,s.Y)(),`${this.apiUrl}${r}?${a}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const e=await i.json();return!!i.ok&&(!Array.isArray(e)||e.length>0)}catch(o){return!1}}async readProject(e){let{projectId:t,projectName:n,includeStats:r}=e,a="/sessions";const i=new URLSearchParams;if(void 0!==t&&void 0!==n)throw new Error("Must provide either projectName or projectId, not both");if(void 0!==t)g(t),a+=`/${t}`;else{if(void 0===n)throw new Error("Must provide projectName or projectId");i.append("name",n)}void 0!==r&&i.append("include_stats",r.toString());const s=await this._get(a,i);let o;if(Array.isArray(s)){if(0===s.length)throw new Error(`Project[id=${t}, name=${n}] not found`);o=s[0]}else o=s;return o}async getProjectUrl(e){let{projectId:t,projectName:n}=e;if(void 0===t&&void 0===n)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:t,projectName:n}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${r.id}`}async getDatasetUrl(e){let{datasetId:t,datasetName:n}=e;if(void 0===t&&void 0===n)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:t,datasetName:n}),a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/datasets/${r.id}`}async _getTenantId(){if(null!==this._tenantId)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}listProjects(){try{var e=this;let{projectIds:t,name:n,nameContains:r,referenceDatasetId:a,referenceDatasetName:i,referenceFree:s,metadata:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){const l=new URLSearchParams;if(void 0!==t)for(const e of t)l.append("id",e);if(void 0!==n&&l.append("name",n),void 0!==r&&l.append("name_contains",r),void 0!==a)l.append("reference_dataset",a);else if(void 0!==i){const t=await e.readDataset({datasetName:i});l.append("reference_dataset",t.id)}void 0!==s&&l.append("reference_free",s.toString()),void 0!==o&&l.append("metadata",JSON.stringify(o));for await(const t of e._getPaginated("/sessions",l))yield*t}()}catch(t){return Promise.reject(t)}}async deleteProject(e){let t,{projectId:n,projectName:r}=e;if(void 0===n&&void 0===r)throw new Error("Must provide projectName or projectId");if(void 0!==n&&void 0!==r)throw new Error("Must provide either projectName or projectId, not both");t=void 0===n?(await this.readProject({projectName:r})).id:n,g(t);const a=await this.caller.call((0,s.Y)(),`${this.apiUrl}/sessions/${t}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(a,`delete session ${t} (${r})`,!0)}async uploadCsv(e){let{csvFile:t,fileName:n,inputKeys:r,outputKeys:a,description:i,dataType:o,name:l}=e;const c=`${this.apiUrl}/datasets/upload`,u=new FormData;u.append("file",t,n),r.forEach((e=>{u.append("input_keys",e)})),a.forEach((e=>{u.append("output_keys",e)})),i&&u.append("description",i),o&&u.append("data_type",o),l&&u.append("name",l);const d=await this.caller.call((0,s.Y)(),c,{method:"POST",headers:this.headers,body:u,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(d,"upload CSV");return await d.json()}async createDataset(e){let{description:t,dataType:n,inputsSchema:r,outputsSchema:a,metadata:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o={name:e,description:t,extra:i?{metadata:i}:void 0};n&&(o.data_type=n),r&&(o.inputs_schema_definition=r),a&&(o.outputs_schema_definition=a);const l=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(l,"create dataset");return await l.json()}async readDataset(e){let{datasetId:t,datasetName:n}=e,r="/datasets";const a=new URLSearchParams({limit:"1"});if(void 0!==t&&void 0!==n)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0!==t)g(t),r+=`/${t}`;else{if(void 0===n)throw new Error("Must provide datasetName or datasetId");a.append("name",n)}const i=await this._get(r,a);let s;if(Array.isArray(i)){if(0===i.length)throw new Error(`Dataset[id=${t}, name=${n}] not found`);s=i[0]}else s=i;return s}async hasDataset(e){let{datasetId:t,datasetName:n}=e;try{return await this.readDataset({datasetId:t,datasetName:n}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions(e){let{datasetId:t,datasetName:n,fromVersion:r,toVersion:a}=e,i=t;if(void 0===i&&void 0===n)throw new Error("Must provide either datasetName or datasetId");if(void 0!==i&&void 0!==n)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0===i){i=(await this.readDataset({datasetName:n})).id}const s=new URLSearchParams({from_version:"string"===typeof r?r:r.toISOString(),to_version:"string"===typeof a?a:a.toISOString()});return await this._get(`/datasets/${i}/versions/diff`,s)}async readDatasetOpenaiFinetuning(e){let{datasetId:t,datasetName:n}=e;if(void 0!==t);else{if(void 0===n)throw new Error("Must provide datasetName or datasetId");t=(await this.readDataset({datasetName:n})).id}const r=await this._getResponse(`/datasets/${t}/openai_ft`);return(await r.text()).trim().split("\n").map((e=>JSON.parse(e)))}listDatasets(){try{var e=this;let{limit:t=100,offset:n=0,datasetIds:r,datasetName:a,datasetNameContains:i,metadata:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){const o=new URLSearchParams({limit:t.toString(),offset:n.toString()});if(void 0!==r)for(const e of r)o.append("id",e);void 0!==a&&o.append("name",a),void 0!==i&&o.append("name_contains",i),void 0!==s&&o.append("metadata",JSON.stringify(s));for await(const t of e._getPaginated("/datasets",o))yield*t}()}catch(t){return Promise.reject(t)}}async updateDataset(e){const{datasetId:t,datasetName:n,...r}=e;if(!t&&!n)throw new Error("Must provide either datasetName or datasetId");const a=t??(await this.readDataset({datasetName:n})).id;g(a);const i=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await _(i,"update dataset"),await i.json()}async deleteDataset(e){let{datasetId:t,datasetName:n}=e,r="/datasets",a=t;if(void 0!==t&&void 0!==n)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0!==n){a=(await this.readDataset({datasetName:n})).id}if(void 0===a)throw new Error("Must provide datasetName or datasetId");g(a),r+=`/${a}`;const i=await this.caller.call((0,s.Y)(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(i,`delete ${r}`),await i.json()}async indexDataset(e){let{datasetId:t,datasetName:n,tag:r}=e,a=t;if(!a&&!n)throw new Error("Must provide either datasetName or datasetId");if(a&&n)throw new Error("Must provide either datasetName or datasetId, not both");if(!a){a=(await this.readDataset({datasetName:n})).id}g(a);const i={tag:r},o=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/${a}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(o,"index dataset"),await o.json()}async similarExamples(e,t,n){let{filter:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a={limit:n,inputs:e};void 0!==r&&(a.filter=r),g(t);const i=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(i,"fetch similar examples");return(await i.json()).examples}async createExample(e,t,n){let{datasetId:r,datasetName:a,createdAt:i,exampleId:o,metadata:l,split:c,sourceRunId:u}=n,d=r;if(void 0===d&&void 0===a)throw new Error("Must provide either datasetName or datasetId");if(void 0!==d&&void 0!==a)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0===d){d=(await this.readDataset({datasetName:a})).id}const h=i||new Date,p={dataset_id:d,inputs:e,outputs:t,created_at:h?.toISOString(),id:o,metadata:l,split:c,source_run_id:u},f=await this.caller.call((0,s.Y)(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(p),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(f,"create example");return await f.json()}async createExamples(e){const{inputs:t,outputs:n,metadata:r,sourceRunIds:a,exampleIds:i,datasetId:o,datasetName:l}=e;let c=o;if(void 0===c&&void 0===l)throw new Error("Must provide either datasetName or datasetId");if(void 0!==c&&void 0!==l)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0===c){const e=await this.readDataset({datasetName:l});c=e.id}const u=t.map(((t,s)=>({dataset_id:c,inputs:t,outputs:n?n[s]:void 0,metadata:r?r[s]:void 0,split:e.splits?e.splits[s]:void 0,id:i?i[s]:void 0,source_run_id:a?a[s]:void 0}))),d=await this.caller.call((0,s.Y)(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(d,"create examples");return await d.json()}async createLLMExample(e,t,n){return this.createExample({input:e},{output:t},n)}async createChatExample(e,t,n){const r=e.map((e=>u(e)?d(e):e)),a=u(t)?d(t):t;return this.createExample({input:r},{output:a},n)}async readExample(e){g(e);const t=`/examples/${e}`;return await this._get(t)}listExamples(){try{var e=this;let{datasetId:t,datasetName:n,exampleIds:r,asOf:a,splits:i,inlineS3Urls:s,metadata:o,limit:l,offset:c,filter:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){let d;if(void 0!==t&&void 0!==n)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0!==t)d=t;else{if(void 0===n)throw new Error("Must provide a datasetName or datasetId");d=(await e.readDataset({datasetName:n})).id}const h=new URLSearchParams({dataset:d}),p=a?"string"===typeof a?a:a?.toISOString():void 0;p&&h.append("as_of",p);const f=s??!0;if(h.append("inline_s3_urls",f.toString()),void 0!==r)for(const e of r)h.append("id",e);if(void 0!==i)for(const e of i)h.append("splits",e);if(void 0!==o){const e=JSON.stringify(o);h.append("metadata",e)}void 0!==l&&h.append("limit",l.toString()),void 0!==c&&h.append("offset",c.toString()),void 0!==u&&h.append("filter",u);let m=0;for await(const t of e._getPaginated("/examples",h)){for(const e of t)yield e,m++;if(void 0!==l&&m>=l)break}}()}catch(t){return Promise.reject(t)}}async deleteExample(e){g(e);const t=`/examples/${e}`,n=await this.caller.call((0,s.Y)(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(n,`delete ${t}`),await n.json()}async updateExample(e,t){g(e);const n=await this.caller.call((0,s.Y)(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(n,"update example");return await n.json()}async updateExamples(e){const t=await this.caller.call((0,s.Y)(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(t,"update examples");return await t.json()}async listDatasetSplits(e){let t,{datasetId:n,datasetName:r,asOf:a}=e;if(void 0===n&&void 0===r)throw new Error("Must provide dataset name or ID");if(void 0!==n&&void 0!==r)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0===n){t=(await this.readDataset({datasetName:r})).id}else t=n;g(t);const i=new URLSearchParams,s=a?"string"===typeof a?a:a?.toISOString():void 0;s&&i.append("as_of",s);return await this._get(`/datasets/${t}/splits`,i)}async updateDatasetSplits(e){let t,{datasetId:n,datasetName:r,splitName:a,exampleIds:i,remove:o=!1}=e;if(void 0===n&&void 0===r)throw new Error("Must provide dataset name or ID");if(void 0!==n&&void 0!==r)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0===n){t=(await this.readDataset({datasetName:r})).id}else t=n;g(t);const l={split_name:a,examples:i.map((e=>(g(e),e))),remove:o},c=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/${t}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(c,"update dataset splits",!0)}async evaluateRun(e,t){let n,{sourceInfo:r,loadChildRuns:a,referenceExample:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{loadChildRuns:!1};if((0,y.m)("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead."),"string"===typeof e)n=await this.readRun(e,{loadChildRuns:a});else{if("object"!==typeof e||!("id"in e))throw new Error("Invalid run type: "+typeof e);n=e}null!==n.reference_example_id&&void 0!==n.reference_example_id&&(i=await this.readExample(n.reference_example_id));const s=await t.evaluateRun(n,i),[o,l]=await this._logEvaluationFeedback(s,n,r);return l[0]}async createFeedback(e,t,n){let{score:a,value:i,correction:o,comment:l,sourceInfo:c,feedbackSourceType:u="api",sourceRunId:d,feedbackId:h,feedbackConfig:p,projectId:f,comparativeExperimentId:m}=n;if(!e&&!f)throw new Error("One of runId or projectId must be provided");if(e&&f)throw new Error("Only one of runId or projectId can be provided");const y={type:u??"api",metadata:c??{}};void 0===d||void 0===y?.metadata||y.metadata.__run||(y.metadata.__run={run_id:d}),void 0!==y?.metadata&&void 0!==y.metadata.__run?.run_id&&g(y.metadata.__run.run_id);const v={id:h??r.A(),run_id:e,key:t,score:a,value:i,correction:o,comment:l,feedback_source:y,comparative_experiment_id:m,feedbackConfig:p,session_id:f},b=`${this.apiUrl}/feedback`,w=await this.caller.call((0,s.Y)(),b,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(v),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await _(w,"create feedback",!0),v}async updateFeedback(e,t){let{score:n,value:r,correction:a,comment:i}=t;const o={};void 0!==n&&null!==n&&(o.score=n),void 0!==r&&null!==r&&(o.value=r),void 0!==a&&null!==a&&(o.correction=a),void 0!==i&&null!==i&&(o.comment=i),g(e);const l=await this.caller.call((0,s.Y)(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(l,"update feedback",!0)}async readFeedback(e){g(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){g(e);const t=`/feedback/${e}`,n=await this.caller.call((0,s.Y)(),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(n,`delete ${t}`),await n.json()}listFeedback(){try{var e=this;let{runIds:t,feedbackKeys:n,feedbackSourceTypes:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){const a=new URLSearchParams;if(t&&a.append("run",t.join(",")),n)for(const e of n)a.append("key",e);if(r)for(const e of r)a.append("source",e);for await(const t of e._getPaginated("/feedback",a))yield*t}()}catch(t){return Promise.reject(t)}}async createPresignedFeedbackToken(e,t){let{expiration:n,feedbackConfig:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a={run_id:e,feedback_key:t,feedback_config:r};n?"string"===typeof n?a.expires_at=n:(n?.hours||n?.minutes||n?.days)&&(a.expires_in=n):a.expires_in={hours:3};const i=await this.caller.call((0,s.Y)(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await i.json()}async createComparativeExperiment(e){let{name:t,experimentIds:n,referenceDatasetId:r,createdAt:a,description:i,metadata:o,id:l}=e;if(0===n.length)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:n[0]})).reference_dataset_id),null==!r)throw new Error("A reference dataset is required");const c={id:l,name:t,experiment_ids:n,reference_dataset_id:r,description:i,created_at:(a??new Date)?.toISOString(),extra:{}};o&&(c.extra.metadata=o);const u=await this.caller.call((0,s.Y)(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await u.json()}async*listPresignedFeedbackTokens(e){g(e);const t=new URLSearchParams({run_id:e});for await(const n of this._getPaginated("/feedback/tokens",t))yield*n}_selectEvalResults(e){let t;return t="results"in e?e.results:[e],t}async _logEvaluationFeedback(e,t,n){const r=this._selectEvalResults(e),a=[];for(const i of r){let e=n||{};i.evaluatorInfo&&(e={...i.evaluatorInfo,...e});let r=null;i.targetRunId?r=i.targetRunId:t&&(r=t.id),a.push(await this.createFeedback(r,i.key,{score:i.score,value:i.value,comment:i.comment,correction:i.correction,sourceInfo:e,sourceRunId:i.sourceRunId,feedbackConfig:i.feedbackConfig,feedbackSourceType:"model"}))}return[r,a]}async logEvaluationFeedback(e,t,n){const[r]=await this._logEvaluationFeedback(e,t,n);return r}listAnnotationQueues(){try{var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){const{queueIds:n,name:r,nameContains:a,limit:i}=t,s=new URLSearchParams;n&&n.forEach(((e,t)=>{g(e,`queueIds[${t}]`),s.append("ids",e)})),r&&s.append("name",r),a&&s.append("name_contains",a),s.append("limit",(void 0!==i?Math.min(i,100):100).toString());let o=0;for await(const t of e._getPaginated("/annotation-queues",s))if(yield*t,o++,void 0!==i&&o>=i)break}()}catch(t){return Promise.reject(t)}}async createAnnotationQueue(e){const{name:t,description:n,queueId:a}=e,i={name:t,description:n,id:a||r.A()},o=await this.caller.call((0,s.Y)(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(i).filter((e=>{let[t,n]=e;return void 0!==n})))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(o,"create annotation queue");return await o.json()}async readAnnotationQueue(e){const t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw new Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){const{name:n,description:r}=t,a=await this.caller.call((0,s.Y)(),`${this.apiUrl}/annotation-queues/${g(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:n,description:r}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(a,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call((0,s.Y)(),`${this.apiUrl}/annotation-queues/${g(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const n=await this.caller.call((0,s.Y)(),`${this.apiUrl}/annotation-queues/${g(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map(((e,t)=>g(e,`runIds[${t}]`).toString()))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(n,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const n=`/annotation-queues/${g(e,"queueId")}/run`,r=await this.caller.call((0,s.Y)(),`${this.apiUrl}${n}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await _(r,"get run from annotation queue"),await r.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return"-"==e||t.tenant_handle===e}async _ownerConflictError(e,t){const n=await this._getSettings();return new Error(`Cannot ${e} for another tenant.\n\n      Current tenant: ${n.tenant_handle}\n\n      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call((0,s.Y)(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await t.json();if(!t.ok){const e="string"===typeof n.detail?n.detail:JSON.stringify(n.detail),r=new Error(`Error ${t.status}: ${t.statusText}\n${e}`);throw r.statusCode=t.status,r}if(0!==n.commits.length)return n.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[n,r,a]=b(e),i=await this.caller.call((0,s.Y)(),`${this.apiUrl}/likes/${n}/${r}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await _(i,(t?"like":"unlike")+" prompt"),await i.json()}async _getPromptUrl(e){const[t,n,r]=b(e);if(await this._currentTenantIsOwner(t)){const e=await this._getSettings();return"latest"!==r?`${this.getHostUrl()}/prompts/${n}/${r.substring(0,8)}?organizationId=${e.id}`:`${this.getHostUrl()}/prompts/${n}?organizationId=${e.id}`}return"latest"!==r?`${this.getHostUrl()}/hub/${t}/${n}/${r.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${n}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,(e=>e.commits)))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",e?.sortField??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!e?.isArchived).toString()),void 0!==e?.isPublic&&t.append("is_public",e.isPublic.toString()),e?.query&&t.append("query",e.query);for await(const n of this._getPaginated("/repos",t,(e=>e.repos)))yield*n}async getPrompt(e){const[t,n,r]=b(e),a=await this.caller.call((0,s.Y)(),`${this.apiUrl}/repos/${t}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(404===a.status)return null;await _(a,"get prompt");const i=await a.json();return i.repo?i.repo:null}async createPrompt(e,t){const n=await this._getSettings();if(t?.isPublic&&!n.tenant_handle)throw new Error("Cannot create a public prompt without first\n\n        creating a LangChain Hub handle. \n        You can add a handle by creating a public prompt at:\n\n        https://smith.langchain.com/prompts");const[r,a,i]=b(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("create a prompt",r);const o={repo_handle:a,...t?.description&&{description:t.description},...t?.readme&&{readme:t.readme},...t?.tags&&{tags:t.tags},is_public:!!t?.isPublic},l=await this.caller.call((0,s.Y)(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(l,"create prompt");const{repo:c}=await l.json();return c}async createCommit(e,t,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,a,i]=b(e),o="latest"!==n?.parentCommitHash&&n?.parentCommitHash?n?.parentCommitHash:await this._getLatestCommitHash(`${r}/${a}`),l={manifest:JSON.parse(JSON.stringify(t)),parent_commit:o},c=await this.caller.call((0,s.Y)(),`${this.apiUrl}/commits/${r}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(c,"create commit");const u=await c.json();return this._getPromptUrl(`${r}/${a}${u.commit_hash?`:${u.commit_hash}`:""}`)}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,r]=b(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("update a prompt",n);const a={};if(void 0!==t?.description&&(a.description=t.description),void 0!==t?.readme&&(a.readme=t.readme),void 0!==t?.tags&&(a.tags=t.tags),void 0!==t?.isPublic&&(a.is_public=t.isPublic),void 0!==t?.isArchived&&(a.is_archived=t.isArchived),0===Object.keys(a).length)throw new Error("No valid update options provided");const i=await this.caller.call((0,s.Y)(),`${this.apiUrl}/repos/${n}/${r}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await _(i,"update prompt"),i.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,n,r]=b(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);const a=await this.caller.call((0,s.Y)(),`${this.apiUrl}/repos/${t}/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await a.json()}async pullPromptCommit(e,t){const[n,r,a]=b(e);let i=a;if(!function(e,t){const n=(0,v.parse)(e),r=(0,v.parse)(t);if(!n||!r)throw new Error("Invalid version format.");return n.compare(r)>=0}((await this._getServerInfo()).version,"0.5.23")&&"latest"===a){const e=await this._getLatestCommitHash(`${n}/${r}`);if(!e)throw new Error("No commits found");i=e}const o=await this.caller.call((0,s.Y)(),`${this.apiUrl}/commits/${n}/${r}/${i}${t?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await _(o,"pull prompt commit");const l=await o.json();return{owner:n,repo:r,commit_hash:l.commit_hash,manifest:l.manifest,examples:l.examples}}async _pullPrompt(e,t){const n=await this.pullPromptCommit(e,{includeModel:t?.includeModel});return JSON.stringify(n.manifest)}async pushPrompt(e,t){if(await this.promptExists(e)?t&&Object.keys(t).some((e=>"object"!==e))&&await this.updatePrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}):await this.createPrompt(e,{description:t?.description,readme:t?.readme,tags:t?.tags,isPublic:t?.isPublic}),!t?.object)return await this._getPromptUrl(e);return await this.createCommit(e,t?.object,{parentCommitHash:t?.parentCommitHash})}async clonePublicDataset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceApiUrl:n=this.apiUrl,datasetName:r}=t,[a,i]=this.parseTokenOrUrl(e,n),s=new $({apiUrl:a,apiKey:"placeholder"}),o=await s.readSharedDataset(i),l=r||o.name;try{if(await this.hasDataset({datasetId:l}))return void console.log(`Dataset ${l} already exists in your tenant. Skipping.`)}catch(d){}const c=await s.listSharedExamples(i),u=await this.createDataset(l,{description:o.description,dataType:o.data_type||"kv",inputsSchema:o.inputs_schema_definition??void 0,outputsSchema:o.outputs_schema_definition??void 0});try{await this.createExamples({inputs:c.map((e=>e.inputs)),outputs:c.flatMap((e=>e.outputs?[e.outputs]:[])),datasetId:u.id})}catch(h){throw console.error(`An error occurred while creating dataset ${l}. You should delete it manually.`),h}}parseTokenOrUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dataset";try{return g(e),[t,e]}catch(a){}try{const a=new URL(e).pathname.split("/").filter((e=>""!==e));if(a.length>=n){return[t,a[a.length-n]]}throw new Error(`Invalid public ${r} URL: ${e}`)}catch(i){throw new Error(`Invalid public ${r} URL or token: ${e}`)}}awaitPendingTraceBatches(){return Promise.all([...this.autoBatchQueue.items.map((e=>{let{itemPromise:t}=e;return t})),this.batchIngestCaller.queue.onIdle()])}}},7549:(e,t,n)=>{"use strict";n.d(t,{Kj:()=>r.Kj,Ls:()=>i,gk:()=>a.gk});var r=n(8074),a=n(8365);n(9692);const i="0.2.3"},8365:(e,t,n)=>{"use strict";n.d(t,{gk:()=>c,m5:()=>u});var r=n(8502),a=n(2344),i=n(8074);var s=n(2031);const o=Symbol.for("lc:context_variables");class l{constructor(e,t){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t}static fromHeader(e){const t=e.split(",");let n={},r=[];for(const a of t){const[e,t]=a.split("="),i=decodeURIComponent(t);"langsmith-metadata"===e?n=JSON.parse(i):"langsmith-tags"===e&&(r=i.split(","))}return new l(n,r)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class c{constructor(e){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u(e))return void Object.assign(this,{...e});const t=c.getDefaultConfig(),{metadata:n,...r}=e,a=r.client??c.getSharedClient(),i={...n,...r?.extra?.metadata};if(r.extra={...r.extra,metadata:i},Object.assign(this,{...t,...r,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??=1,this.child_execution_order??=1,!this.dotted_order){const e=function(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1).toFixed(0).slice(0,3).padStart(3,"0");return`${new Date(e).toISOString().slice(0,-1)}${n}Z`.replace(/[-:.]/g,"")+t}(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+e:this.dotted_order=e}}static getDefaultConfig(){return{id:r.A(),run_type:"chain",project_name:(0,a.Az)("LANGCHAIN_PROJECT")??(0,a.Az)("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:(0,a.Az)("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:(0,a.Az)("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return c.sharedClient||(c.sharedClient=new i.Kj),c.sharedClient}createChild(e){const t=this.child_execution_order+1,n=new c({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});o in this&&(n[o]=this[o]);const r=Symbol.for("lc:child_config"),a=e.extra?.[r]??this.extra[r];if(void 0!==(i=a)&&"object"===typeof i.callbacks&&(h(i.callbacks?.handlers)||h(i.callbacks))){const e={...a},t=function(e){return"object"===typeof e&&null!=e&&Array.isArray(e.handlers)}(e.callbacks)?e.callbacks.copy?.():void 0;t&&(Object.assign(t,{_parentRunId:n.id}),t.handlers?.find(d)?.updateFromRunTree?.(n),e.callbacks=t),n.extra[r]=e}var i;const s=new Set;let l=this;for(;null!=l&&!s.has(l.id);)s.add(l.id),l.child_execution_order=Math.max(l.child_execution_order,t),l=l.parent_run;return this.child_runs.push(n),n}async end(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),r=arguments.length>3?arguments[3]:void 0;this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??n,r&&Object.keys(r).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...r}}:{metadata:r})}_convertToCreate(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.extra??{};if(r.runtime||(r.runtime={}),t)for(const[s,o]of Object.entries(t))r.runtime[s]||(r.runtime[s]=o);let a,i;n?(i=e.parent_run?.id,a=[]):(a=e.child_runs.map((e=>this._convertToCreate(e,t,n))),i=void 0);return{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:r,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:i,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags}}async postRun(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{const t=(0,a.Ec)(),n=await this._convertToCreate(this,t,!0);if(await this.client.createRun(n),!e){(0,s.m)("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const e of this.child_runs)await e.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){try{const e={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:this.parent_run?.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags};await this.client.updateRun(this.id,e)}catch(e){console.error(`Error in patchRun for run ${this.id}`,e)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,t){const n=e?.callbacks;let r,i,s,o=(e=>void 0!==e?e:!!["TRACING_V2","TRACING"].find((e=>"true"===(0,a.Jz)(e))))();if(n){const e=n?.getParentRunId?.()??"",t=n?.handlers?.find((e=>"langchain_tracer"==e?.name));r=t?.getRun?.(e),i=t?.projectName,s=t?.client,o=o||!!t}if(!r)return new c({...t,client:s,tracingEnabled:o,project_name:i});return new c({name:r.name,id:r.id,trace_id:r.trace_id,dotted_order:r.dotted_order,client:s,tracingEnabled:o,project_name:i,tags:[...new Set((r?.tags??[]).concat(e?.tags??[]))],extra:{metadata:{...r?.extra?.metadata,...e?.metadata}}}).createChild(t)}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){const n="get"in e&&"function"===typeof e.get?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,r=n["langsmith-trace"];if(!r||"string"!==typeof r)return;const a=r.trim(),i=a.split(".").map((e=>{const[t,n]=e.split("Z");return{strTime:t,time:Date.parse(t+"Z"),uuid:n}})),s=i[0].uuid,o={...t,name:t?.name??"parent",run_type:t?.run_type??"chain",start_time:t?.start_time??Date.now(),id:i.at(-1)?.uuid,trace_id:s,dotted_order:a};if(n.baggage&&"string"===typeof n.baggage){const e=l.fromHeader(n.baggage);o.metadata=e.metadata,o.tags=e.tags}return new c(o)}toHeaders(e){const t={"langsmith-trace":this.dotted_order,baggage:new l(this.extra?.metadata,this.tags).toHeader()};if(e)for(const[n,r]of Object.entries(t))e.set(n,r);return t}}function u(e){return void 0!==e&&"function"===typeof e.createChild&&"function"===typeof e.postRun}function d(e){return"object"===typeof e&&null!=e&&"string"===typeof e.name&&"langchain_tracer"===e.name}function h(e){return Array.isArray(e)&&e.some((e=>d(e)))}Object.defineProperty(c,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null})},9692:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});const r=function(){return fetch(...arguments)},a=Symbol.for("ls:fetch_implementation"),i=()=>globalThis[a]??r},2344:(e,t,n)=>{"use strict";n.d(t,{Az:()=>h,Ec:()=>c,Jz:()=>p,yk:()=>u});var r=n(7549);let a;const i=()=>"undefined"!==typeof Deno,s=()=>a||(a="undefined"!==typeof window&&"undefined"!==typeof window.document?"browser":"undefined"===typeof process||"undefined"===typeof process.versions||"undefined"===typeof process.versions.node||i()?"object"===typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!==typeof window&&"nodejs"===window.name||"undefined"!==typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":i()?"deno":"other":"node",a);let o,l;function c(){if(void 0===o){const e=s(),t=function(){if(void 0!==l)return l;const e=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],t={};for(const n of e){const e=h(n);void 0!==e&&(t[n]=e)}return l=t,t}();o={library:"langsmith",runtime:e,sdk:"langsmith-js",sdk_version:r.Ls,...t}}return o}function u(){const e=d()||{},t={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"];for(const[r,a]of Object.entries(e))!r.startsWith("LANGCHAIN_")||"string"!==typeof a||n.includes(r)||r.toLowerCase().includes("key")||r.toLowerCase().includes("secret")||r.toLowerCase().includes("token")||("LANGCHAIN_REVISION_ID"===r?t.revision_id=a:t[r]=a);return t}function d(){try{return"undefined"!==typeof process?Object.entries({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).reduce(((e,t)=>{let[n,r]=t;return e[n]=String(r),e}),{}):void 0}catch(e){return}}function h(e){try{return"undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}?.[e]:void 0}catch(t){return}}function p(e){return h(`LANGSMITH_${e}`)||h(`LANGCHAIN_${e}`)}},2031:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});const r={};function a(e){r[e]||(console.warn(e),r[e]=!0)}},572:(e,t,n)=>{"use strict";n.d(t,{Kj:()=>r.Kj,gk:()=>r.gk});var r=n(7549)},3703:(e,t,n)=>{"use strict";n.d(t,{vR:()=>o,GZ:()=>l});var r=n(8365);const a=Symbol.for("ls:tracing_async_local_storage"),i=new class{getStore(){}run(e,t){return t()}};const s=new class{getInstance(){return globalThis[a]??i}initializeGlobalInstance(e){void 0===globalThis[a]&&(globalThis[a]=e)}},o=()=>{const e=s.getInstance().getStore();if(!(0,r.m5)(e))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function or the tracing is enabled."].join("\n"));return e};Symbol.for("langsmith:traceable:root");function l(e){return"function"===typeof e&&"langsmith:traceable"in e}},6139:(e,t,n)=>{"use strict";n.d(t,{Ik:()=>R});const r=Symbol("Let zodToJsonSchema decide on which parser to use"),a={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},i=e=>{const t=(e=>"string"===typeof e?{...a,name:e}:{...a,...e})(e),n=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map((e=>{let[n,r]=e;return[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]})))}};var s=n(7665);function o(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function l(e,t,n,r,a){e[t]=n,o(e,t,r,a)}function c(e,t){return N(e.type._def,t)}function u(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map(((n,r)=>u(e,t,n)))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return d(e,t)}}const d=(e,t)=>{const n={type:"integer",format:"unix-time"};if("openApi3"===t.target)return n;for(const r of e.checks)switch(r.kind){case"min":l(n,"minimum",r.value,r.message,t);break;case"max":l(n,"maximum",r.value,r.message,t)}return n};let h;const p=/^[cC][^\s-]{8,}$/,f=/^[0-9a-z]+$/,m=/^[0-9A-HJKMNP-TV-Z]{26}$/,g=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,y=()=>(void 0===h&&(h=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),h),v=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,b=/^[a-zA-Z0-9_-]{21}$/;function w(e,t){const n={type:"string"};function r(e){return"escape"===t.patternStrategy?_(e):e}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":l(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":l(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":x(n,"email",a.message,t);break;case"format:idn-email":x(n,"idn-email",a.message,t);break;case"pattern:zod":E(n,g,a.message,t)}break;case"url":x(n,"uri",a.message,t);break;case"uuid":x(n,"uuid",a.message,t);break;case"regex":E(n,a.regex,a.message,t);break;case"cuid":E(n,p,a.message,t);break;case"cuid2":E(n,f,a.message,t);break;case"startsWith":E(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":E(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":x(n,"date-time",a.message,t);break;case"date":x(n,"date",a.message,t);break;case"time":x(n,"time",a.message,t);break;case"duration":x(n,"duration",a.message,t);break;case"length":l(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t),l(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":E(n,RegExp(r(a.value)),a.message,t);break;case"ip":"v6"!==a.version&&x(n,"ipv4",a.message,t),"v4"!==a.version&&x(n,"ipv6",a.message,t);break;case"emoji":E(n,y,a.message,t);break;case"ulid":E(n,m,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":x(n,"binary",a.message,t);break;case"contentEncoding:base64":l(n,"contentEncoding","base64",a.message,t);break;case"pattern:zod":E(n,v,a.message,t)}break;case"nanoid":E(n,b,a.message,t)}return n}const _=e=>Array.from(e).map((e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`)).join(""),x=(e,t,n,r)=>{e.format||e.anyOf?.some((e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):l(e,"format",t,n,r)},E=(e,t,n,r)=>{e.pattern||e.allOf?.some((e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:k(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):l(e,"pattern",k(t,r),n,r)},k=(e,t)=>{const n="function"===typeof e?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r=n.flags.includes("i"),a=n.flags.includes("m"),i=n.flags.includes("s"),s=r?n.source.toLowerCase():n.source;let o="",l=!1,c=!1,u=!1;for(let d=0;d<s.length;d++)if(l)o+=s[d],l=!1;else{if(r)if(c){if(s[d].match(/[a-z]/)){u?(o+=s[d],o+=`${s[d-2]}-${s[d]}`.toUpperCase(),u=!1):"-"===s[d+1]&&s[d+2]?.match(/[a-z]/)?(o+=s[d],u=!0):o+=`${s[d]}${s[d].toUpperCase()}`;continue}}else if(s[d].match(/[a-z]/)){o+=`[${s[d]}${s[d].toUpperCase()}]`;continue}if(a){if("^"===s[d]){o+="(^|(?<=[\r\n]))";continue}if("$"===s[d]){o+="($|(?=[\r\n]))";continue}}i&&"."===s[d]?o+=c?`${s[d]}\r\n`:`[${s[d]}\r\n]`:(o+=s[d],"\\"===s[d]?l=!0:c&&"]"===s[d]?c=!1:c||"["!==s[d]||(c=!0))}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function S(e,t){if("openApi3"===t.target&&e.keyType?._def.typeName===s.kY.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce(((n,r)=>({...n,[r]:N(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",r]})??{}})),{}),additionalProperties:!1};const n={type:"object",additionalProperties:N(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return n;if(e.keyType?._def.typeName===s.kY.ZodString&&e.keyType._def.checks?.length){const{type:r,...a}=w(e.keyType._def,t);return{...n,propertyNames:a}}if(e.keyType?._def.typeName===s.kY.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===s.kY.ZodBranded&&e.keyType._def.type._def.typeName===s.kY.ZodString&&e.keyType._def.type._def.checks?.length){const{type:r,...a}=c(e.keyType._def,t);return{...n,propertyNames:a}}return n}const O={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};const P=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map(((e,n)=>N(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${n}`]}))).filter((e=>!!e&&(!t.strictUnions||"object"===typeof e&&Object.keys(e).length>0)));return n.length?{anyOf:n}:void 0};function T(e,t){return"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:N(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:N(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=t.seen.get(e);if(t.override){const i=t.override?.(e,t,a,n);if(i!==r)return i}if(a&&!n){const e=j(a,t);if(void 0!==e)return e}const i={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,i);const s=A(e,e.typeName,t);return s&&C(e,t,s),i.jsonSchema=s,s}const j=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:I(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every(((e,n)=>t.currentPath[n]===e))?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):"seen"===t.$refStrategy?{}:void 0}},I=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},A=(e,t,n)=>{switch(t){case s.kY.ZodString:return w(e,n);case s.kY.ZodNumber:return function(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",o(n,"type",r.message,t);break;case"min":"jsonSchema7"===t.target?r.inclusive?l(n,"minimum",r.value,r.message,t):l(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),l(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?l(n,"maximum",r.value,r.message,t):l(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),l(n,"maximum",r.value,r.message,t));break;case"multipleOf":l(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case s.kY.ZodObject:return function(e,t){const n={type:"object",...Object.entries(e.shape()).reduce(((e,n)=>{let[r,a]=n;if(void 0===a||void 0===a._def)return e;const i=N(a._def,{...t,currentPath:[...t.currentPath,"properties",r],propertyPath:[...t.currentPath,"properties",r]});return void 0===i?e:{properties:{...e.properties,[r]:i},required:a.isOptional()?e.required:[...e.required,r]}}),{properties:{},required:[]}),additionalProperties:T(e,t)};return n.required.length||delete n.required,n}(e,n);case s.kY.ZodBigInt:return function(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":"jsonSchema7"===t.target?r.inclusive?l(n,"minimum",r.value,r.message,t):l(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),l(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?l(n,"maximum",r.value,r.message,t):l(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),l(n,"maximum",r.value,r.message,t));break;case"multipleOf":l(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case s.kY.ZodBoolean:return{type:"boolean"};case s.kY.ZodDate:return u(e,n);case s.kY.ZodUndefined:return{not:{}};case s.kY.ZodNull:return function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}(n);case s.kY.ZodArray:return function(e,t){const n={type:"array"};return e.type?._def&&e.type?._def?.typeName!==s.kY.ZodAny&&(n.items=N(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&l(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&l(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(l(n,"minItems",e.exactLength.value,e.exactLength.message,t),l(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}(e,n);case s.kY.ZodUnion:case s.kY.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return P(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every((e=>e._def.typeName in O&&(!e._def.checks||!e._def.checks.length)))){const e=n.reduce(((e,t)=>{const n=O[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e}),[]);return{type:e.length>1?e:e[0]}}if(n.every((e=>"ZodLiteral"===e._def.typeName&&!e.description))){const e=n.reduce(((e,t)=>{const n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[...e,n];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}}),[]);if(e.length===n.length){const t=e.filter(((e,t,n)=>n.indexOf(e)===t));return{type:t.length>1?t:t[0],enum:n.reduce(((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value]),[])}}}else if(n.every((e=>"ZodEnum"===e._def.typeName)))return{type:"string",enum:n.reduce(((e,t)=>[...e,...t._def.values.filter((t=>!e.includes(t)))]),[])};return P(e,t)}(e,n);case s.kY.ZodIntersection:return function(e,t){const n=[N(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),N(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter((e=>!!e));let r="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach((e=>{if("type"in(t=e)&&"string"===t.type||!("allOf"in t)){let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){const{additionalProperties:n,...r}=e;t=r}else r=void 0;a.push(t)}else a.push(...e.allOf),void 0===e.unevaluatedProperties&&(r=void 0);var t})),a.length?{allOf:a,...r}:void 0}(e,n);case s.kY.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map(((e,n)=>N(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]}))).reduce(((e,t)=>void 0===t?e:[...e,t]),[]),additionalItems:N(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map(((e,n)=>N(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]}))).reduce(((e,t)=>void 0===t?e:[...e,t]),[])}}(e,n);case s.kY.ZodRecord:return S(e,n);case s.kY.ZodLiteral:return function(e,t){const n=typeof e.value;return"bigint"!==n&&"number"!==n&&"boolean"!==n&&"string"!==n?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===n?"integer":n,enum:[e.value]}:{type:"bigint"===n?"integer":n,const:e.value}}(e,n);case s.kY.ZodEnum:return function(e){return{type:"string",enum:e.values}}(e);case s.kY.ZodNativeEnum:return function(e){const t=e.values,n=Object.keys(e.values).filter((e=>"number"!==typeof t[t[e]])).map((e=>t[e])),r=Array.from(new Set(n.map((e=>typeof e))));return{type:1===r.length?"string"===r[0]?"string":"number":["string","number"],enum:n}}(e);case s.kY.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:O[e.innerType._def.typeName],nullable:!0}:{type:[O[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){const n=N(e.innerType._def,{...t,currentPath:[...t.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const n=N(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}(e,n);case s.kY.ZodOptional:return((e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return N(e.innerType._def,t);const n=N(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}})(e,n);case s.kY.ZodMap:return function(e,t){return"record"===t.mapStrategy?S(e,t):{type:"array",maxItems:125,items:{type:"array",items:[N(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},N(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,n);case s.kY.ZodSet:return function(e,t){const n={type:"array",uniqueItems:!0,items:N(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&l(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&l(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}(e,n);case s.kY.ZodLazy:return N(e.getter()._def,n);case s.kY.ZodPromise:return function(e,t){return N(e.type._def,t)}(e,n);case s.kY.ZodNaN:case s.kY.ZodNever:return{not:{}};case s.kY.ZodEffects:return function(e,t){return"input"===t.effectStrategy?N(e.schema._def,t):{}}(e,n);case s.kY.ZodAny:case s.kY.ZodUnknown:return{};case s.kY.ZodDefault:return function(e,t){return{...N(e.innerType._def,t),default:e.defaultValue()}}(e,n);case s.kY.ZodBranded:return c(e,n);case s.kY.ZodReadonly:case s.kY.ZodCatch:return((e,t)=>N(e.innerType._def,t))(e,n);case s.kY.ZodPipeline:return((e,t)=>{if("input"===t.pipeStrategy)return N(e.in._def,t);if("output"===t.pipeStrategy)return N(e.out._def,t);const n=N(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]});return{allOf:[n,N(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]})].filter((e=>void 0!==e))}})(e,n);case s.kY.ZodFunction:case s.kY.ZodVoid:case s.kY.ZodSymbol:default:return}},C=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),R=(e,t)=>{const n=i(t),r="object"===typeof t&&t.definitions?Object.entries(t.definitions).reduce(((e,t)=>{let[r,a]=t;return{...e,[r]:N(a._def,{...n,currentPath:[...n.basePath,n.definitionPath,r]},!0)??{}}}),{}):void 0,a="string"===typeof t?t:"title"===t?.nameStrategy?void 0:t?.name,s=N(e._def,void 0===a?n:{...n,currentPath:[...n.basePath,n.definitionPath,a]},!1)??{},o="object"===typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==o&&(s.title=o);const l=void 0===a?r?{...s,[n.definitionPath]:r}:s:{$ref:[..."relative"===n.$refStrategy?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:s}};return"jsonSchema7"===n.target?l.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===n.target&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),l}},7665:(e,t,n)=>{"use strict";var r,a;n.d(t,{kY:()=>Le,z:()=>bt}),function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!==typeof t[t[e]])),r={};for(const e of n)r[e]=t[e];return e.objectValues(r)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"===typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"===typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"===typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" | ";return e.map((e=>"string"===typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"===typeof t?t.toString():t}(r||(r={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(a||(a={}));const i=r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),s=e=>{switch(typeof e){case"undefined":return i.undefined;case"string":return i.string;case"number":return isNaN(e)?i.nan:i.number;case"boolean":return i.boolean;case"function":return i.function;case"bigint":return i.bigint;case"symbol":return i.symbol;case"object":return Array.isArray(e)?i.array:null===e?i.null:e.then&&"function"===typeof e.then&&e.catch&&"function"===typeof e.catch?i.promise:"undefined"!==typeof Map&&e instanceof Map?i.map:"undefined"!==typeof Set&&e instanceof Set?i.set:"undefined"!==typeof Date&&e instanceof Date?i.date:i.object;default:return i.unknown}},o=r.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class l extends Error{constructor(e){var t;super(),t=this,this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.issues=[...t.issues,...e]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(r);else if("invalid_return_type"===a.code)r(a.returnTypeError);else if("invalid_arguments"===a.code)r(a.argumentsError);else if(0===a.path.length)n._errors.push(t(a));else{let e=n,r=0;for(;r<a.path.length;){const n=a.path[r];r===a.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(a))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof l))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,r.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e.message;const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}l.create=e=>new l(e);const c=(e,t)=>{let n;switch(e.code){case o.invalid_type:n=e.received===i.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case o.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,r.jsonStringifyReplacer)}`;break;case o.unrecognized_keys:n=`Unrecognized key(s) in object: ${r.joinValues(e.keys,", ")}`;break;case o.invalid_union:n="Invalid input";break;case o.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${r.joinValues(e.options)}`;break;case o.invalid_enum_value:n=`Invalid enum value. Expected ${r.joinValues(e.options)}, received '${e.received}'`;break;case o.invalid_arguments:n="Invalid function arguments";break;case o.invalid_return_type:n="Invalid function return type";break;case o.invalid_date:n="Invalid date";break;case o.invalid_string:"object"===typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"===typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:r.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case o.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case o.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case o.custom:n="Invalid input";break;case o.invalid_intersection_types:n="Intersection results could not be merged";break;case o.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case o.not_finite:n="Number must be finite";break;default:n=t.defaultError,r.assertNever(e)}return{message:n}};let u=c;function d(){return u}const h=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,i=[...n,...a.path||[]],s={...a,path:i};if(void 0!==a.message)return{...a,path:i,message:a.message};let o="";const l=r.filter((e=>!!e)).slice().reverse();for(const c of l)o=c(s,{data:t,defaultError:o}).message;return{...a,path:i,message:o}};function p(e,t){const n=d(),r=h({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===c?void 0:c].filter((e=>!!e))});e.common.issues.push(r)}class f{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if("aborted"===r.status)return m;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t){const e=await r.key,t=await r.value;n.push({key:e,value:t})}return f.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:t,value:a}=r;if("aborted"===t.status)return m;if("aborted"===a.status)return m;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||"undefined"===typeof a.value&&!r.alwaysSet||(n[t.value]=a.value)}return{status:e.value,value:n}}}const m=Object.freeze({status:"aborted"}),g=e=>({status:"dirty",value:e}),y=e=>({status:"valid",value:e}),v=e=>"aborted"===e.status,b=e=>"dirty"===e.status,w=e=>"valid"===e.status,_=e=>"undefined"!==typeof Promise&&e instanceof Promise;function x(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function E(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n}var k,S,O;"function"===typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"===typeof e?{message:e}:e||{},e.toString=e=>"string"===typeof e?e:null===e||void 0===e?void 0:e.message}(k||(k={}));class P{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const T=(e,t)=>{if(w(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new l(e.common.issues);return this._error=t,this._error}}};function N(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(t,a)=>{var i,s;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!==o&&void 0!==o?o:a.defaultError}:"undefined"===typeof a.data?{message:null!==(i=null!==o&&void 0!==o?o:r)&&void 0!==i?i:a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:null!==(s=null!==o&&void 0!==o?o:n)&&void 0!==s?s:a.defaultError}},description:a}}class j{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return s(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:s(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new f,ctx:{common:e.parent.common,data:e.data,parsedType:s(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(_(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:null!==(n=null===t||void 0===t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null===t||void 0===t?void 0:t.errorMap},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)},a=this._parseSync({data:e,path:r.path,parent:r});return T(r,a)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null===t||void 0===t?void 0:t.errorMap,async:!0},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:s(e)},r=this._parse({data:e,path:n.path,parent:n}),a=await(_(r)?r:Promise.resolve(r));return T(n,a)}refine(e,t){const n=e=>"string"===typeof t||"undefined"===typeof t?{message:t}:"function"===typeof t?t(e):t;return this._refinement(((t,r)=>{const a=e(t),i=()=>r.addIssue({code:o.custom,...n(t)});return"undefined"!==typeof Promise&&a instanceof Promise?a.then((e=>!!e||(i(),!1))):!!a||(i(),!1)}))}refinement(e,t){return this._refinement(((n,r)=>!!e(n)||(r.addIssue("function"===typeof t?t(n,r):t),!1)))}_refinement(e){return new ke({schema:this,typeName:Le.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Se.create(this,this._def)}nullable(){return Oe.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ie.create(this,this._def)}promise(){return Ee.create(this,this._def)}or(e){return le.create([this,e],this._def)}and(e){return he.create(this,e,this._def)}transform(e){return new ke({...N(this._def),schema:this,typeName:Le.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"===typeof e?e:()=>e;return new Pe({...N(this._def),innerType:this,defaultValue:t,typeName:Le.ZodDefault})}brand(){return new Ie({typeName:Le.ZodBranded,type:this,...N(this._def)})}catch(e){const t="function"===typeof e?e:()=>e;return new Te({...N(this._def),innerType:this,catchValue:t,typeName:Le.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Ae.create(this,e)}readonly(){return Ce.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const I=/^c[^\s-]{8,}$/i,A=/^[0-9a-z]+$/,C=/^[0-9A-HJKMNP-TV-Z]{26}$/,R=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$=/^[a-z0-9_-]{21}$/i,L=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,M=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let D;const U=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,z=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,F=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,B="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",H=new RegExp(`^${B}$`);function Z(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function V(e){let t=`${B}T${Z(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}class q extends j{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==i.string){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.string,received:t.parsedType}),m}const t=new f;let n;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),p(n,{code:o.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),p(n,{code:o.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const r=e.data.length>i.value,a=e.data.length<i.value;(r||a)&&(n=this._getOrReturnCtx(e,n),r?p(n,{code:o.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&p(n,{code:o.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)M.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"email",code:o.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)D||(D=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),D.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"emoji",code:o.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)R.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"uuid",code:o.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)$.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"nanoid",code:o.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)I.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"cuid",code:o.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)A.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"cuid2",code:o.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)C.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"ulid",code:o.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(l){n=this._getOrReturnCtx(e,n),p(n,{validation:"url",code:o.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"regex",code:o.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),p(n,{code:o.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),p(n,{code:o.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),p(n,{code:o.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){V(i).test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{code:o.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else if("date"===i.kind){H.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{code:o.invalid_string,validation:"date",message:i.message}),t.dirty())}else if("time"===i.kind){new RegExp(`^${Z(i)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{code:o.invalid_string,validation:"time",message:i.message}),t.dirty())}else"duration"===i.kind?L.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"duration",code:o.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?(a=e.data,("v4"!==(s=i.version)&&s||!U.test(a))&&("v6"!==s&&s||!z.test(a))&&(n=this._getOrReturnCtx(e,n),p(n,{validation:"ip",code:o.invalid_string,message:i.message}),t.dirty())):"base64"===i.kind?F.test(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{validation:"base64",code:o.invalid_string,message:i.message}),t.dirty()):r.assertNever(i);var a,s;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:o.invalid_string,...k.errToObj(n)})}_addCheck(e){return new q({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}datetime(e){var t,n;return"string"===typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,offset:null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null===e||void 0===e?void 0:e.local)&&void 0!==n&&n,...k.errToObj(null===e||void 0===e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"===typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,...k.errToObj(null===e||void 0===e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...k.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null===t||void 0===t?void 0:t.position,...k.errToObj(null===t||void 0===t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...k.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...k.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...k.errToObj(t)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new q({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new q({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new q({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function W(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}q.create=e=>{var t;return new q({checks:[],typeName:Le.ZodString,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t,...N(e)})};class K extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==i.number){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.number,received:t.parsedType}),m}let t;const n=new f;for(const a of this._def.checks)if("int"===a.kind)r.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),p(t,{code:o.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty());else if("min"===a.kind){(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:o.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty())}else if("max"===a.kind){(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:o.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty())}else"multipleOf"===a.kind?0!==W(e.data,a.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:o.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),p(t,{code:o.not_finite,message:a.message}),n.dirty()):r.assertNever(a);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,r){return new K({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new K({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&r.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}K.create=e=>new K({checks:[],typeName:Le.ZodNumber,coerce:(null===e||void 0===e?void 0:e.coerce)||!1,...N(e)});class Y extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==i.bigint){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.bigint,received:t.parsedType}),m}let t;const n=new f;for(const a of this._def.checks)if("min"===a.kind){(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:o.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty())}else if("max"===a.kind){(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:o.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty())}else"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),p(t,{code:o.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):r.assertNever(a);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,r){return new Y({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new Y({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Y.create=e=>{var t;return new Y({checks:[],typeName:Le.ZodBigInt,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t,...N(e)})};class G extends j{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==i.boolean){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.boolean,received:t.parsedType}),m}return y(e.data)}}G.create=e=>new G({typeName:Le.ZodBoolean,coerce:(null===e||void 0===e?void 0:e.coerce)||!1,...N(e)});class J extends j{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==i.date){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.date,received:t.parsedType}),m}if(isNaN(e.data.getTime())){return p(this._getOrReturnCtx(e),{code:o.invalid_date}),m}const t=new f;let n;for(const a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),p(n,{code:o.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),t.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),p(n,{code:o.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),t.dirty()):r.assertNever(a);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new J({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}J.create=e=>new J({checks:[],coerce:(null===e||void 0===e?void 0:e.coerce)||!1,typeName:Le.ZodDate,...N(e)});class X extends j{_parse(e){if(this._getType(e)!==i.symbol){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.symbol,received:t.parsedType}),m}return y(e.data)}}X.create=e=>new X({typeName:Le.ZodSymbol,...N(e)});class Q extends j{_parse(e){if(this._getType(e)!==i.undefined){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.undefined,received:t.parsedType}),m}return y(e.data)}}Q.create=e=>new Q({typeName:Le.ZodUndefined,...N(e)});class ee extends j{_parse(e){if(this._getType(e)!==i.null){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.null,received:t.parsedType}),m}return y(e.data)}}ee.create=e=>new ee({typeName:Le.ZodNull,...N(e)});class te extends j{constructor(){super(...arguments),this._any=!0}_parse(e){return y(e.data)}}te.create=e=>new te({typeName:Le.ZodAny,...N(e)});class ne extends j{constructor(){super(...arguments),this._unknown=!0}_parse(e){return y(e.data)}}ne.create=e=>new ne({typeName:Le.ZodUnknown,...N(e)});class re extends j{_parse(e){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.never,received:t.parsedType}),m}}re.create=e=>new re({typeName:Le.ZodNever,...N(e)});class ae extends j{_parse(e){if(this._getType(e)!==i.undefined){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.void,received:t.parsedType}),m}return y(e.data)}}ae.create=e=>new ae({typeName:Le.ZodVoid,...N(e)});class ie extends j{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==i.array)return p(t,{code:o.invalid_type,expected:i.array,received:t.parsedType}),m;if(null!==r.exactLength){const e=t.data.length>r.exactLength.value,a=t.data.length<r.exactLength.value;(e||a)&&(p(t,{code:e?o.too_big:o.too_small,minimum:a?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(p(t,{code:o.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(p(t,{code:o.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>r.type._parseAsync(new P(t,e,t.path,n))))).then((e=>f.mergeArray(n,e)));const a=[...t.data].map(((e,n)=>r.type._parseSync(new P(t,e,t.path,n))));return f.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new ie({...this._def,minLength:{value:e,message:k.toString(t)}})}max(e,t){return new ie({...this._def,maxLength:{value:e,message:k.toString(t)}})}length(e,t){return new ie({...this._def,exactLength:{value:e,message:k.toString(t)}})}nonempty(e){return this.min(1,e)}}function se(e){if(e instanceof oe){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Se.create(se(r))}return new oe({...e._def,shape:()=>t})}return e instanceof ie?new ie({...e._def,type:se(e.element)}):e instanceof Se?Se.create(se(e.unwrap())):e instanceof Oe?Oe.create(se(e.unwrap())):e instanceof pe?pe.create(e.items.map((e=>se(e)))):e}ie.create=(e,t)=>new ie({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Le.ZodArray,...N(t)});class oe extends j{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=r.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==i.object){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.object,received:t.parsedType}),m}const{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:a}=this._getCached(),s=[];if(!(this._def.catchall instanceof re&&"strip"===this._def.unknownKeys))for(const i in n.data)a.includes(i)||s.push(i);const l=[];for(const i of a){const e=r[i],t=n.data[i];l.push({key:{status:"valid",value:i},value:e._parse(new P(n,t,n.path,i)),alwaysSet:i in n.data})}if(this._def.catchall instanceof re){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of s)l.push({key:{status:"valid",value:t},value:{status:"valid",value:n.data[t]}});else if("strict"===e)s.length>0&&(p(n,{code:o.unrecognized_keys,keys:s}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of s){const r=n.data[t];l.push({key:{status:"valid",value:t},value:e._parse(new P(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of l){const n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e})).then((e=>f.mergeObjectSync(t,e))):f.mergeObjectSync(t,l)}get shape(){return this._def.shape()}strict(e){return k.errToObj,new oe({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var r,a,i,s;const o=null!==(i=null===(a=(r=this._def).errorMap)||void 0===a?void 0:a.call(r,t,n).message)&&void 0!==i?i:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=k.errToObj(e).message)&&void 0!==s?s:o}:{message:o}}}:{}})}strip(){return new oe({...this._def,unknownKeys:"strip"})}passthrough(){return new oe({...this._def,unknownKeys:"passthrough"})}extend(e){return new oe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new oe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Le.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new oe({...this._def,catchall:e})}pick(e){const t={};return r.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new oe({...this._def,shape:()=>t})}omit(e){const t={};return r.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new oe({...this._def,shape:()=>t})}deepPartial(){return se(this)}partial(e){const t={};return r.objectKeys(this.shape).forEach((n=>{const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()})),new oe({...this._def,shape:()=>t})}required(e){const t={};return r.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof Se;)e=e._def.innerType;t[n]=e}})),new oe({...this._def,shape:()=>t})}keyof(){return we(r.objectKeys(this.shape))}}oe.create=(e,t)=>new oe({shape:()=>e,unknownKeys:"strip",catchall:re.create(),typeName:Le.ZodObject,...N(t)}),oe.strictCreate=(e,t)=>new oe({shape:()=>e,unknownKeys:"strict",catchall:re.create(),typeName:Le.ZodObject,...N(t)}),oe.lazycreate=(e,t)=>new oe({shape:e,unknownKeys:"strip",catchall:re.create(),typeName:Le.ZodObject,...N(t)});class le extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const n=e.map((e=>new l(e.ctx.common.issues)));return p(t,{code:o.invalid_union,unionErrors:n}),m}));{let e;const r=[];for(const i of n){const n={...t,common:{...t.common,issues:[]},parent:null},a=i._parseSync({data:t.data,path:t.path,parent:n});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=r.map((e=>new l(e)));return p(t,{code:o.invalid_union,unionErrors:a}),m}}get options(){return this._def.options}}le.create=(e,t)=>new le({options:e,typeName:Le.ZodUnion,...N(t)});const ce=e=>e instanceof ve?ce(e.schema):e instanceof ke?ce(e.innerType()):e instanceof be?[e.value]:e instanceof _e?e.options:e instanceof xe?r.objectValues(e.enum):e instanceof Pe?ce(e._def.innerType):e instanceof Q?[void 0]:e instanceof ee?[null]:e instanceof Se?[void 0,...ce(e.unwrap())]:e instanceof Oe?[null,...ce(e.unwrap())]:e instanceof Ie||e instanceof Ce?ce(e.unwrap()):e instanceof Te?ce(e._def.innerType):[];class ue extends j{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.object)return p(t,{code:o.invalid_type,expected:i.object,received:t.parsedType}),m;const n=this.discriminator,r=t.data[n],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(p(t,{code:o.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),m)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const r=new Map;for(const a of t){const t=ce(a.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const n of t){if(r.has(n))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);r.set(n,a)}}return new ue({typeName:Le.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...N(n)})}}function de(e,t){const n=s(e),a=s(t);if(e===t)return{valid:!0,data:e};if(n===i.object&&a===i.object){const n=r.objectKeys(t),a=r.objectKeys(e).filter((e=>-1!==n.indexOf(e))),i={...e,...t};for(const r of a){const n=de(e[r],t[r]);if(!n.valid)return{valid:!1};i[r]=n.data}return{valid:!0,data:i}}if(n===i.array&&a===i.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let r=0;r<e.length;r++){const a=de(e[r],t[r]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}return n===i.date&&a===i.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class he extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(v(e)||v(r))return m;const a=de(e.value,r.value);return a.valid?((b(e)||b(r))&&t.dirty(),{status:t.value,value:a.data}):(p(n,{code:o.invalid_intersection_types}),m)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((e=>{let[t,n]=e;return r(t,n)})):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}he.create=(e,t,n)=>new he({left:e,right:t,typeName:Le.ZodIntersection,...N(n)});class pe extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.array)return p(n,{code:o.invalid_type,expected:i.array,received:n.parsedType}),m;if(n.data.length<this._def.items.length)return p(n,{code:o.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),m;!this._def.rest&&n.data.length>this._def.items.length&&(p(n,{code:o.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map(((e,t)=>{const r=this._def.items[t]||this._def.rest;return r?r._parse(new P(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(r).then((e=>f.mergeArray(t,e))):f.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new pe({...this._def,rest:e})}}pe.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new pe({items:e,typeName:Le.ZodTuple,rest:null,...N(t)})};class fe extends j{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.object)return p(n,{code:o.invalid_type,expected:i.object,received:n.parsedType}),m;const r=[],a=this._def.keyType,s=this._def.valueType;for(const i in n.data)r.push({key:a._parse(new P(n,i,n.path,i)),value:s._parse(new P(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?f.mergeObjectAsync(t,r):f.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new fe(t instanceof j?{keyType:e,valueType:t,typeName:Le.ZodRecord,...N(n)}:{keyType:q.create(),valueType:e,typeName:Le.ZodRecord,...N(t)})}}class me extends j{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.map)return p(n,{code:o.invalid_type,expected:i.map,received:n.parsedType}),m;const r=this._def.keyType,a=this._def.valueType,s=[...n.data.entries()].map(((e,t)=>{let[i,s]=e;return{key:r._parse(new P(n,i,n.path,[t,"key"])),value:a._parse(new P(n,s,n.path,[t,"value"]))}}));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of s){const r=await n.key,a=await n.value;if("aborted"===r.status||"aborted"===a.status)return m;"dirty"!==r.status&&"dirty"!==a.status||t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of s){const r=n.key,a=n.value;if("aborted"===r.status||"aborted"===a.status)return m;"dirty"!==r.status&&"dirty"!==a.status||t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}}}}me.create=(e,t,n)=>new me({valueType:t,keyType:e,typeName:Le.ZodMap,...N(n)});class ge extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.set)return p(n,{code:o.invalid_type,expected:i.set,received:n.parsedType}),m;const r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(p(n,{code:o.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(p(n,{code:o.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const a=this._def.valueType;function s(e){const n=new Set;for(const r of e){if("aborted"===r.status)return m;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}const l=[...n.data.values()].map(((e,t)=>a._parse(new P(n,e,n.path,t))));return n.common.async?Promise.all(l).then((e=>s(e))):s(l)}min(e,t){return new ge({...this._def,minSize:{value:e,message:k.toString(t)}})}max(e,t){return new ge({...this._def,maxSize:{value:e,message:k.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ge.create=(e,t)=>new ge({valueType:e,minSize:null,maxSize:null,typeName:Le.ZodSet,...N(t)});class ye extends j{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.function)return p(t,{code:o.invalid_type,expected:i.function,received:t.parsedType}),m;function n(e,n){return h({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,d(),c].filter((e=>!!e)),issueData:{code:o.invalid_arguments,argumentsError:n}})}function r(e,n){return h({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,d(),c].filter((e=>!!e)),issueData:{code:o.invalid_return_type,returnTypeError:n}})}const a={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof Ee){const e=this;return y((async function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];const c=new l([]),u=await e._def.args.parseAsync(i,a).catch((e=>{throw c.addIssue(n(i,e)),c})),d=await Reflect.apply(s,this,u);return await e._def.returns._def.type.parseAsync(d,a).catch((e=>{throw c.addIssue(r(d,e)),c}))}))}{const e=this;return y((function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];const c=e._def.args.safeParse(i,a);if(!c.success)throw new l([n(i,c.error)]);const u=Reflect.apply(s,this,c.data),d=e._def.returns.safeParse(u,a);if(!d.success)throw new l([r(u,d.error)]);return d.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new ye({...this._def,args:pe.create(t).rest(ne.create())})}returns(e){return new ye({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ye({args:e||pe.create([]).rest(ne.create()),returns:t||ne.create(),typeName:Le.ZodFunction,...N(n)})}}class ve extends j{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ve.create=(e,t)=>new ve({getter:e,typeName:Le.ZodLazy,...N(t)});class be extends j{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return p(t,{received:t.data,code:o.invalid_literal,expected:this._def.value}),m}return{status:"valid",value:e.data}}get value(){return this._def.value}}function we(e,t){return new _e({values:e,typeName:Le.ZodEnum,...N(t)})}be.create=(e,t)=>new be({value:e,typeName:Le.ZodLiteral,...N(t)});class _e extends j{constructor(){super(...arguments),S.set(this,void 0)}_parse(e){if("string"!==typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return p(t,{expected:r.joinValues(n),received:t.parsedType,code:o.invalid_type}),m}if(x(this,S,"f")||E(this,S,new Set(this._def.values),"f"),!x(this,S,"f").has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return p(t,{received:t.data,code:o.invalid_enum_value,options:n}),m}return y(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return _e.create(e,{...this._def,...t})}exclude(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return _e.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}S=new WeakMap,_e.create=we;class xe extends j{constructor(){super(...arguments),O.set(this,void 0)}_parse(e){const t=r.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==i.string&&n.parsedType!==i.number){const e=r.objectValues(t);return p(n,{expected:r.joinValues(e),received:n.parsedType,code:o.invalid_type}),m}if(x(this,O,"f")||E(this,O,new Set(r.getValidEnumValues(this._def.values)),"f"),!x(this,O,"f").has(e.data)){const e=r.objectValues(t);return p(n,{received:n.data,code:o.invalid_enum_value,options:e}),m}return y(e.data)}get enum(){return this._def.values}}O=new WeakMap,xe.create=(e,t)=>new xe({values:e,typeName:Le.ZodNativeEnum,...N(t)});class Ee extends j{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.promise&&!1===t.common.async)return p(t,{code:o.invalid_type,expected:i.promise,received:t.parsedType}),m;const n=t.parsedType===i.promise?t.data:Promise.resolve(t.data);return y(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Ee.create=(e,t)=>new Ee({type:e,typeName:Le.ZodPromise,...N(t)});class ke extends j{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Le.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:e=>{p(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===a.type){const e=a.transform(n.data,i);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return m;const r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?m:"dirty"===r.status||"dirty"===t.value?g(r.value):r}));{if("aborted"===t.value)return m;const r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?m:"dirty"===r.status||"dirty"===t.value?g(r.value):r}}if("refinement"===a.type){const e=e=>{const t=a.refinement(e,i);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?m:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?m:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===a.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!w(e))return e;const r=a.transform(e.value,i);if(r instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:r}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>w(e)?Promise.resolve(a.transform(e.value,i)).then((e=>({status:t.value,value:e}))):e))}r.assertNever(a)}}ke.create=(e,t,n)=>new ke({schema:e,typeName:Le.ZodEffects,effect:t,...N(n)}),ke.createWithPreprocess=(e,t,n)=>new ke({schema:t,effect:{type:"preprocess",transform:e},typeName:Le.ZodEffects,...N(n)});class Se extends j{_parse(e){return this._getType(e)===i.undefined?y(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Se.create=(e,t)=>new Se({innerType:e,typeName:Le.ZodOptional,...N(t)});class Oe extends j{_parse(e){return this._getType(e)===i.null?y(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Oe.create=(e,t)=>new Oe({innerType:e,typeName:Le.ZodNullable,...N(t)});class Pe extends j{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===i.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Pe.create=(e,t)=>new Pe({innerType:e,typeName:Le.ZodDefault,defaultValue:"function"===typeof t.default?t.default:()=>t.default,...N(t)});class Te extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return _(r)?r.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new l(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new l(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Te.create=(e,t)=>new Te({innerType:e,typeName:Le.ZodCatch,catchValue:"function"===typeof t.catch?t.catch:()=>t.catch,...N(t)});class Ne extends j{_parse(e){if(this._getType(e)!==i.nan){const t=this._getOrReturnCtx(e);return p(t,{code:o.invalid_type,expected:i.nan,received:t.parsedType}),m}return{status:"valid",value:e.data}}}Ne.create=e=>new Ne({typeName:Le.ZodNaN,...N(e)});const je=Symbol("zod_brand");class Ie extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Ae extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?m:"dirty"===e.status?(t.dirty(),g(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?m:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new Ae({in:e,out:t,typeName:Le.ZodPipeline})}}class Ce extends j{_parse(e){const t=this._def.innerType._parse(e),n=e=>(w(e)&&(e.value=Object.freeze(e.value)),e);return _(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function Re(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e?te.create().superRefine(((r,a)=>{var i,s;if(!e(r)){const e="function"===typeof t?t(r):"string"===typeof t?{message:t}:t,o=null===(s=null!==(i=e.fatal)&&void 0!==i?i:n)||void 0===s||s,l="string"===typeof e?{message:e}:e;a.addIssue({code:"custom",...l,fatal:o})}})):te.create()}Ce.create=(e,t)=>new Ce({innerType:e,typeName:Le.ZodReadonly,...N(t)});const $e={object:oe.lazycreate};var Le;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Le||(Le={}));const Me=q.create,De=K.create,Ue=Ne.create,ze=Y.create,Fe=G.create,Be=J.create,He=X.create,Ze=Q.create,Ve=ee.create,qe=te.create,We=ne.create,Ke=re.create,Ye=ae.create,Ge=ie.create,Je=oe.create,Xe=oe.strictCreate,Qe=le.create,et=ue.create,tt=he.create,nt=pe.create,rt=fe.create,at=me.create,it=ge.create,st=ye.create,ot=ve.create,lt=be.create,ct=_e.create,ut=xe.create,dt=Ee.create,ht=ke.create,pt=Se.create,ft=Oe.create,mt=ke.createWithPreprocess,gt=Ae.create,yt={string:e=>q.create({...e,coerce:!0}),number:e=>K.create({...e,coerce:!0}),boolean:e=>G.create({...e,coerce:!0}),bigint:e=>Y.create({...e,coerce:!0}),date:e=>J.create({...e,coerce:!0})},vt=m;var bt=Object.freeze({__proto__:null,defaultErrorMap:c,setErrorMap:function(e){u=e},getErrorMap:d,makeIssue:h,EMPTY_PATH:[],addIssueToContext:p,ParseStatus:f,INVALID:m,DIRTY:g,OK:y,isAborted:v,isDirty:b,isValid:w,isAsync:_,get util(){return r},get objectUtil(){return a},ZodParsedType:i,getParsedType:s,ZodType:j,datetimeRegex:V,ZodString:q,ZodNumber:K,ZodBigInt:Y,ZodBoolean:G,ZodDate:J,ZodSymbol:X,ZodUndefined:Q,ZodNull:ee,ZodAny:te,ZodUnknown:ne,ZodNever:re,ZodVoid:ae,ZodArray:ie,ZodObject:oe,ZodUnion:le,ZodDiscriminatedUnion:ue,ZodIntersection:he,ZodTuple:pe,ZodRecord:fe,ZodMap:me,ZodSet:ge,ZodFunction:ye,ZodLazy:ve,ZodLiteral:be,ZodEnum:_e,ZodNativeEnum:xe,ZodPromise:Ee,ZodEffects:ke,ZodTransformer:ke,ZodOptional:Se,ZodNullable:Oe,ZodDefault:Pe,ZodCatch:Te,ZodNaN:Ne,BRAND:je,ZodBranded:Ie,ZodPipeline:Ae,ZodReadonly:Ce,custom:Re,Schema:j,ZodSchema:j,late:$e,get ZodFirstPartyTypeKind(){return Le},coerce:yt,any:qe,array:Ge,bigint:ze,boolean:Fe,date:Be,discriminatedUnion:et,effect:ht,enum:ct,function:st,instanceof:function(e){return Re((t=>t instanceof e),arguments.length>1&&void 0!==arguments[1]?arguments[1]:{message:`Input not instance of ${e.name}`})},intersection:tt,lazy:ot,literal:lt,map:at,nan:Ue,nativeEnum:ut,never:Ke,null:Ve,nullable:ft,number:De,object:Je,oboolean:()=>Fe().optional(),onumber:()=>De().optional(),optional:pt,ostring:()=>Me().optional(),pipeline:gt,preprocess:mt,promise:dt,record:rt,set:it,strictObject:Xe,string:Me,symbol:He,transformer:ht,tuple:nt,undefined:Ze,union:Qe,unknown:We,void:Ye,NEVER:vt,ZodIssueCode:o,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:l})}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r](i,i.exports,n),i.loaded=!0,i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,n.d(i,s),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{"use strict";var e={};n.r(e),n.d(e,{xX:()=>_a,qA:()=>xa,LG:()=>ba,cH:()=>wa,v3:()=>ka,v7:()=>Ea,fK:()=>Pa,pf:()=>Aa,PO:()=>ja,k5:()=>Ia,m_:()=>Oa,vc:()=>va,Ll:()=>Sa,OE:()=>Na,Is:()=>Ta});var t,r=n(5043),a=n.t(r,2),i=n(4391),s=n(7950),o=n.t(s,2);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(t||(t={}));const c="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function d(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function h(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,n,r){return void 0===n&&(n=null),l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?m(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function m(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function g(e,n,r,a){void 0===a&&(a={});let{window:i=document.defaultView,v5Compat:s=!1}=a,o=i.history,d=t.Pop,m=null,g=y();function y(){return(o.state||{idx:null}).idx}function v(){d=t.Pop;let e=y(),n=null==e?null:e-g;g=e,m&&m({action:d,location:w.location,delta:n})}function b(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:f(e);return n=n.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,o.replaceState(l({},o.state,{idx:g}),""));let w={get action(){return d},get location(){return e(i,o)},listen(e){if(m)throw new Error("A history only accepts one active listener");return i.addEventListener(c,v),m=e,()=>{i.removeEventListener(c,v),m=null}},createHref:e=>n(i,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,n){d=t.Push;let a=p(w.location,e,n);r&&r(a,e),g=y()+1;let l=h(a,g),c=w.createHref(a);try{o.pushState(l,"",c)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;i.location.assign(c)}s&&m&&m({action:d,location:w.location,delta:1})},replace:function(e,n){d=t.Replace;let a=p(w.location,e,n);r&&r(a,e),g=y();let i=h(a,g),l=w.createHref(a);o.replaceState(i,"",l),s&&m&&m({action:d,location:w.location,delta:0})},go:e=>o.go(e)};return w}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,n){return void 0===n&&(n="/"),b(e,t,n,!1)}function b(e,t,n,r){let a=C(("string"===typeof t?m(t):t).pathname||"/",n);if(null==a)return null;let i=w(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o){let e=A(a);s=j(i[o],e,r)}return s}function w(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,i)=>{let s={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(u(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let o=R([r,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),w(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:N(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of _(e.path))a(e,t,r);else a(e,t)})),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let s=_(r.join("/")),o=[];return o.push(...s.map((e=>""===e?i:[i,e].join("/")))),a&&o.push(...s),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const x=/^:[\w-]+$/,E=3,k=2,S=1,O=10,P=-2,T=e=>"*"===e;function N(e,t){let n=e.split("/"),r=n.length;return n.some(T)&&(r+=P),t&&(r+=k),n.filter((e=>!T(e))).reduce(((e,t)=>e+(x.test(t)?E:""===t?S:O)),r)}function j(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},i="/",s=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),s.push({params:a,pathname:R([i,u.pathname]),pathnameBase:$(R([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=R([i,u.pathnameBase]))}return s}function I(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);d("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[n]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:s,pattern:e}}function A(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function C(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}const R=e=>e.join("/").replace(/\/\/+/g,"/"),$=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");Error;function L(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const M=["post","put","patch","delete"],D=(new Set(M),["get",...M]);new Set(D),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},U.apply(this,arguments)}const z=r.createContext(null);const F=r.createContext(null);const B=r.createContext(null);const H=r.createContext(null);const Z=r.createContext({outlet:null,matches:[],isDataRoute:!1});const V=r.createContext(null);function q(){return null!=r.useContext(H)}function W(){return q()||u(!1),r.useContext(H).location}function K(e,n,a,i){q()||u(!1);let{navigator:s}=r.useContext(B),{matches:o}=r.useContext(Z),l=o[o.length-1],c=l?l.params:{},d=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let h,p=W();if(n){var f;let e="string"===typeof n?m(n):n;"/"===d||(null==(f=e.pathname)?void 0:f.startsWith(d))||u(!1),h=e}else h=p;let g=h.pathname||"/",y=g;if("/"!==d){let e=d.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=v(e,{pathname:y});let w=Q(b&&b.map((e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:R([d,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:R([d,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),o,a,i);return n&&w?r.createElement(H.Provider,{value:{location:U({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:t.Pop}},w):w}function Y(){let e=function(){var e;let t=r.useContext(V),n=te(ee.UseRouteError),a=ne(ee.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[a]}(),t=L(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:i},n):null,null)}const G=r.createElement(Y,null);class J extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(Z.Provider,{value:this.props.routeContext},r.createElement(V.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function X(e){let{routeContext:t,match:n,children:a}=e,i=r.useContext(z);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(Z.Provider,{value:t},a)}function Q(e,t,n,a){var i;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===a&&(a=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=a)&&s.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(i=n)?void 0:i.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||u(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,d=-1;if(n&&a&&a.v7_partialHydration)for(let r=0;r<o.length;r++){let e=o[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=r),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){c=!0,o=d>=0?o.slice(0,d+1):[o[0]];break}}}return o.reduceRight(((e,a,i)=>{let s,u=!1,h=null,p=null;var f;n&&(s=l&&a.route.id?l[a.route.id]:void 0,h=a.route.errorElement||G,c&&(d<0&&0===i?(f="route-fallback",!1||re[f]||(re[f]=!0),u=!0,p=null):d===i&&(u=!0,p=a.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,i+1)),g=()=>{let t;return t=s?h:u?p:a.route.Component?r.createElement(a.route.Component,null):a.route.element?a.route.element:e,r.createElement(X,{match:a,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===i)?r.createElement(J,{location:n.location,revalidation:n.revalidation,component:h,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var ee=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ee||{});function te(e){let t=r.useContext(F);return t||u(!1),t}function ne(e){let t=function(){let e=r.useContext(Z);return e||u(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||u(!1),n.route.id}const re={};a.startTransition;function ae(e){u(!1)}function ie(e){let{basename:n="/",children:a=null,location:i,navigationType:s=t.Pop,navigator:o,static:l=!1,future:c}=e;q()&&u(!1);let d=n.replace(/^\/*/,"/"),h=r.useMemo((()=>({basename:d,navigator:o,static:l,future:U({v7_relativeSplatPath:!1},c)})),[d,c,o,l]);"string"===typeof i&&(i=m(i));let{pathname:p="/",search:f="",hash:g="",state:y=null,key:v="default"}=i,b=r.useMemo((()=>{let e=C(p,d);return null==e?null:{location:{pathname:e,search:f,hash:g,state:y,key:v},navigationType:s}}),[d,p,f,g,y,v,s]);return null==b?null:r.createElement(B.Provider,{value:h},r.createElement(H.Provider,{children:a,value:b}))}function se(e){let{children:t,location:n}=e;return K(oe(t),n)}new Promise((()=>{}));r.Component;function oe(e,t){void 0===t&&(t=[]);let n=[];return r.Children.forEach(e,((e,a)=>{if(!r.isValidElement(e))return;let i=[...t,a];if(e.type===r.Fragment)return void n.push.apply(n,oe(e.props.children,i));e.type!==ae&&u(!1),e.props.index&&e.props.children&&u(!1);let s={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=oe(e.props.children,i)),n.push(s)})),n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch($u){}new Map;const le=a.startTransition;o.flushSync,a.useId;function ce(e){let{basename:t,children:n,future:a,window:i}=e,s=r.useRef();null==s.current&&(s.current=function(e){return void 0===e&&(e={}),g((function(e,t){let{pathname:n,search:r,hash:a}=e.location;return p("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:f(t)}),null,e)}({window:i,v5Compat:!0}));let o=s.current,[l,c]=r.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},d=r.useCallback((e=>{u&&le?le((()=>c(e))):c(e)}),[c,u]);return r.useLayoutEffect((()=>o.listen(d)),[o,d]),r.createElement(ie,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:a})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var ue,de;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ue||(ue={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(de||(de={}));const he=n.p+"static/media/github.7d6b7d8513e06be0a531dc9303e0bafe.svg",pe=n.p+"static/media/linkedin.9dfdc9701c0e1eb622bb.png",fe=n.p+"static/media/mail.647bb52528e6a0ce522c.png",me=n.p+"static/media/python.41259ded83ae0f2a4243.png";const ge=n.p+"static/media/java.2c5d38eae4a3a352dd64b4fe904a14dd.svg",ye=n.p+"static/media/haskell.00ab3e44fbe5f8d545c2.png",ve=n.p+"static/media/tf.3e7c926678403065937a.png",be=n.p+"static/media/spring.50a628da9f652a22993d.jpeg",we=n.p+"static/media/angular.8807829c44791fae5cbb.png",_e=n.p+"static/media/react.50c366299e5e3cc3a890.png",xe=n.p+"static/media/swift.d0cf8dd3a99e6de3edc6.png",Ee=n.p+"static/media/azure.6e06c048b84b463cc4ab.png",ke=n.p+"static/media/docker.6bc8607de8327c5d5003.png",Se=n.p+"static/media/html.22ec3220719446266714.png",Oe=n.p+"static/media/js.e86639f10ef8abc0a33c.png";var Pe=n(8139),Te=n.n(Pe);const Ne=r.createContext(null);function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},je.apply(null,arguments)}function Ie(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}n(2740);function Ae(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function Ce(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function Re(e,t){return Object.keys(t).reduce((function(n,a){var i,s=n,o=s[Ae(a)],l=s[a],c=Ie(s,[Ae(a),a].map(Ce)),u=t[a],d=function(e,t,n){var a=(0,r.useRef)(void 0!==e),i=(0,r.useState)(t),s=i[0],o=i[1],l=void 0!==e,c=a.current;return a.current=l,!l&&c&&s!==t&&o(t),[l?e:s,(0,r.useCallback)((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];n&&n.apply(void 0,[e].concat(r)),o(e)}),[n])]}(l,o,e[u]),h=d[0],p=d[1];return je({},c,((i={})[a]=h,i[u]=p,i))}),e)}function $e(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function Le(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function Me(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}$e.__suppressDeprecationWarning=!0,Le.__suppressDeprecationWarning=!0,Me.__suppressDeprecationWarning=!0;var De=n(579);const Ue=["xxl","xl","lg","md","sm","xs"],ze="xs",Fe=r.createContext({prefixes:{},breakpoints:Ue,minBreakpoint:ze}),{Consumer:Be,Provider:He}=Fe;function Ze(e,t){const{prefixes:n}=(0,r.useContext)(Fe);return e||n[t]||t}const Ve=r.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,as:a,...i}=e;n=Ze(n,"navbar-brand");const s=a||(i.href?"a":"span");return(0,De.jsx)(s,{...i,ref:t,className:Te()(r,n)})}));Ve.displayName="NavbarBrand";const qe=Ve;function We(e){return e&&e.ownerDocument||document}function Ke(e,t){return function(e){var t=We(e);return t&&t.defaultView||window}(e).getComputedStyle(e,t)}var Ye=/([A-Z])/g;var Ge=/^ms-/;function Je(e){return function(e){return e.replace(Ye,"-$1").toLowerCase()}(e).replace(Ge,"-ms-")}var Xe=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const Qe=function(e,t){var n="",r="";if("string"===typeof t)return e.style.getPropertyValue(Je(t))||Ke(e).getPropertyValue(Je(t));Object.keys(t).forEach((function(a){var i=t[a];i||0===i?!function(e){return!(!e||!Xe.test(e))}(a)?n+=Je(a)+": "+i+";":r+=a+"("+i+") ":e.style.removeProperty(Je(a))})),r&&(n+="transform: "+r+";"),e.style.cssText+=";"+n};function et(e,t){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},et(e,t)}const tt=!1,nt=r.createContext(null);var rt="unmounted",at="exited",it="entering",st="entered",ot="exiting",lt=function(e){var t,n;function a(t,n){var r;r=e.call(this,t,n)||this;var a,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(a=at,r.appearStatus=it):a=st:a=t.unmountOnExit||t.mountOnEnter?rt:at,r.state={status:a},r.nextCallback=null,r}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,et(t,n),a.getDerivedStateFromProps=function(e,t){return e.in&&t.status===rt?{status:at}:null};var i=a.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==it&&n!==st&&(t=it):n!==it&&n!==st||(t=ot)}this.updateStatus(!1,t)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},i.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===it){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:s.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===at&&this.setState({status:rt})},i.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,a=this.props.nodeRef?[r]:[s.findDOMNode(this),r],i=a[0],o=a[1],l=this.getTimeouts(),c=r?l.appear:l.enter;!e&&!n||tt?this.safeSetState({status:st},(function(){t.props.onEntered(i)})):(this.props.onEnter(i,o),this.safeSetState({status:it},(function(){t.props.onEntering(i,o),t.onTransitionEnd(c,(function(){t.safeSetState({status:st},(function(){t.props.onEntered(i,o)}))}))})))},i.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:s.findDOMNode(this);t&&!tt?(this.props.onExit(r),this.safeSetState({status:ot},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:at},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:at},(function(){e.props.onExited(r)}))},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},i.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},i.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:s.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=a[0],o=a[1];this.props.addEndListener(i,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},i.render=function(){var e=this.state.status;if(e===rt)return null;var t=this.props,n=t.children,a=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,Ie(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return r.createElement(nt.Provider,{value:null},"function"===typeof n?n(e,a):r.cloneElement(r.Children.only(n),a))},a}(r.Component);function ct(){}lt.contextType=nt,lt.propTypes={},lt.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ct,onEntering:ct,onEntered:ct,onExit:ct,onExiting:ct,onExited:ct},lt.UNMOUNTED=rt,lt.EXITED=at,lt.ENTERING=it,lt.ENTERED=st,lt.EXITING=ot;const ut=lt,dt=!("undefined"===typeof window||!window.document||!window.document.createElement);var ht=!1,pt=!1;try{var ft={get passive(){return ht=!0},get once(){return pt=ht=!0}};dt&&(window.addEventListener("test",ft,ft),window.removeEventListener("test",ft,!0))}catch($u){}const mt=function(e,t,n,r){if(r&&"boolean"!==typeof r&&!pt){var a=r.once,i=r.capture,s=n;!pt&&a&&(s=n.__once||function e(r){this.removeEventListener(t,e,i),n.call(this,r)},n.__once=s),e.addEventListener(t,s,ht?r:i)}e.addEventListener(t,n,r)};const gt=function(e,t,n,r){var a=r&&"boolean"!==typeof r?r.capture:r;e.removeEventListener(t,n,a),n.__once&&e.removeEventListener(t,n.__once,a)};const yt=function(e,t,n,r){return mt(e,t,n,r),function(){gt(e,t,n,r)}};function vt(e,t,n){void 0===n&&(n=5);var r=!1,a=setTimeout((function(){r||function(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!0),e){var a=document.createEvent("HTMLEvents");a.initEvent(t,n,r),e.dispatchEvent(a)}}(e,"transitionend",!0)}),t+n),i=yt(e,"transitionend",(function(){r=!0}),{once:!0});return function(){clearTimeout(a),i()}}function bt(e,t,n,r){null==n&&(n=function(e){var t=Qe(e,"transitionDuration")||"",n=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*n}(e)||0);var a=vt(e,n,r),i=yt(e,"transitionend",t);return function(){a(),i()}}function wt(e,t){const n=Qe(e,t)||"",r=-1===n.indexOf("ms")?1e3:1;return parseFloat(n)*r}function _t(e,t){const n=wt(e,"transitionDuration"),r=wt(e,"transitionDelay"),a=bt(e,(n=>{n.target===e&&(a(),t(n))}),n+r)}const xt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e=>null!=e)).reduce(((e,t)=>{if("function"!==typeof t)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===e?t:function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];e.apply(this,r),t.apply(this,r)}}),null)};function Et(e){e.offsetHeight}const kt=e=>e&&"function"!==typeof e?t=>{e.current=t}:e;const St=function(e,t){return(0,r.useMemo)((()=>function(e,t){const n=kt(e),r=kt(t);return e=>{n&&n(e),r&&r(e)}}(e,t)),[e,t])};const Ot=r.forwardRef(((e,t)=>{let{onEnter:n,onEntering:a,onEntered:i,onExit:o,onExiting:l,onExited:c,addEndListener:u,children:d,childRef:h,...p}=e;const f=(0,r.useRef)(null),m=St(f,h),g=e=>{var t;m((t=e)&&"setState"in t?s.findDOMNode(t):null!=t?t:null)},y=e=>t=>{e&&f.current&&e(f.current,t)},v=(0,r.useCallback)(y(n),[n]),b=(0,r.useCallback)(y(a),[a]),w=(0,r.useCallback)(y(i),[i]),_=(0,r.useCallback)(y(o),[o]),x=(0,r.useCallback)(y(l),[l]),E=(0,r.useCallback)(y(c),[c]),k=(0,r.useCallback)(y(u),[u]);return(0,De.jsx)(ut,{ref:t,...p,onEnter:v,onEntered:w,onEntering:b,onExit:_,onExited:E,onExiting:x,addEndListener:k,nodeRef:f,children:"function"===typeof d?(e,t)=>d(e,{...t,ref:g}):r.cloneElement(d,{ref:g})})})),Pt={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function Tt(e,t){const n=t[`offset${e[0].toUpperCase()}${e.slice(1)}`],r=Pt[e];return n+parseInt(Qe(t,r[0]),10)+parseInt(Qe(t,r[1]),10)}const Nt={[at]:"collapse",[ot]:"collapsing",[it]:"collapsing",[st]:"collapse show"},jt=r.forwardRef(((e,t)=>{let{onEnter:n,onEntering:a,onEntered:i,onExit:s,onExiting:o,className:l,children:c,dimension:u="height",in:d=!1,timeout:h=300,mountOnEnter:p=!1,unmountOnExit:f=!1,appear:m=!1,getDimensionValue:g=Tt,...y}=e;const v="function"===typeof u?u():u,b=(0,r.useMemo)((()=>xt((e=>{e.style[v]="0"}),n)),[v,n]),w=(0,r.useMemo)((()=>xt((e=>{const t=`scroll${v[0].toUpperCase()}${v.slice(1)}`;e.style[v]=`${e[t]}px`}),a)),[v,a]),_=(0,r.useMemo)((()=>xt((e=>{e.style[v]=null}),i)),[v,i]),x=(0,r.useMemo)((()=>xt((e=>{e.style[v]=`${g(v,e)}px`,Et(e)}),s)),[s,g,v]),E=(0,r.useMemo)((()=>xt((e=>{e.style[v]=null}),o)),[v,o]);return(0,De.jsx)(Ot,{ref:t,addEndListener:_t,...y,"aria-expanded":y.role?d:null,onEnter:b,onEntering:w,onEntered:_,onExit:x,onExiting:E,childRef:c.ref,in:d,timeout:h,mountOnEnter:p,unmountOnExit:f,appear:m,children:(e,t)=>r.cloneElement(c,{...t,className:Te()(l,c.props.className,Nt[e],"width"===v&&"collapse-horizontal")})})})),It=jt,At=r.createContext(null);At.displayName="NavbarContext";const Ct=At,Rt=r.forwardRef(((e,t)=>{let{children:n,bsPrefix:a,...i}=e;a=Ze(a,"navbar-collapse");const s=(0,r.useContext)(Ct);return(0,De.jsx)(It,{in:!(!s||!s.expanded),...i,children:(0,De.jsx)("div",{ref:t,className:a,children:n})})}));Rt.displayName="NavbarCollapse";const $t=Rt;const Lt=function(e){const t=(0,r.useRef)(e);return(0,r.useEffect)((()=>{t.current=e}),[e]),t};function Mt(e){const t=Lt(e);return(0,r.useCallback)((function(){return t.current&&t.current(...arguments)}),[t])}const Dt=r.forwardRef(((e,t)=>{let{bsPrefix:n,className:a,children:i,label:s="Toggle navigation",as:o="button",onClick:l,...c}=e;n=Ze(n,"navbar-toggler");const{onToggle:u,expanded:d}=(0,r.useContext)(Ct)||{},h=Mt((e=>{l&&l(e),u&&u()}));return"button"===o&&(c.type="button"),(0,De.jsx)(o,{...c,ref:t,onClick:h,"aria-label":s,className:Te()(a,n,!d&&"collapsed"),children:i||(0,De.jsx)("span",{className:`${n}-icon`})})}));Dt.displayName="NavbarToggle";const Ut=Dt,zt="undefined"!==typeof n.g&&n.g.navigator&&"ReactNative"===n.g.navigator.product,Ft="undefined"!==typeof document||zt?r.useLayoutEffect:r.useEffect,Bt=new WeakMap,Ht=(e,t)=>{if(!e||!t)return;const n=Bt.get(t)||new Map;Bt.set(t,n);let r=n.get(e);return r||(r=t.matchMedia(e),r.refCount=0,n.set(r.media,r)),r};function Zt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"undefined"===typeof window?void 0:window;const n=Ht(e,t),[a,i]=(0,r.useState)((()=>!!n&&n.matches));return Ft((()=>{let n=Ht(e,t);if(!n)return i(!1);let r=Bt.get(t);const a=()=>{i(n.matches)};return n.refCount++,n.addListener(a),a(),()=>{n.removeListener(a),n.refCount--,n.refCount<=0&&(null==r||r.delete(n.media)),n=void 0}}),[e]),a}const Vt=function(e){const t=Object.keys(e);function n(e,t){return e===t?t:e?`${e} and ${t}`:t}function a(n){const r=function(e){return t[Math.min(t.indexOf(e)+1,t.length-1)]}(n);let a=e[r];return a="number"===typeof a?a-.2+"px":`calc(${a} - 0.2px)`,`(max-width: ${a})`}return function(t,i,s){let o;return"object"===typeof t?(o=t,s=i,i=!0):(i=i||!0,o={[t]:i}),Zt((0,r.useMemo)((()=>Object.entries(o).reduce(((t,r)=>{let[i,s]=r;return"up"!==s&&!0!==s||(t=n(t,function(t){let n=e[t];return"number"===typeof n&&(n=`${n}px`),`(min-width: ${n})`}(i))),"down"!==s&&!0!==s||(t=n(t,a(i))),t}),"")),[JSON.stringify(o)]),s)}}({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),qt=Vt;function Wt(e){void 0===e&&(e=We());try{var t=e.activeElement;return t&&t.nodeName?t:null}catch($u){return e.body}}function Kt(e,t){return e.contains?e.contains(t):e.compareDocumentPosition?e===t||!!(16&e.compareDocumentPosition(t)):void 0}function Yt(e){const t=function(e){const t=(0,r.useRef)(e);return t.current=e,t}(e);(0,r.useEffect)((()=>()=>t.current()),[])}const Gt=`data-rr-ui-${"modal-open"}`;const Jt=class{constructor(){let{ownerDocument:e,handleContainerOverflow:t=!0,isRTL:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.handleContainerOverflow=t,this.isRTL=n,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const t={overflow:"hidden"},n=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();e.style={overflow:r.style.overflow,[n]:r.style[n]},e.scrollBarWidth&&(t[n]=`${parseInt(Qe(r,n)||"0",10)+e.scrollBarWidth}px`),r.setAttribute(Gt,""),Qe(r,t)}reset(){[...this.modals].forEach((e=>this.remove(e)))}removeContainerStyle(e){const t=this.getElement();t.removeAttribute(Gt),Object.assign(t.style,e.style)}add(e){let t=this.modals.indexOf(e);return-1!==t?t:(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),0!==t||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t)}remove(e){const t=this.modals.indexOf(e);-1!==t&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}},Xt=(0,r.createContext)(dt?window:void 0);Xt.Provider;function Qt(){return(0,r.useContext)(Xt)}const en=(e,t)=>dt?null==e?(t||We()).body:("function"===typeof e&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;const tn=function(e){let{children:t,in:n,onExited:a,mountOnEnter:i,unmountOnExit:s}=e;const o=(0,r.useRef)(null),l=(0,r.useRef)(n),c=Mt(a);(0,r.useEffect)((()=>{n?l.current=!0:c(o.current)}),[n,c]);const u=St(o,t.ref),d=(0,r.cloneElement)(t,{ref:u});return n?d:s||!l.current&&i?null:d};function nn(){const e=r.version.split(".");return{major:+e[0],minor:+e[1],patch:+e[2]}}const rn=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];const an=["component"];const sn=r.forwardRef(((e,t)=>{let{component:n}=e;const a=function(e){let{onEnter:t,onEntering:n,onEntered:a,onExit:i,onExiting:s,onExited:o,addEndListener:l,children:c}=e,u=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,rn);const{major:d}=nn(),h=d>=19?c.props.ref:c.ref,p=(0,r.useRef)(null),f=St(p,"function"===typeof c?null:h),m=e=>t=>{e&&p.current&&e(p.current,t)},g=(0,r.useCallback)(m(t),[t]),y=(0,r.useCallback)(m(n),[n]),v=(0,r.useCallback)(m(a),[a]),b=(0,r.useCallback)(m(i),[i]),w=(0,r.useCallback)(m(s),[s]),_=(0,r.useCallback)(m(o),[o]),x=(0,r.useCallback)(m(l),[l]);return Object.assign({},u,{nodeRef:p},t&&{onEnter:g},n&&{onEntering:y},a&&{onEntered:v},i&&{onExit:b},s&&{onExiting:w},o&&{onExited:_},l&&{addEndListener:x},{children:"function"===typeof c?(e,t)=>c(e,Object.assign({},t,{ref:f})):(0,r.cloneElement)(c,{ref:f})})}(function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,an));return(0,De.jsx)(n,Object.assign({ref:t},a))}));function on(e){let{children:t,in:n,onExited:a,onEntered:i,transition:s}=e;const[o,l]=(0,r.useState)(!n);n&&o&&l(!1);const c=function(e){let{in:t,onTransition:n}=e;const a=(0,r.useRef)(null),i=(0,r.useRef)(!0),s=Mt(n);return Ft((()=>{if(!a.current)return;let e=!1;return s({in:t,element:a.current,initial:i.current,isStale:()=>e}),()=>{e=!0}}),[t,s]),Ft((()=>(i.current=!1,()=>{i.current=!0})),[]),a}({in:!!n,onTransition:e=>{Promise.resolve(s(e)).then((()=>{e.isStale()||(e.in?null==i||i(e.element,e.initial):(l(!0),null==a||a(e.element)))}),(t=>{throw e.in||l(!0),t}))}}),u=St(c,t.ref);return o&&!n?null:(0,r.cloneElement)(t,{ref:u})}function ln(e,t,n){return e?(0,De.jsx)(sn,Object.assign({},n,{component:e})):t?(0,De.jsx)(on,Object.assign({},n,{transition:t})):(0,De.jsx)(tn,Object.assign({},n))}const cn=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];let un;function dn(e){const t=Qt(),n=e||function(e){return un||(un=new Jt({ownerDocument:null==e?void 0:e.document})),un}(t),a=(0,r.useRef)({dialog:null,backdrop:null});return Object.assign(a.current,{add:()=>n.add(a.current),remove:()=>n.remove(a.current),isTopModal:()=>n.isTopModal(a.current),setDialogRef:(0,r.useCallback)((e=>{a.current.dialog=e}),[]),setBackdropRef:(0,r.useCallback)((e=>{a.current.backdrop=e}),[])})}const hn=(0,r.forwardRef)(((e,t)=>{let{show:n=!1,role:a="dialog",className:i,style:o,children:l,backdrop:c=!0,keyboard:u=!0,onBackdropClick:d,onEscapeKeyDown:h,transition:p,runTransition:f,backdropTransition:m,runBackdropTransition:g,autoFocus:y=!0,enforceFocus:v=!0,restoreFocus:b=!0,restoreFocusOptions:w,renderDialog:_,renderBackdrop:x=e=>(0,De.jsx)("div",Object.assign({},e)),manager:E,container:k,onShow:S,onHide:O=()=>{},onExit:P,onExited:T,onExiting:N,onEnter:j,onEntering:I,onEntered:A}=e,C=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,cn);const R=Qt(),$=function(e,t){const n=Qt(),[a,i]=(0,r.useState)((()=>en(e,null==n?void 0:n.document)));if(!a){const t=en(e);t&&i(t)}return(0,r.useEffect)((()=>{t&&a&&t(a)}),[t,a]),(0,r.useEffect)((()=>{const t=en(e);t!==a&&i(t)}),[e,a]),a}(k),L=dn(E),M=function(){const e=(0,r.useRef)(!0),t=(0,r.useRef)((()=>e.current));return(0,r.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),t.current}(),D=function(e){const t=(0,r.useRef)(null);return(0,r.useEffect)((()=>{t.current=e})),t.current}(n),[U,z]=(0,r.useState)(!n),F=(0,r.useRef)(null);(0,r.useImperativeHandle)(t,(()=>L),[L]),dt&&!D&&n&&(F.current=Wt(null==R?void 0:R.document)),n&&U&&z(!1);const B=Mt((()=>{if(L.add(),K.current=yt(document,"keydown",q),W.current=yt(document,"focus",(()=>setTimeout(Z)),!0),S&&S(),y){var e,t;const n=Wt(null!=(e=null==(t=L.dialog)?void 0:t.ownerDocument)?e:null==R?void 0:R.document);L.dialog&&n&&!Kt(L.dialog,n)&&(F.current=n,L.dialog.focus())}})),H=Mt((()=>{var e;(L.remove(),null==K.current||K.current(),null==W.current||W.current(),b)&&(null==(e=F.current)||null==e.focus||e.focus(w),F.current=null)}));(0,r.useEffect)((()=>{n&&$&&B()}),[n,$,B]),(0,r.useEffect)((()=>{U&&H()}),[U,H]),Yt((()=>{H()}));const Z=Mt((()=>{if(!v||!M()||!L.isTopModal())return;const e=Wt(null==R?void 0:R.document);L.dialog&&e&&!Kt(L.dialog,e)&&L.dialog.focus()})),V=Mt((e=>{e.target===e.currentTarget&&(null==d||d(e),!0===c&&O())})),q=Mt((e=>{u&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&L.isTopModal()&&(null==h||h(e),e.defaultPrevented||O())})),W=(0,r.useRef)(),K=(0,r.useRef)();if(!$)return null;const Y=Object.assign({role:a,ref:L.setDialogRef,"aria-modal":"dialog"===a||void 0},C,{style:o,className:i,tabIndex:-1});let G=_?_(Y):(0,De.jsx)("div",Object.assign({},Y,{children:r.cloneElement(l,{role:"document"})}));G=ln(p,f,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:P,onExiting:N,onExited:function(){z(!0),null==T||T(...arguments)},onEnter:j,onEntering:I,onEntered:A,children:G});let J=null;return c&&(J=x({ref:L.setBackdropRef,onClick:V}),J=ln(m,g,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:J})),(0,De.jsx)(De.Fragment,{children:s.createPortal((0,De.jsxs)(De.Fragment,{children:[J,G]}),$)})}));hn.displayName="Modal";const pn=Object.assign(hn,{Manager:Jt}),fn={[it]:"show",[st]:"show"},mn=r.forwardRef(((e,t)=>{let{className:n,children:a,transitionClasses:i={},onEnter:s,...o}=e;const l={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...o},c=(0,r.useCallback)(((e,t)=>{Et(e),null==s||s(e,t)}),[s]),{major:u}=nn(),d=u>=19?a.props.ref:a.ref;return(0,De.jsx)(Ot,{ref:t,addEndListener:_t,...l,onEnter:c,childRef:d,children:(e,t)=>r.cloneElement(a,{...t,className:Te()("fade",n,a.props.className,fn[e],i[e])})})}));mn.displayName="Fade";const gn=mn,yn=r.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:a="div",...i}=e;return r=Ze(r,"offcanvas-body"),(0,De.jsx)(a,{ref:t,className:Te()(n,r),...i})}));yn.displayName="OffcanvasBody";const vn=yn,bn={[it]:"show",[st]:"show"},wn=r.forwardRef(((e,t)=>{let{bsPrefix:n,className:a,children:i,in:s=!1,mountOnEnter:o=!1,unmountOnExit:l=!1,appear:c=!1,...u}=e;return n=Ze(n,"offcanvas"),(0,De.jsx)(Ot,{ref:t,addEndListener:_t,in:s,mountOnEnter:o,unmountOnExit:l,appear:c,...u,childRef:i.ref,children:(e,t)=>r.cloneElement(i,{...t,className:Te()(a,i.props.className,(e===it||e===ot)&&`${n}-toggling`,bn[e])})})}));wn.displayName="OffcanvasToggling";const _n=wn,xn=r.createContext({onHide(){}});var En=n(5173),kn=n.n(En);const Sn={"aria-label":kn().string,onClick:kn().func,variant:kn().oneOf(["white"])},On=r.forwardRef(((e,t)=>{let{className:n,variant:r,"aria-label":a="Close",...i}=e;return(0,De.jsx)("button",{ref:t,type:"button",className:Te()("btn-close",r&&`btn-close-${r}`,n),"aria-label":a,...i})}));On.displayName="CloseButton",On.propTypes=Sn;const Pn=On,Tn=r.forwardRef(((e,t)=>{let{closeLabel:n="Close",closeVariant:a,closeButton:i=!1,onHide:s,children:o,...l}=e;const c=(0,r.useContext)(xn),u=Mt((()=>{null==c||c.onHide(),null==s||s()}));return(0,De.jsxs)("div",{ref:t,...l,children:[o,i&&(0,De.jsx)(Pn,{"aria-label":n,variant:a,onClick:u})]})})),Nn=Tn,jn=r.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,closeLabel:a="Close",closeButton:i=!1,...s}=e;return n=Ze(n,"offcanvas-header"),(0,De.jsx)(Nn,{ref:t,...s,className:Te()(r,n),closeLabel:a,closeButton:i})}));jn.displayName="OffcanvasHeader";const In=jn,An=(Cn="h5",r.forwardRef(((e,t)=>(0,De.jsx)("div",{...e,ref:t,className:Te()(e.className,Cn)}))));var Cn;const Rn=r.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:a=An,...i}=e;return r=Ze(r,"offcanvas-title"),(0,De.jsx)(a,{ref:t,className:Te()(n,r),...i})}));Rn.displayName="OffcanvasTitle";const $n=Rn;var Ln=Function.prototype.bind.call(Function.prototype.call,[].slice);function Mn(e,t){return Ln(e.querySelectorAll(t))}function Dn(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const Un=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",zn=".sticky-top",Fn=".navbar-toggler";class Bn extends Jt{adjustAndStore(e,t,n){const r=t.style[e];t.dataset[e]=r,Qe(t,{[e]:`${parseFloat(Qe(t,e))+n}px`})}restore(e,t){const n=t.dataset[e];void 0!==n&&(delete t.dataset[e],Qe(t,{[e]:n}))}setContainerStyle(e){super.setContainerStyle(e);const t=this.getElement();if(function(e,t){e.classList?e.classList.add(t):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(e,t)||("string"===typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}(t,"modal-open"),!e.scrollBarWidth)return;const n=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";Mn(t,Un).forEach((t=>this.adjustAndStore(n,t,e.scrollBarWidth))),Mn(t,zn).forEach((t=>this.adjustAndStore(r,t,-e.scrollBarWidth))),Mn(t,Fn).forEach((t=>this.adjustAndStore(r,t,e.scrollBarWidth)))}removeContainerStyle(e){super.removeContainerStyle(e);const t=this.getElement();!function(e,t){e.classList?e.classList.remove(t):"string"===typeof e.className?e.className=Dn(e.className,t):e.setAttribute("class",Dn(e.className&&e.className.baseVal||"",t))}(t,"modal-open");const n=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";Mn(t,Un).forEach((e=>this.restore(n,e))),Mn(t,zn).forEach((e=>this.restore(r,e))),Mn(t,Fn).forEach((e=>this.restore(r,e)))}}let Hn;const Zn=Bn;function Vn(e){return(0,De.jsx)(_n,{...e})}function qn(e){return(0,De.jsx)(gn,{...e})}const Wn=r.forwardRef(((e,t)=>{let{bsPrefix:n,className:a,children:i,"aria-labelledby":s,placement:o="start",responsive:l,show:c=!1,backdrop:u=!0,keyboard:d=!0,scroll:h=!1,onEscapeKeyDown:p,onShow:f,onHide:m,container:g,autoFocus:y=!0,enforceFocus:v=!0,restoreFocus:b=!0,restoreFocusOptions:w,onEntered:_,onExit:x,onExiting:E,onEnter:k,onEntering:S,onExited:O,backdropClassName:P,manager:T,renderStaticNode:N=!1,...j}=e;const I=(0,r.useRef)();n=Ze(n,"offcanvas");const[A,C]=(0,r.useState)(!1),R=Mt(m),$=qt(l||"xs","up");(0,r.useEffect)((()=>{C(l?c&&!$:c)}),[c,l,$]);const L=(0,r.useMemo)((()=>({onHide:R})),[R]);const M=(0,r.useCallback)((e=>(0,De.jsx)("div",{...e,className:Te()(`${n}-backdrop`,P)})),[P,n]),D=e=>(0,De.jsx)("div",{...e,...j,className:Te()(a,l?`${n}-${l}`:n,`${n}-${o}`),"aria-labelledby":s,children:i});return(0,De.jsxs)(De.Fragment,{children:[!A&&(l||N)&&D({}),(0,De.jsx)(xn.Provider,{value:L,children:(0,De.jsx)(pn,{show:A,ref:t,backdrop:u,container:g,keyboard:d,autoFocus:y,enforceFocus:v&&!h,restoreFocus:b,restoreFocusOptions:w,onEscapeKeyDown:p,onShow:f,onHide:R,onEnter:function(e){e&&(e.style.visibility="visible");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==k||k(e,...n)},onEntering:S,onEntered:_,onExit:x,onExiting:E,onExited:function(e){e&&(e.style.visibility="");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==O||O(...n)},manager:T||(h?(I.current||(I.current=new Zn({handleContainerOverflow:!1})),I.current):function(e){return Hn||(Hn=new Bn(e)),Hn}()),transition:Vn,backdropTransition:qn,renderBackdrop:M,renderDialog:D})})]})}));Wn.displayName="Offcanvas";const Kn=Object.assign(Wn,{Body:vn,Header:In,Title:$n}),Yn=r.forwardRef(((e,t)=>{let{onHide:n,...a}=e;const i=(0,r.useContext)(Ct),s=Mt((()=>{null==i||null==i.onToggle||i.onToggle(),null==n||n()}));return(0,De.jsx)(Kn,{ref:t,show:!(null==i||!i.expanded),...a,renderStaticNode:!0,onHide:s})}));Yn.displayName="NavbarOffcanvas";const Gn=Yn,Jn=r.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:a="span",...i}=e;return r=Ze(r,"navbar-text"),(0,De.jsx)(a,{ref:t,className:Te()(n,r),...i})}));Jn.displayName="NavbarText";const Xn=Jn,Qn=r.forwardRef(((e,t)=>{const{bsPrefix:n,expand:a=!0,variant:i="light",bg:s,fixed:o,sticky:l,className:c,as:u="nav",expanded:d,onToggle:h,onSelect:p,collapseOnSelect:f=!1,...m}=Re(e,{expanded:"onToggle"}),g=Ze(n,"navbar"),y=(0,r.useCallback)((function(){null==p||p(...arguments),f&&d&&(null==h||h(!1))}),[p,f,d,h]);void 0===m.role&&"nav"!==u&&(m.role="navigation");let v=`${g}-expand`;"string"===typeof a&&(v=`${v}-${a}`);const b=(0,r.useMemo)((()=>({onToggle:()=>null==h?void 0:h(!d),bsPrefix:g,expanded:!!d,expand:a})),[g,d,a,h]);return(0,De.jsx)(Ct.Provider,{value:b,children:(0,De.jsx)(Ne.Provider,{value:y,children:(0,De.jsx)(u,{ref:t,...m,className:Te()(c,g,a&&v,i&&`${g}-${i}`,s&&`bg-${s}`,l&&`sticky-${l}`,o&&`fixed-${o}`)})})})}));Qn.displayName="Navbar";const er=Object.assign(Qn,{Brand:qe,Collapse:$t,Offcanvas:Gn,Text:Xn,Toggle:Ut}),tr=()=>{const[e,t]=(0,r.useState)();return(0,De.jsx)(er,{expanded:e,bg:"light",expand:"lg",children:(0,De.jsxs)("div",{className:"container-fluid",children:[(0,De.jsx)("div",{className:"navbar-brand pull-left",children:(0,De.jsx)("a",{href:"/",className:"navbar-brand mb-0 h1",children:"Portfolio"})}),(0,De.jsx)("button",{className:"navbar-toggler",type:"button",onClick:()=>{t(!e)},"aria-controls":"navbarText","aria-label":"Toggle navigation",children:(0,De.jsx)("span",{className:"navbar-toggler-icon"})}),(0,De.jsx)(er.Collapse,{id:"navbarText",children:(0,De.jsxs)("ul",{className:"nav navbar-pull-right",children:[(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://github.com/roryn959",children:(0,De.jsx)("img",{src:he,alt:"Github",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.linkedin.com/in/rorybnicholas/",children:(0,De.jsx)("img",{src:pe,alt:"LinkedIn",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"mailto:roryn959@icloud.com",children:(0,De.jsx)("img",{src:fe,alt:"Mail",height:"25"})})})]})}),(0,De.jsx)("div",{className:"navbar-header pull-right d-none d-lg-block",children:(0,De.jsxs)("ul",{className:"nav pull-left",children:[(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.python.org",children:(0,De.jsx)("img",{src:me,alt:"Python",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.java.com/en/",children:(0,De.jsx)("img",{src:ge,alt:"Java",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.open-std.org/jtc1/sc22/wg14/",children:(0,De.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADRCAMAAAC+Xw3/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAC9FBMVEUAAACmv8ynu8uqus6ou86ouc6pus6qus2pu82pus2ous2pus6pus2pus2pus2pus6pu82pus2pus2qus6pus2pu8yqusyouc2ousyoucuktsiqudGpuc2pus6pucyqus2pus2pus2quc2pus2pus6qu8yquc2nus6ltNKouc6pu82pus6pus2pus2pus2pu82quc6ZzMyfv7+nus6pus6pus2pus2pus2puc2ou82quMapuc6qu82pus2pus2pus6pvM62ttuqts6pus2pus2quc2qqtWpucyqucypus2qus2pus6uudGpus2pus2ou8////+pu82AgP+pu82puc6qqqqqu8ypus2qus2ous2pu86ovM+qu82qucupusyqvM6pus2pus2xscSmvM2pus2quc6/v7+pusynt8+pus2ousyouc6qxsaousytvMuqu8ypus2pus2puc2qus2puc2pus6zs8ypus6pus2pus2vv8+pus6qv9Wous6pus2qusypus2ouMypus2quc2pusymvMipus2sus+qvM2qu82tvc6pus2ouc6qv8qpus2ou82pus2ou82puc6iudGqvdCpu82pusyous2pus2qus2sucypus2puc2pus2tuMyqvM6pus6puc2pus2puc2quc2puc2ouM6qus+qu8yous2ouc2qu8yous2pu82ovcypus2ou86qus6nucypucypuc2qus2pus2ouc2nuM2pus2qus2pus2pu82qus2pu82puc2qus6ou82pus2qus6ous2ous2pus6pus2pus2pu82nus6pusyou82uvMmpusumuNCnu8uoucyouc6pucypus2puc2pus6qt8uqu82puMyousyousynucqousypus2quMuou82ovNCpusyou82quM2pusupusypucypu8ypus2pu82pus2pusypusynuc+pu82puc2pus2ous2pus2pusyqu8yqu8yquc2qus2qu8ypus3///+E1I7YAAAA+nRSTlMAFDFObYebrb7Q3e3u+/7ozcO4qpiDb1tGLA4hTXehy/Pv0bKRaUIaEUl/terxx5VjBQhDhsr8+caKEmKz9tOMRAcVwPRmBlCw+rxoFuuxTwGvAlY+A1rVUddTNcJFpipr8A0u5lQEfSDpZJYJnCIe/XaAuazECrrMwRDJDIGjfvUy4TOrF70lSGwfqVgY7KjlcHwLG9iIot9gKFyP9xk5gue0i3WaLzAPkIQ82mUj+F6/N25xyNJMPYXF5PLOjrtdKZQ/n5NZruJHNOOZEzsrQGqlX9bcoCd7QdSNHVWnNlImzzgkStmSdImkepfeOp23nuDbcy1LV7Z4VG/t8wAAAAFiS0dEUONuTLwAAAAHdElNRQfnAQwTJSUNtA4bAAAJHUlEQVR42t2d+UMVVRTHRxRR4D0XcksNFAxUEAN9YG6ACCqUTwz3DUvMLXHJylwwpRTEHdSKwkwzU7FMxLRwqdTKpdRMszJNbbUys7o/hYgL+HjMzPfMzBm/f8C59/Pmzdx7lnuuJGmgSi6Vq7hWdatW3d3D09MihNXT07OGe81atb3uqVO3Xv0G90rs1bBR4/u8fURFatLU16/Z/f48GQKat2gZKBQpqFVwa5cHOEGEhLZpaxPqFBbertGDLCgqte/QUWCyduocEWksRVSVLjZBomjfrlFGUcTEdusuCGXrERdvxBeq3UOCXJaHe+r79ttDe9mENqrRrqFuGAm9mwoNZXN7RBeMxD59hdaq2c+uOUdsf6GHmg7QFmXgIKGXqg/WDsN/iFXoqJZDNXrHhyUJfWXxG64Bx6OthP56bAQ1RvLI7sIQudGu9o8PEkZpVCNCjtE+wjhZx4yl8jfGCWNV/QkSjvFthdEK6knA0dxTGK+UCfjrYREsNC4Z269PFFw0CVkcQyYLPnpSfUBsylOCk55WG24Z/ozgJe8AVRxTwwU3PTtNzf/qScFPPZTHv0KqCY4akqDUM58seGq6wvVjBlMOYe2tCGSmYKvUWQo4Rlj5gojn5H+EZ6cKzpojlyPtMcFbXWV+sJ5nziFSX5AFUkewV7ic1WRuCn8QMU9GKq2GCTiET3qFIBnCFJpcEcd8YRLVd86RucAsIJ2c+/ALhWnkdDGJMA+HWOQk/hjT30QgYnH5IEvMxCFGLS2PY1lHU4GIuuWB0MeqbVndZozJblwne8zyLu5h1NZXlPPhGkpbA5C0cKVLSKnU3YsvvdyW1NGZ7xikG+EQOVUHxzgc5JXRLel+r6cdDvEqHYZHnTRnaYrcVVQDDXRk/zUq65bVFYXRxr5OtIFY48D4Wqp/b9s3ZPgK694kcRZ8hmu2ObGuT5Tnh761gWK4jXfY3UTzCuZtlh3hWOpGMN7bd5gNJuEIfEdJEHA9/m9OWVbG6LQgCo6g2crimVvwId8tY7IZBUdHxQVjr8Njbi1jMZ+AI2Wb8tzFanjQzFL2CigeyHY15Xg90FHbk28X31OVP47aAQ7rViqpQ1CI5ZkuqVJlcNydt+ewehM8kNFqU8doRqngNlsP4xzvJ6gF8QfduSW3TD2IuzzWAvVVCR9gQxfesrQLfyALgfKKtGho6NRbjo8X/kB2IwUve7DBb26LInfCIL5Y2Sc2+LCbeQT8n7UXK6XCKts+vGHmI5jDG6wJm4dFgW+YwcOLK0GQdCzmVBKoewX2CnLWoWV62J61xHn4GH4gc1AOKRsa/6XrRtbAIP1gEGzDVbLthoMATfCjd5nQBPZdT37CDySDoCZ3PzKBvsUmDsAgXQlAOiATiCbKiVDUe/tBM6h0zUQvOLhPUba+GJrCJ9dMfIqCfEYB0hOawoAiCwfhf9ZmiYUOwSCHeYC0hqNyyTxA2lGH+oySLwoyhgnIBg7LIYHseSjIER4g8fBHK50HyCyUw8Lko4VGXoU7k3f9cxTkeSYguSjIOCYge1CQ9UxAvqBORhqllijIUSYg8HmwbUxAjqEgrzIB2Y+CvMgEBK6cymQC4oGCBDABgXM8S5mAwLt4Lj3k0Do2q/0uAQljwiGhGXYfLiDRIEgSF5Cku+WJoA3xcriAoCt7dy4gx9HPLxeQmuiCyCSIIsH9ENYxAYHzVcuYgHyJgpxgAvImCvIJE5CvUJCTTEDaoyC9mYDARWdVmICsvVsijVEoSFUmIHDGqgOXPUoWCHKKCwia1c1JYALyNfqSnGYCEne3rIihKEgczTwKvkG0V5L8UZA1NCBYwey3RRbQfi41STgSc+BluTbqtYdQgLyATaK1hNYOF+k7CpAz+BcHbk1Dkg7NxteA71GQ2hQgb0NTaHItlG4fhZbQETR6fgBrVV2r2Ah8GvsADrKXovhtMQrih4O0wWYwrNjIbBRkFR6kO4vN4FyxkWT4KDtcNPADNn5eJFGQDj4I0wIbP7zEzEYUJO+gsd7dyyVmTsN1jRMxjiNUISm4vUDSVCO9VGsa0f5AlDrBrGLDCKaWq9+0NBAGWYBkF9DWwl/figkdh0mAwvI30Fz/ebKFtUgp6s+zo73pU6cQBk6FuKDWvzqKjlyqe8UxnOSiOg5/+C6Nzbeb+xEHURdOSZyEDmspdU9BFEGjO4uaC7R+goedVNogRXetpLWKOerh/Zx2Ecfpij3Ocwo5RuCXtESXaRNnz6Ig8YlVxDGf4LKZn8sa3UgBIlJy5TtZ9pkUXe8iypoNIWo52Epu4j1gH8VwWfY7DP9CAyLC2si6S2cEzQ/noJ1pANnlYQ9NqPAynVlETSGjHfkP2wWZdga7OHs53vKl6gn5q8M/LenFWxtcTzruoHB4ujvZIDbHR+l/EbRKreXXvuC2O78T0kPneZF2pR/i+JEv1aT1vWXVKe/CwsKtTX/LozZtLW8r0UyYS73K3YqeNRWHrfy7US9ZzQTyu5Mv43ITceSMdwKS2cQ8ILnaetC6aX8FR3D2mQXkjObBAH30R8Xepyk4gmTU8vxpBpDWMjyFKfn8OSbZZUXHg7hzBPrLDAowX+CtzeXGBabzBlktP8DB+qqeQQoOcYa04stxWdGF7fFZXDmiFQZmT19m6oTEKgzLSpt4Xoqo4lBBg0CGHKoy+rt3sOP4SF1aLP0vZhyf2dWBSP59WXHsUcshSQGcrg/trJ5DkpL3cMGwgpU70hUeV4h23wyX6Z1cxYDDI5SgJje+0HCOfIoOtkUviqvBf6+MaRKRLm0wECOnLuF5mWnBhnmNx/4mPvpz3BAMW+exErFi6vroz3H8EUkDpbvp/XZMD5G00UldXeAOmzQ8JVdZt/Bd/nltz/sl9NEFZcUu7Y+c2ptX0xrDPS5G0kUDh+RpiNGpno7dVipd0ShgZOtW3y7pKvuRD+kzjovaGNIIOTFiOWXkPserkXEdfMZeDf6NhCLo23+GSwZr95V/wQdz7OLcGImFEl22zFmkDuLCfSu5NCC6obQD/2VcUHKt7Qrf3KsHJaaKOXH13eA/OjnvCefhneE6+tA6yQyKTL8Ue3TLyNVrvLy8CovVy2tGsGvjuH6XGpK7GNL/5tH9zMcNd5AAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjMtMDEtMTJUMTk6Mzc6MzcrMDA6MDDIjApBAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIzLTAxLTEyVDE5OjM3OjM3KzAwOjAwudGy/QAAAABJRU5ErkJggg==",alt:"C",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.haskell.org",children:(0,De.jsx)("img",{src:ye,alt:"Haskell",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.tensorflow.org",children:(0,De.jsx)("img",{src:ve,alt:"Tensorflow",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://spring.io",children:(0,De.jsx)("img",{src:be,alt:"Spring",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://angular.io",children:(0,De.jsx)("img",{src:we,alt:"Angular",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://react.dev",children:(0,De.jsx)("img",{src:_e,alt:"React",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.swift.org",children:(0,De.jsx)("img",{src:xe,alt:"Swift",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://azure.microsoft.com/en-in/",children:(0,De.jsx)("img",{src:Ee,alt:"Azure",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://www.docker.com",children:(0,De.jsx)("img",{src:ke,alt:"Docker",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://html.spec.whatwg.org",children:(0,De.jsx)("img",{src:Se,alt:"HTML5",height:"25"})})}),(0,De.jsx)("li",{className:"nav-item",children:(0,De.jsx)("a",{className:"navbar-brand",href:"https://ecma-international.org/publications-and-standards/standards/ecma-262/",children:(0,De.jsx)("img",{src:Oe,alt:"JavaScript",height:"25"})})})]})})]})})},nr=n.p+"static/media/mainwindow_app.cdae3be7461a8a57a70c.png",rr=n.p+"static/media/ixn.1ecc8fb01b02d30bf21b.jpeg",ar=n.p+"static/media/chessMove1.e2f1e1397bf0d15c270d.png",ir=()=>(0,De.jsxs)("div",{className:"row row-cols-1 row-cols-md-3 g-4 m-4",children:[(0,De.jsx)("div",{className:"col",children:(0,De.jsxs)("div",{className:"card p-2",children:[(0,De.jsx)("img",{src:nr,alt:"Sketch Application"}),(0,De.jsxs)("div",{className:"card-body",children:[(0,De.jsx)("h5",{className:"card-title",children:"Sketch Completion with Machine Learning"}),(0,De.jsx)("p",{className:"card-text",children:"Investigation into the use of vector-based image generation models to autocomplete or reinterpret sketches based on user preference. Leverages a bidirectional sequence-to-sequence variational autoencoder and transfer learning."}),(0,De.jsx)("a",{href:"sketchApp",className:"btn btn-outline-primary",children:"See more"})]})]})}),(0,De.jsx)("div",{className:"col",children:(0,De.jsxs)("div",{className:"card p-2",children:[(0,De.jsx)("img",{src:rr,alt:"UCL IXN Programme"}),(0,De.jsxs)("div",{className:"card-body",children:[(0,De.jsx)("h5",{className:"card-title",children:"Modern Workplace Automation (UCL/Microsoft)"}),(0,De.jsx)("p",{className:"card-text",children:"Made on behalf of the UCL engineering department in conjunction with Microsoft as part of the IXN programme. Automates and streamlines the process of matching final-year students to academics and industry partners for final-year projects based on stakeholder preferences and niches."}),(0,De.jsx)("a",{href:"https://james-parky.github.io/workplace-automation-website.github.io/",className:"btn btn-outline-primary",children:"See more"})]})]})}),(0,De.jsx)("div",{className:"col",children:(0,De.jsxs)("div",{className:"card p-2",children:[(0,De.jsx)("img",{src:ar,alt:"Knifefish chess engine"}),(0,De.jsxs)("div",{className:"card-body",children:[(0,De.jsx)("h5",{className:"card-title",children:"Knifefish"}),(0,De.jsx)("p",{className:"card-text",children:"A chess engine originally written using Python, and later re-written into Java. Achieves a rating of ~1400 and ~1600 in the respective languages using techniques including Minimax with Alphabeta pruning, Quiescience search, dynamic evalutaion, transposition tables, and Zobrist hashing."}),(0,De.jsx)("a",{href:"knifefish",className:"btn btn-outline-primary",children:"See more"})]})]})})]}),sr=()=>(0,De.jsxs)("div",{className:"jumbotron m-4",children:[(0,De.jsx)("h1",{className:"display-4",children:"Rory Nicholas"}),(0,De.jsx)("h2",{className:"lead",children:"University College London - Computer Science BSc"}),(0,De.jsx)("hr",{className:"my-4"})]}),or=r.forwardRef(((e,t)=>{let{bsPrefix:n,fluid:r=!1,as:a="div",className:i,...s}=e;const o=Ze(n,"container"),l="string"===typeof r?`-${r}`:"-fluid";return(0,De.jsx)(a,{ref:t,...s,className:Te()(i,r?`${o}${l}`:o)})}));or.displayName="Container";const lr=or,cr="4.69.0";let ur,dr,hr,pr,fr,mr,gr,yr,vr,br=!1,wr=null,_r=null,xr=null,Er=null;class kr{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}ur||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{auto:!1};if(br)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(ur)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${ur}'\``);br=t.auto,ur=e.kind,dr=e.fetch,wr=e.Request,_r=e.Response,xr=e.Headers,hr=e.FormData,Er=e.Blob,pr=e.File,fr=e.ReadableStream,mr=e.getMultipartRequestOptions,gr=e.getDefaultAgent,yr=e.fileFromPath,vr=e.isFsReadStream}(function(){let{manuallyImported:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,a,i;try{n=fetch,r=Request,a=Response,i=Headers}catch(s){throw new Error(`this environment is missing the following Web Fetch API type: ${s.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:a,Headers:i,FormData:"undefined"!==typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!==typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!==typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!==typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new kr(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});class Sr{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=Sr.NEWLINE_CHARS.has(t[t.length-1]||"");let r=t.split(Sr.NEWLINE_REGEXP);return n&&r.pop(),1!==r.length||n?(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r):(this.buffer.push(r[0]),[])}decodeText(e){if(null==e)return"";if("string"===typeof e)return e;if("undefined"!==typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new va(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!==typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new va(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new va("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Sr.NEWLINE_CHARS=new Set(["\n","\r"]),Sr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Or{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new Or((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(e,t){if(!e.body)throw t.abort(),new va("Attempted to iterate over a response with no body");const n=new Tr,r=new Sr,a=Nr(e.body);for await(const i of async function*(e){let t=new Uint8Array;for await(const n of e){if(null==n)continue;const e=n instanceof ArrayBuffer?new Uint8Array(n):"string"===typeof n?(new TextEncoder).encode(n):n;let r,a=new Uint8Array(t.length+e.length);for(a.set(t),a.set(e,t.length),t=a;-1!==(r=Pr(t));)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}(a))for(const e of r.decode(i)){const t=n.decode(e);t&&(yield t)}for(const i of r.flush()){const e=n.decode(i);e&&(yield e)}}(e,t))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event){let e;try{e=JSON.parse(n.data)}catch($u){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),$u}if(e&&e.error)throw new ba(void 0,e.error,void 0,void 0);yield e}else{let e;try{e=JSON.parse(n.data)}catch($u){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),$u}if("error"==n.event)throw new ba(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}r=!0}catch($u){if($u instanceof Error&&"AbortError"===$u.name)return;throw $u}finally{r||t.abort()}}),t)}static fromReadableStream(e,t){let n=!1;return new Or((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const t of async function*(){const t=new Sr,n=Nr(e);for await(const e of n)for(const n of t.decode(e))yield n;for(const e of t.flush())yield e}())r||t&&(yield JSON.parse(t));r=!0}catch($u){if($u instanceof Error&&"AbortError"===$u.name)return;throw $u}finally{r||t.abort()}}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new Or((()=>r(e)),this.controller),new Or((()=>r(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new fr({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:r,done:a}=await t.next();if(a)return e.close();const i=n.encode(JSON.stringify(r)+"\n");e.enqueue(i)}catch(r){e.error(r)}},async cancel(){await(t.return?.())}})}}function Pr(e){for(let t=0;t<e.length-2;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}class Tr{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}function Nr(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch($u){throw t.releaseLock(),$u}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const jr=e=>null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob,Ir=e=>null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&Ar(e),Ar=e=>null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer,Cr=e=>Ir(e)||jr(e)||vr(e);async function Rr(e,t,n){if(e=await e,Ir(e))return e;if(jr(e)){const r=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=Ar(r)?[await r.arrayBuffer()]:[r];return new pr(a,t,n)}const r=await async function(e){let t=[];if("string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Ar(e))t.push(await e.arrayBuffer());else{if(!Lr(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const n of e)t.push(n)}return t}(e);if(t||(t=function(e){return $r(e.name)||$r(e.filename)||$r(e.path)?.split(/[\\/]/).pop()}(e)??"unknown_file"),!n?.type){const e=r[0]?.type;"string"===typeof e&&(n={...n,type:e})}return new pr(r,t,n)}const $r=e=>"string"===typeof e?e:"undefined"!==typeof Buffer&&e instanceof Buffer?String(e):void 0,Lr=e=>null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator],Mr=e=>e&&"object"===typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],Dr=async e=>{const t=await Ur(e.body);return mr(t,e)},Ur=async e=>{const t=new hr;return await Promise.all(Object.entries(e||{}).map((e=>{let[n,r]=e;return zr(t,n,r)}))),t},zr=async(e,t,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"===typeof n||"number"===typeof n||"boolean"===typeof n)e.append(t,String(n));else if(Cr(n)){const r=await Rr(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>zr(e,t+"[]",n))));else{if("object"!==typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((n=>{let[r,a]=n;return zr(e,`${t}[${r}]`,a)})))}}};var Fr,Br=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},Hr=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};async function Zr(e){const{response:t}=e;if(e.options.stream)return fa("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Or.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){const e=await t.json();return fa("response",t.status,t.url,t.headers,e),Vr(e,t)}const r=await t.text();return fa("response",t.status,t.url,t.headers,r),r}function Vr(e,t){return!e||"object"!==typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class qr extends Promise{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zr;super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new qr(this.responsePromise,(async t=>Vr(e(await this.parseResponse(t),t),t.response)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Wr{constructor(e){let{baseURL:t,maxRetries:n=2,timeout:r=6e5,httpAgent:a,fetch:i}=e;this.baseURL=t,this.maxRetries=la("maxRetries",n),this.timeout=la("timeout",r),this.httpAgent=a,this.fetch=i??dr}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...ra(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ma()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&Ar(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}})))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"===typeof e){if("undefined"!==typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!==typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){let{retryCount:t=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{method:n,path:r,query:a,headers:i={}}=e,s=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"===typeof e.body?e.body:Mr(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(s),l=this.buildURL(r,a);"timeout"in e&&la("timeout",e.timeout);const c=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??gr(l),d=c+1e3;"number"===typeof u?.options?.timeout&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&"get"!==n&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);return{req:{method:n,...s&&{body:s},headers:this.buildHeaders({options:e,headers:i,contentLength:o,retryCount:t}),...u&&{agent:u},signal:e.signal??null},url:l,timeout:c}}buildHeaders(e){let{options:t,headers:n,contentLength:r,retryCount:a}=e;const i={};r&&(i["content-length"]=r);const s=this.defaultHeaders(t);return pa(i,s),pa(i,n),Mr(t.body)&&"node"!==ur&&delete i["content-type"],void 0===ga(s,"x-stainless-retry-count")&&void 0===ga(n,"x-stainless-retry-count")&&(i["x-stainless-retry-count"]=String(a)),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,t){let{url:n,options:r}=t}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,n,r){return ba.generate(e,t,n,r)}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new qr(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e,r=n.maxRetries??this.maxRetries;null==t&&(t=r),await this.prepareOptions(n);const{req:a,url:i,timeout:s}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:i,options:n}),fa("request",i,n,a.headers),n.signal?.aborted)throw new wa;const o=new AbortController,l=await this.fetchWithTimeout(i,a,s,o).catch(ca);if(l instanceof Error){if(n.signal?.aborted)throw new wa;if(t)return this.retryRequest(n,t);if("AbortError"===l.name)throw new xa;throw new _a({cause:l})}const c=Gr(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){return fa(`response (error; ${`retrying, ${t} attempts remaining`})`,l.status,i,c),this.retryRequest(n,t,c)}const e=await l.text().catch((e=>ca(e).message)),r=aa(e),a=r?void 0:e;fa(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,c,a);throw this.makeStatusError(l.status,r,a,c)}return{response:l,options:n,controller:o}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Yr(this,n,e)}buildURL(e,t){const n=sa(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return da(r)||(t={...r,...t}),"object"===typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((e=>{let[t,n]=e;return"undefined"!==typeof n})).map((e=>{let[t,n]=e;if("string"===typeof n||"number"===typeof n||"boolean"===typeof n)return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(null===n)return`${encodeURIComponent(t)}=`;throw new va(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",(()=>r.abort()));const s=setTimeout((()=>r.abort()),n);return this.getRequestClient().fetch.call(void 0,e,{signal:r.signal,...i}).finally((()=>{clearTimeout(s)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n){let r;const a=n?.["retry-after-ms"];if(a){const e=parseFloat(a);Number.isNaN(e)||(r=e)}const i=n?.["retry-after"];if(i&&!r){const e=parseFloat(i);r=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){const n=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}return await oa(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${cr}`}}class Kr{constructor(e,t,n,r){Fr.set(this,void 0),Br(this,Fr,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new va("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"===typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await Hr(this,Fr,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Fr=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class Yr extends qr{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await Zr(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const Gr=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),Jr={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Xr=e=>"object"===typeof e&&null!==e&&!da(e)&&Object.keys(e).every((e=>ha(Jr,e))),Qr=()=>{if("undefined"!==typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cr,"X-Stainless-OS":ta(Deno.build.os),"X-Stainless-Arch":ea(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"===typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cr,"X-Stainless-OS":ta(process.platform),"X-Stainless-Arch":ea(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=function(){if("undefined"===typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":cr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const ea=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",ta=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let na;const ra=()=>na??(na=Qr()),aa=e=>{try{return JSON.parse(e)}catch(t){return}},ia=new RegExp("^(?:[a-z]+:)?//","i"),sa=e=>ia.test(e),oa=e=>new Promise((t=>setTimeout(t,e))),la=(e,t)=>{if("number"!==typeof t||!Number.isInteger(t))throw new va(`${e} must be an integer`);if(t<0)throw new va(`${e} must be a positive integer`);return t},ca=e=>{if(e instanceof Error)return e;if("object"===typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},ua=e=>"undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}?.[e]?.trim()??void 0:"undefined"!==typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function da(e){if(!e)return!0;for(const t in e)return!1;return!0}function ha(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function pa(e,t){for(const n in t){if(!ha(t,n))continue;const r=n.toLowerCase();if(!r)continue;const a=t[n];null===a?delete e[r]:void 0!==a&&(e[r]=a)}}function fa(e){if("undefined"!==typeof process&&"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}?.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console.log(`OpenAI:DEBUG:${e}`,...n)}}const ma=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),ga=(e,t)=>{const n=t.toLowerCase();if((e=>"function"===typeof e?.get)(e)){const r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const a of[t,n,t.toUpperCase(),r]){const t=e.get(a);if(t)return t}}for(const[r,a]of Object.entries(e))if(r.toLowerCase()===n)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${t} header, using the first entry.`),a[0]):a};function ya(e){return null!=e&&"object"===typeof e&&!Array.isArray(e)}class va extends Error{}class ba extends va{constructor(e,t,n,r){super(`${ba.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"];const a=t;this.error=a,this.code=a?.code,this.param=a?.param,this.type=a?.type}static makeMessage(e,t,n){const r=t?.message?"string"===typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e)return new _a({message:n,cause:ca(t)});const a=t?.error;return 400===e?new Ea(e,a,n,r):401===e?new ka(e,a,n,r):403===e?new Sa(e,a,n,r):404===e?new Oa(e,a,n,r):409===e?new Pa(e,a,n,r):422===e?new Ta(e,a,n,r):429===e?new Na(e,a,n,r):e>=500?new ja(e,a,n,r):new ba(e,a,n,r)}}class wa extends ba{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class _a extends ba{constructor(e){let{message:t,cause:n}=e;super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class xa extends _a{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e??"Request timed out."})}}class Ea extends ba{constructor(){super(...arguments),this.status=400}}class ka extends ba{constructor(){super(...arguments),this.status=401}}class Sa extends ba{constructor(){super(...arguments),this.status=403}}class Oa extends ba{constructor(){super(...arguments),this.status=404}}class Pa extends ba{constructor(){super(...arguments),this.status=409}}class Ta extends ba{constructor(){super(...arguments),this.status=422}}class Na extends ba{constructor(){super(...arguments),this.status=429}}class ja extends ba{}class Ia extends va{constructor(){super("Could not parse response content as the length limit was reached")}}class Aa extends va{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}const Ca="RFC3986",Ra={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},$a=(Object.prototype.hasOwnProperty,Array.isArray),La=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();const Ma=1024;function Da(e,t){if($a(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const Ua=Object.prototype.hasOwnProperty,za={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},Fa=Array.isArray,Ba=Array.prototype.push,Ha=function(e,t){Ba.apply(e,Fa(t)?t:[t])},Za=Date.prototype.toISOString,Va={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,n,r,a)=>{if(0===e.length)return e;let i=e;if("symbol"===typeof e?i=Symbol.prototype.toString.call(e):"string"!==typeof e&&(i=String(e)),"iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));let s="";for(let o=0;o<i.length;o+=Ma){const e=i.length>=Ma?i.slice(o,o+Ma):i,t=[];for(let n=0;n<e.length;++n){let r=e.charCodeAt(n);45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===a&&(40===r||41===r)?t[t.length]=e.charAt(n):r<128?t[t.length]=La[r]:r<2048?t[t.length]=La[192|r>>6]+La[128|63&r]:r<55296||r>=57344?t[t.length]=La[224|r>>12]+La[128|r>>6&63]+La[128|63&r]:(n+=1,r=65536+((1023&r)<<10|1023&e.charCodeAt(n)),t[t.length]=La[240|r>>18]+La[128|r>>12&63]+La[128|r>>6&63]+La[128|63&r])}s+=t.join("")}return s},encodeValuesOnly:!1,format:Ca,formatter:Ra[Ca],indices:!1,serializeDate:e=>Za.call(e),skipNulls:!1,strictNullHandling:!1};const qa={};function Wa(e,t,n,r,a,i,s,o,l,c,u,d,h,p,f,m,g,y){let v=e,b=y,w=0,_=!1;for(;void 0!==(b=b.get(qa))&&!_;){const t=b.get(e);if(w+=1,"undefined"!==typeof t){if(t===w)throw new RangeError("Cyclic object value");_=!0}"undefined"===typeof b.get(qa)&&(w=0)}if("function"===typeof c?v=c(t,v):v instanceof Date?v=h?.(v):"comma"===n&&Fa(v)&&(v=Da(v,(function(e){return e instanceof Date?h?.(e):e}))),null===v){if(i)return l&&!m?l(t,Va.encoder,g,"key",p):t;v=""}if("string"===typeof(x=v)||"number"===typeof x||"boolean"===typeof x||"symbol"===typeof x||"bigint"===typeof x||function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}(v)){if(l){const e=m?t:l(t,Va.encoder,g,"key",p);return[f?.(e)+"="+f?.(l(v,Va.encoder,g,"value",p))]}return[f?.(t)+"="+f?.(String(v))]}var x;const E=[];if("undefined"===typeof v)return E;let k;if("comma"===n&&Fa(v))m&&l&&(v=Da(v,l)),k=[{value:v.length>0?v.join(",")||null:void 0}];else if(Fa(c))k=c;else{const e=Object.keys(v);k=u?e.sort(u):e}const S=o?String(t).replace(/\./g,"%2E"):String(t),O=r&&Fa(v)&&1===v.length?S+"[]":S;if(a&&Fa(v)&&0===v.length)return O+"[]";for(let P=0;P<k.length;++P){const t=k[P],b="object"===typeof t&&"undefined"!==typeof t.value?t.value:v[t];if(s&&null===b)continue;const _=d&&o?t.replace(/\./g,"%2E"):t,x=Fa(v)?"function"===typeof n?n(O,_):O:O+(d?"."+_:"["+_+"]");y.set(e,w);const S=new WeakMap;S.set(qa,y),Ha(E,Wa(b,x,n,r,a,i,s,o,"comma"===n&&m&&Fa(v)?null:l,c,u,d,h,p,f,m,g,S))}return E}function Ka(e){let t=e;const n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Va;if("undefined"!==typeof e.allowEmptyArrays&&"boolean"!==typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if("undefined"!==typeof e.encodeDotInKeys&&"boolean"!==typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&"undefined"!==typeof e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");const t=e.charset||Va.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=Ca;if("undefined"!==typeof e.format){if(!Ua.call(Ra,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=Ra[n];let a,i=Va.filter;if(("function"===typeof e.filter||Fa(e.filter))&&(i=e.filter),a=e.arrayFormat&&e.arrayFormat in za?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":Va.arrayFormat,"commaRoundTrip"in e&&"boolean"!==typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const s="undefined"===typeof e.allowDots?!0===!!e.encodeDotInKeys||Va.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:Va.addQueryPrefix,allowDots:s,allowEmptyArrays:"boolean"===typeof e.allowEmptyArrays?!!e.allowEmptyArrays:Va.allowEmptyArrays,arrayFormat:a,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:Va.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:"undefined"===typeof e.delimiter?Va.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:Va.encode,encodeDotInKeys:"boolean"===typeof e.encodeDotInKeys?e.encodeDotInKeys:Va.encodeDotInKeys,encoder:"function"===typeof e.encoder?e.encoder:Va.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:Va.encodeValuesOnly,filter:i,format:n,formatter:r,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:Va.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:Va.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:Va.strictNullHandling}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});let r,a;"function"===typeof n.filter?(a=n.filter,t=a("",t)):Fa(n.filter)&&(a=n.filter,r=a);const i=[];if("object"!==typeof t||null===t)return"";const s=za[n.arrayFormat],o="comma"===s&&n.commaRoundTrip;r||(r=Object.keys(t)),n.sort&&r.sort(n.sort);const l=new WeakMap;for(let d=0;d<r.length;++d){const e=r[d];n.skipNulls&&null===t[e]||Ha(i,Wa(t[e],e,s,o,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}const c=i.join(n.delimiter);let u=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),c.length>0?u+c:""}class Ya extends Kr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ga extends Kr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class Ja{constructor(e){this._client=e}}class Xa extends Ja{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}Xa||(Xa={});class Qa extends Ja{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}}Qa||(Qa={});class ei extends Ja{constructor(){super(...arguments),this.completions=new Qa(this._client)}}!function(e){e.Completions=Qa}(ei||(ei={}));class ti extends Ja{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}ti||(ti={});class ni extends Ja{create(e,t){return this._client.post("/files",Dr({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Xr(e)?this.list({},e):this._client.getAPIList("/files",ri,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e){let{pollInterval:t=5e3,maxWait:n=18e5}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await oa(t),i=await this.retrieve(e),Date.now()-a>n)throw new xa({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}}class ri extends Ya{}!function(e){e.FileObjectsPage=ri}(ni||(ni={}));class ai extends Ja{createVariation(e,t){return this._client.post("/images/variations",Dr({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Dr({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}ai||(ai={});class ii extends Ja{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}}ii||(ii={});class si extends Ja{create(e,t){return this._client.post("/audio/transcriptions",Dr({body:e,...t}))}}si||(si={});class oi extends Ja{create(e,t){return this._client.post("/audio/translations",Dr({body:e,...t}))}}oi||(oi={});class li extends Ja{constructor(){super(...arguments),this.transcriptions=new si(this._client),this.translations=new oi(this._client),this.speech=new ii(this._client)}}!function(e){e.Transcriptions=si,e.Translations=oi,e.Speech=ii}(li||(li={}));class ci extends Ja{create(e,t){return this._client.post("/moderations",{body:e,...t})}}ci||(ci={});class ui extends Ja{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",di,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class di extends Ya{}!function(e){e.ModelsPage=di}(ui||(ui={}));class hi extends Ja{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Xr(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,pi,{query:t,...n})}}class pi extends Ga{}!function(e){e.FineTuningJobCheckpointsPage=pi}(hi||(hi={}));class fi extends Ja{constructor(){super(...arguments),this.checkpoints=new hi(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Xr(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",mi,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Xr(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,gi,{query:t,...n})}}class mi extends Ga{}class gi extends Ga{}!function(e){e.FineTuningJobsPage=mi,e.FineTuningJobEventsPage=gi,e.Checkpoints=hi,e.FineTuningJobCheckpointsPage=pi}(fi||(fi={}));class yi extends Ja{constructor(){super(...arguments),this.jobs=new fi(this._client)}}!function(e){e.Jobs=fi,e.FineTuningJobsPage=mi,e.FineTuningJobEventsPage=gi}(yi||(yi={}));class vi extends Ja{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Xr(e)?this.list({},e):this._client.getAPIList("/assistants",bi,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class bi extends Ga{}function wi(e){return"function"===typeof e.parse}!function(e){e.AssistantsPage=bi}(vi||(vi={}));const _i=e=>"assistant"===e?.role,xi=e=>"function"===e?.role,Ei=e=>"tool"===e?.role;var ki,Si,Oi,Pi,Ti,Ni,ji,Ii,Ai,Ci,Ri,$i,Li,Mi=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},Di=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Ui{constructor(){ki.add(this),this.controller=new AbortController,Si.set(this,void 0),Oi.set(this,(()=>{})),Pi.set(this,(()=>{})),Ti.set(this,void 0),Ni.set(this,(()=>{})),ji.set(this,(()=>{})),Ii.set(this,{}),Ai.set(this,!1),Ci.set(this,!1),Ri.set(this,!1),$i.set(this,!1),Mi(this,Si,new Promise(((e,t)=>{Mi(this,Oi,e,"f"),Mi(this,Pi,t,"f")})),"f"),Mi(this,Ti,new Promise(((e,t)=>{Mi(this,Ni,e,"f"),Mi(this,ji,t,"f")})),"f"),Di(this,Si,"f").catch((()=>{})),Di(this,Ti,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),Di(this,ki,"m",Li).bind(this))}),0)}_connected(){this.ended||(Di(this,Oi,"f").call(this),this._emit("connect"))}get ended(){return Di(this,Ai,"f")}get errored(){return Di(this,Ci,"f")}get aborted(){return Di(this,Ri,"f")}abort(){this.controller.abort()}on(e,t){return(Di(this,Ii,"f")[e]||(Di(this,Ii,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=Di(this,Ii,"f")[e];if(!n)return this;const r=n.findIndex((e=>e.listener===t));return r>=0&&n.splice(r,1),this}once(e,t){return(Di(this,Ii,"f")[e]||(Di(this,Ii,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{Mi(this,$i,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){Mi(this,$i,!0,"f"),await Di(this,Ti,"f")}_emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(Di(this,Ai,"f"))return;"end"===e&&(Mi(this,Ai,!0,"f"),Di(this,Ni,"f").call(this));const a=Di(this,Ii,"f")[e];if(a&&(Di(this,Ii,"f")[e]=a.filter((e=>!e.once)),a.forEach((e=>{let{listener:t}=e;return t(...n)}))),"abort"===e){const e=n[0];return Di(this,$i,"f")||a?.length||Promise.reject(e),Di(this,Pi,"f").call(this,e),Di(this,ji,"f").call(this,e),void this._emit("end")}if("error"===e){const e=n[0];Di(this,$i,"f")||a?.length||Promise.reject(e),Di(this,Pi,"f").call(this,e),Di(this,ji,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function zi(e){return"auto-parseable-response-format"===e?.$brand}function Fi(e){return"auto-parseable-tool"===e?.$brand}function Bi(e,t){const n=e.choices.map((e=>{if("length"===e.finish_reason)throw new Ia;if("content_filter"===e.finish_reason)throw new Aa;return{...e,message:{...e.message,tool_calls:e.message.tool_calls?.map((e=>function(e,t){const n=e.tools?.find((e=>e.function?.name===t.function.name));return{...t,function:{...t.function,parsed_arguments:Fi(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}}(t,e)))??[],parsed:e.message.content&&!e.message.refusal?Hi(t,e.message.content):null}}}));return{...e,choices:n}}function Hi(e,t){if("json_schema"!==e.response_format?.type)return null;if("json_schema"===e.response_format?.type){if("$parseRaw"in e.response_format){return e.response_format.$parseRaw(t)}return JSON.parse(t)}return null}function Zi(e,t){if(!e)return!1;const n=e.tools?.find((e=>e.function?.name===t.function.name));return Fi(n)||n?.function.strict||!1}function Vi(e){return!!zi(e.response_format)||(e.tools?.some((e=>Fi(e)||"function"===e.type&&!0===e.function.strict))??!1)}Si=new WeakMap,Oi=new WeakMap,Pi=new WeakMap,Ti=new WeakMap,Ni=new WeakMap,ji=new WeakMap,Ii=new WeakMap,Ai=new WeakMap,Ci=new WeakMap,Ri=new WeakMap,$i=new WeakMap,ki=new WeakSet,Li=function(e){if(Mi(this,Ci,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new wa),e instanceof wa)return Mi(this,Ri,!0,"f"),this._emit("abort",e);if(e instanceof va)return this._emit("error",e);if(e instanceof Error){const t=new va(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new va(String(e)))};var qi,Wi,Ki,Yi,Gi,Ji,Xi,Qi,es=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const ts=10;class ns extends Ui{constructor(){super(...arguments),qi.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(xi(e)||Ei(e))&&e.content)this._emit("functionCallResult",e.content);else if(_i(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(_i(e)&&e.tool_calls)for(const n of e.tool_calls)"function"===n.type&&this._emit("functionCall",n.function)}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new va("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),es(this,qi,"m",Wi).call(this)}async finalMessage(){return await this.done(),es(this,qi,"m",Ki).call(this)}async finalFunctionCall(){return await this.done(),es(this,qi,"m",Yi).call(this)}async finalFunctionCallResult(){return await this.done(),es(this,qi,"m",Gi).call(this)}async totalUsage(){return await this.done(),es(this,qi,"m",Ji).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=es(this,qi,"m",Ki).call(this);t&&this._emit("finalMessage",t);const n=es(this,qi,"m",Wi).call(this);n&&this._emit("finalContent",n);const r=es(this,qi,"m",Yi).call(this);r&&this._emit("finalFunctionCall",r);const a=es(this,qi,"m",Gi).call(this);null!=a&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",es(this,qi,"m",Ji).call(this))}async _createChatCompletion(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),es(this,qi,"m",Xi).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Bi(a,t))}async _runChatCompletion(e,t,n){for(const r of t.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const r="function",{function_call:a="auto",stream:i,...s}=t,o="string"!==typeof a&&a?.name,{maxChatCompletions:l=ts}=n||{},c={};for(const h of t.functions)c[h.name||h.function.name]=h;const u=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const h of t.messages)this._addMessage(h,!1);for(let h=0;h<l;++h){const t=await this._createChatCompletion(e,{...s,function_call:a,functions:u,messages:[...this.messages]},n),i=t.choices[0]?.message;if(!i)throw new va("missing message in ChatCompletion response");if(!i.function_call)return;const{name:l,arguments:h}=i.function_call,p=c[l];if(!p){const e=`Invalid function_call: ${JSON.stringify(l)}. Available options are: ${u.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:l,content:e});continue}if(o&&o!==l){const e=`Invalid function_call: ${JSON.stringify(l)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:r,name:l,content:e});continue}let f;try{f=wi(p)?await p.parse(h):h}catch(d){this._addMessage({role:r,name:l,content:d instanceof Error?d.message:String(d)});continue}const m=await p.function(f,this),g=es(this,qi,"m",Qi).call(this,m);if(this._addMessage({role:r,name:l,content:g}),o)return}}async _runTools(e,t,n){const r="tool",{tool_choice:a="auto",stream:i,...s}=t,o="string"!==typeof a&&a?.function?.name,{maxChatCompletions:l=ts}=n||{},c=t.tools.map((e=>{if(Fi(e)){if(!e.$callback)throw new va("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),u={};for(const p of c)"function"===p.type&&(u[p.function.name||p.function.function.name]=p.function);const d="tools"in t?c.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e)):void 0;for(const p of t.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const t=await this._createChatCompletion(e,{...s,tool_choice:a,tools:d,messages:[...this.messages]},n),i=t.choices[0]?.message;if(!i)throw new va("missing message in ChatCompletion response");if(!i.tool_calls?.length)return;for(const e of i.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:n,arguments:a}=e.function,i=u[n];if(!i){const e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(u).map((e=>JSON.stringify(e))).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}if(o&&o!==n){const e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}let s;try{s=wi(i)?await i.parse(a):a}catch(h){const e=h instanceof Error?h.message:String(h);this._addMessage({role:r,tool_call_id:t,content:e});continue}const l=await i.function(s,this),c=es(this,qi,"m",Qi).call(this,l);if(this._addMessage({role:r,tool_call_id:t,content:c}),o)return}}}}qi=new WeakSet,Wi=function(){return es(this,qi,"m",Ki).call(this).content??null},Ki=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(_i(t)){const{function_call:e,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return e&&(r.function_call=e),r}}throw new va("stream ended without producing a ChatCompletionMessage with role=assistant")},Yi=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(_i(t)&&t?.function_call)return t.function_call;if(_i(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},Gi=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(xi(t)&&null!=t.content)return t.content;if(Ei(t)&&null!=t.content&&"string"===typeof t.content&&this.messages.some((e=>"assistant"===e.role&&e.tool_calls?.some((e=>"function"===e.type&&e.id===t.tool_call_id)))))return t.content}},Ji=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Xi=function(e){if(null!=e.n&&e.n>1)throw new va("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Qi=function(e){return"string"===typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class rs extends ns{static runFunctions(e,t,n){const r=new rs,a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,a))),r}static runTools(e,t,n){const r=new rs,a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,a))),r}_addMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super._addMessage(e,t),_i(e)&&e.content&&this._emit("content",e.content)}}const as={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511};class is extends Error{}class ss extends Error{}const os=(e,t)=>{const n=e.length;let r=0;const a=e=>{throw new is(`${e} at position ${r}`)},i=e=>{throw new ss(`${e} at position ${r}`)},s=()=>(d(),r>=n&&a("Unexpected end of input"),'"'===e[r]?o():"{"===e[r]?l():"["===e[r]?c():"null"===e.substring(r,r+4)||as.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||as.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||as.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||as.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||as.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||as.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),o=()=>{const s=r;let o=!1;for(r++;r<n&&('"'!==e[r]||o&&"\\"===e[r-1]);)o="\\"===e[r]&&!o,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(s,++r-Number(o)))}catch($u){i(String($u))}else if(as.STR&t)try{return JSON.parse(e.substring(s,r-Number(o))+'"')}catch($u){return JSON.parse(e.substring(s,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},l=()=>{r++,d();const i={};try{for(;"}"!==e[r];){if(d(),r>=n&&as.OBJ&t)return i;const a=o();d(),r++;try{const e=s();Object.defineProperty(i,a,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch($u){if(as.OBJ&t)return i;throw $u}d(),","===e[r]&&r++}}catch($u){if(as.OBJ&t)return i;a("Expected '}' at end of object")}return r++,i},c=()=>{r++;const n=[];try{for(;"]"!==e[r];)n.push(s()),d(),","===e[r]&&r++}catch($u){if(as.ARR&t)return n;a("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===e&&as.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch($u){if(as.NUM&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch($u){}i(String($u))}}const s=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=n||as.NUM&t||a("Unterminated number literal");try{return JSON.parse(e.substring(s,r))}catch($u){"-"===e.substring(s,r)&&as.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(s,e.lastIndexOf("e")))}catch($u){i(String($u))}}},d=()=>{for(;r<n&&" \n\r\t".includes(e[r]);)r++};return s()},ls=e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:as.ALL;if("string"!==typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return os(e.trim(),t)}(e,as.ALL^as.NUM);var cs,us,ds,hs,ps,fs,ms,gs,ys,vs,bs,ws,_s=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},xs=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Es extends ns{constructor(e){super(),cs.add(this),us.set(this,void 0),ds.set(this,void 0),hs.set(this,void 0),_s(this,us,e,"f"),_s(this,ds,[],"f")}get currentChatCompletionSnapshot(){return xs(this,hs,"f")}static fromReadableStream(e){const t=new Es(null);return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,n){const r=new Es(t);return r._run((()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(e,t,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),xs(this,cs,"m",ps).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const i of a)xs(this,cs,"m",ms).call(this,i);if(a.controller.signal?.aborted)throw new wa;return this._addChatCompletion(xs(this,cs,"m",vs).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),xs(this,cs,"m",ps).call(this),this._connected();const r=Or.fromReadableStream(e,this.controller);let a;for await(const i of r)a&&a!==i.id&&this._addChatCompletion(xs(this,cs,"m",vs).call(this)),xs(this,cs,"m",ms).call(this,i),a=i.id;if(r.controller.signal?.aborted)throw new wa;return this._addChatCompletion(xs(this,cs,"m",vs).call(this))}[(us=new WeakMap,ds=new WeakMap,hs=new WeakMap,cs=new WeakSet,ps=function(){this.ended||_s(this,hs,void 0,"f")},fs=function(e){let t=xs(this,ds,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},xs(this,ds,"f")[e.index]=t,t)},ms=function(e){if(this.ended)return;const t=xs(this,cs,"m",ws).call(this,e);this._emit("chunk",e,t);for(const n of e.choices){const e=t.choices[n.index];null!=n.delta.content&&"assistant"===e.message?.role&&e.message?.content&&(this._emit("content",n.delta.content,e.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=n.delta.refusal&&"assistant"===e.message?.role&&e.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:e.message.refusal}),null!=n.logprobs?.content&&"assistant"===e.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:e.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===e.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});const r=xs(this,cs,"m",fs).call(this,e);e.finish_reason&&(xs(this,cs,"m",ys).call(this,e),null!=r.current_tool_call_index&&xs(this,cs,"m",gs).call(this,e,r.current_tool_call_index));for(const t of n.delta.tool_calls??[])r.current_tool_call_index!==t.index&&(xs(this,cs,"m",ys).call(this,e),null!=r.current_tool_call_index&&xs(this,cs,"m",gs).call(this,e,r.current_tool_call_index)),r.current_tool_call_index=t.index;for(const t of n.delta.tool_calls??[]){const n=e.message.tool_calls?.[t.index];n?.type&&("function"===n?.type&&this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:t.function?.arguments??""}))}}},gs=function(e,t){if(xs(this,cs,"m",fs).call(this,e).done_tool_calls.has(t))return;const n=e.message.tool_calls?.[t];if(!n)throw new Error("no tool call snapshot");if(!n.type)throw new Error("tool call snapshot missing `type`");if("function"===n.type){const e=xs(this,us,"f")?.tools?.find((e=>"function"===e.type&&e.function.name===n.function.name));this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:t,arguments:n.function.arguments,parsed_arguments:Fi(e)?e.$parseRaw(n.function.arguments):e?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},ys=function(e){const t=xs(this,cs,"m",fs).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;const n=xs(this,cs,"m",bs).call(this);this._emit("content.done",{content:e.message.content,parsed:n?n.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},vs=function(){if(this.ended)throw new va("stream has ended, this shouldn't happen");const e=xs(this,hs,"f");if(!e)throw new va("request ended without sending any chunks");return _s(this,hs,void 0,"f"),_s(this,ds,[],"f"),function(e,t){const{id:n,choices:r,created:a,model:i,system_fingerprint:s,...o}=e,l={...o,id:n,choices:r.map((t=>{let{message:n,finish_reason:r,index:a,logprobs:i,...s}=t;if(!r)throw new va(`missing finish_reason for choice ${a}`);const{content:o=null,function_call:l,tool_calls:c,...u}=n,d=n.role;if(!d)throw new va(`missing role for choice ${a}`);if(l){const{arguments:e,name:t}=l;if(null==e)throw new va(`missing function_call.arguments for choice ${a}`);if(!t)throw new va(`missing function_call.name for choice ${a}`);return{...s,message:{content:o,function_call:{arguments:e,name:t},role:d,refusal:n.refusal??null},finish_reason:r,index:a,logprobs:i}}return c?{...s,index:a,finish_reason:r,logprobs:i,message:{...u,role:d,content:o,refusal:n.refusal??null,tool_calls:c.map(((t,n)=>{const{function:r,type:i,id:s,...o}=t,{arguments:l,name:c,...u}=r||{};if(null==s)throw new va(`missing choices[${a}].tool_calls[${n}].id\n${ks(e)}`);if(null==i)throw new va(`missing choices[${a}].tool_calls[${n}].type\n${ks(e)}`);if(null==c)throw new va(`missing choices[${a}].tool_calls[${n}].function.name\n${ks(e)}`);if(null==l)throw new va(`missing choices[${a}].tool_calls[${n}].function.arguments\n${ks(e)}`);return{...o,id:s,type:i,function:{...u,name:c,arguments:l}}}))}}:{...s,message:{...u,content:o,role:d,refusal:n.refusal??null},finish_reason:r,index:a,logprobs:i}})),created:a,model:i,object:"chat.completion",...s?{system_fingerprint:s}:{}};return function(e,t){return t&&Vi(t)?Bi(e,t):{...e,choices:e.choices.map((e=>({...e,message:{...e.message,parsed:null,tool_calls:e.message.tool_calls??[]}})))}}(l,t)}(e,xs(this,us,"f"))},bs=function(){const e=xs(this,us,"f")?.response_format;return zi(e)?e:null},ws=function(e){var t,n,r,a;let i=xs(this,hs,"f");const{choices:s,...o}=e;i?Object.assign(i,o):i=_s(this,hs,{...o,choices:[]},"f");for(const{delta:l,finish_reason:c,index:u,logprobs:d=null,...h}of e.choices){let e=i.choices[u];if(e||(e=i.choices[u]={finish_reason:c,index:u,message:{},logprobs:d,...h}),d)if(e.logprobs){const{content:r,refusal:a,...i}=d;Object.assign(e.logprobs,i),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),a&&((n=e.logprobs).refusal??(n.refusal=[]),e.logprobs.refusal.push(...a))}else e.logprobs=Object.assign({},d);if(c&&(e.finish_reason=c,xs(this,us,"f")&&Vi(xs(this,us,"f")))){if("length"===c)throw new Ia;if("content_filter"===c)throw new Aa}if(Object.assign(e,h),!l)continue;const{content:s,refusal:o,function_call:p,role:f,tool_calls:m,...g}=l;if(Object.assign(e.message,g),o&&(e.message.refusal=(e.message.refusal||"")+o),f&&(e.message.role=f),p&&(e.message.function_call?(p.name&&(e.message.function_call.name=p.name),p.arguments&&((r=e.message.function_call).arguments??(r.arguments=""),e.message.function_call.arguments+=p.arguments)):e.message.function_call=p),s&&(e.message.content=(e.message.content||"")+s,!e.message.refusal&&xs(this,cs,"m",bs).call(this)&&(e.message.parsed=ls(e.message.content))),m){e.message.tool_calls||(e.message.tool_calls=[]);for(const{index:t,id:n,type:r,function:i,...s}of m){const o=(a=e.message.tool_calls)[t]??(a[t]={});Object.assign(o,s),n&&(o.id=n),r&&(o.type=r),i&&(o.function??(o.function={name:i.name??"",arguments:""})),i?.name&&(o.function.name=i.name),i?.arguments&&(o.function.arguments+=i.arguments,Zi(xs(this,us,"f"),o)&&(o.function.parsed_arguments=ls(o.function.arguments)))}}}return i},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Or(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function ks(e){return JSON.stringify(e)}class Ss extends Es{static fromReadableStream(e){const t=new Ss(null);return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,n){const r=new Ss(null),a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,a))),r}static runTools(e,t,n){const r=new Ss(t),a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,a))),r}}class Os extends Ja{parse(e,t){return function(e){for(const t of e??[]){if("function"!==t.type)throw new va(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new va(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((t=>Bi(t,e)))}runFunctions(e,t){return e.stream?Ss.runFunctions(this._client,e,t):rs.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Ss.runTools(this._client,e,t):rs.runTools(this._client,e,t)}stream(e,t){return Es.createChatCompletion(this._client,e,t)}}class Ps extends Ja{constructor(){super(...arguments),this.completions=new Os(this._client)}}!function(e){e.Completions=Os}(Ps||(Ps={}));var Ts,Ns,js,Is,As,Cs,Rs,$s,Ls,Ms,Ds,Us,zs,Fs,Bs,Hs,Zs,Vs,qs,Ws,Ks,Ys,Gs=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Js=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n};class Xs extends Ui{constructor(){super(...arguments),Ts.add(this),Ns.set(this,[]),js.set(this,{}),Is.set(this,{}),As.set(this,void 0),Cs.set(this,void 0),Rs.set(this,void 0),$s.set(this,void 0),Ls.set(this,void 0),Ms.set(this,void 0),Ds.set(this,void 0),Us.set(this,void 0),zs.set(this,void 0)}[(Ns=new WeakMap,js=new WeakMap,Is=new WeakMap,As=new WeakMap,Cs=new WeakMap,Rs=new WeakMap,$s=new WeakMap,Ls=new WeakMap,Ms=new WeakMap,Ds=new WeakMap,Us=new WeakMap,zs=new WeakMap,Ts=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Xs;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=Or.fromReadableStream(e,this.controller);for await(const a of r)Gs(this,Ts,"m",Fs).call(this,a);if(r.controller.signal?.aborted)throw new wa;return this._addRun(Gs(this,Ts,"m",Bs).call(this))}toReadableStream(){return new Or(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,a){const i=new Xs;return i._run((()=>i._runToolAssistantStream(e,t,n,r,{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}}))),i}async _createToolAssistantStream(e,t,n,r,a){const i=a?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const s={...r,stream:!0},o=await e.submitToolOutputs(t,n,s,{...a,signal:this.controller.signal});this._connected();for await(const l of o)Gs(this,Ts,"m",Fs).call(this,l);if(o.controller.signal?.aborted)throw new wa;return this._addRun(Gs(this,Ts,"m",Bs).call(this))}static createThreadAssistantStream(e,t,n){const r=new Xs;return r._run((()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(e,t,n,r){const a=new Xs;return a._run((()=>a._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),a}currentEvent(){return Gs(this,Ds,"f")}currentRun(){return Gs(this,Us,"f")}currentMessageSnapshot(){return Gs(this,As,"f")}currentRunStepSnapshot(){return Gs(this,zs,"f")}async finalRunSteps(){return await this.done(),Object.values(Gs(this,js,"f"))}async finalMessages(){return await this.done(),Object.values(Gs(this,Is,"f"))}async finalRun(){if(await this.done(),!Gs(this,Cs,"f"))throw Error("Final run was not received.");return Gs(this,Cs,"f")}async _createThreadAssistantStream(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort())));const a={...t,stream:!0},i=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const s of i)Gs(this,Ts,"m",Fs).call(this,s);if(i.controller.signal?.aborted)throw new wa;return this._addRun(Gs(this,Ts,"m",Bs).call(this))}async _createAssistantStream(e,t,n,r){const a=r?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(()=>this.controller.abort())));const i={...n,stream:!0},s=await e.create(t,i,{...r,signal:this.controller.signal});this._connected();for await(const o of s)Gs(this,Ts,"m",Fs).call(this,o);if(s.controller.signal?.aborted)throw new wa;return this._addRun(Gs(this,Ts,"m",Bs).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null!==t&&void 0!==t)if("index"!==n&&"type"!==n){if("string"===typeof t&&"string"===typeof r)t+=r;else if("number"===typeof t&&"number"===typeof r)t+=r;else{if(!ya(t)||!ya(r)){if(Array.isArray(t)&&Array.isArray(r)){if(t.every((e=>"string"===typeof e||"number"===typeof e))){t.push(...r);continue}for(const e of r){if(!ya(e))throw new Error(`Expected array delta entry to be an object but got: ${e}`);const n=e.index;if(null==n)throw console.error(e),new Error("Expected array delta entry to have an `index` property");if("number"!==typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${t}`)}t=this.accumulateDelta(t,r)}e[n]=t}else e[n]=r;else e[n]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,a){return await this._createToolAssistantStream(n,e,t,r,a)}}Fs=function(e){if(!this.ended)switch(Js(this,Ds,e,"f"),Gs(this,Ts,"m",Vs).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Gs(this,Ts,"m",Ys).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Gs(this,Ts,"m",Zs).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Gs(this,Ts,"m",Hs).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Bs=function(){if(this.ended)throw new va("stream has ended, this shouldn't happen");if(!Gs(this,Cs,"f"))throw Error("Final run has not been received");return Gs(this,Cs,"f")},Hs=function(e){const[t,n]=Gs(this,Ts,"m",Ws).call(this,e,Gs(this,As,"f"));Js(this,As,t,"f"),Gs(this,Is,"f")[t.id]=t;for(const r of n){const e=t.content[r.index];"text"==e?.type&&this._emit("textCreated",e.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,r.text)}if(n.index!=Gs(this,Rs,"f")){if(Gs(this,$s,"f"))switch(Gs(this,$s,"f").type){case"text":this._emit("textDone",Gs(this,$s,"f").text,Gs(this,As,"f"));break;case"image_file":this._emit("imageFileDone",Gs(this,$s,"f").image_file,Gs(this,As,"f"))}Js(this,Rs,n.index,"f")}Js(this,$s,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==Gs(this,Rs,"f")){const t=e.data.content[Gs(this,Rs,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,Gs(this,As,"f"));break;case"text":this._emit("textDone",t.text,Gs(this,As,"f"))}}Gs(this,As,"f")&&this._emit("messageDone",e.data),Js(this,As,void 0,"f")}},Zs=function(e){const t=Gs(this,Ts,"m",qs).call(this,e);switch(Js(this,zs,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of n.step_details.tool_calls)e.index==Gs(this,Ls,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(Gs(this,Ms,"f")&&this._emit("toolCallDone",Gs(this,Ms,"f")),Js(this,Ls,e.index,"f"),Js(this,Ms,t.step_details.tool_calls[e.index],"f"),Gs(this,Ms,"f")&&this._emit("toolCallCreated",Gs(this,Ms,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Js(this,zs,void 0,"f");"tool_calls"==e.data.step_details.type&&Gs(this,Ms,"f")&&(this._emit("toolCallDone",Gs(this,Ms,"f")),Js(this,Ms,void 0,"f")),this._emit("runStepDone",e.data,t)}},Vs=function(e){Gs(this,Ns,"f").push(e),this._emit("event",e)},qs=function(e){switch(e.event){case"thread.run.step.created":return Gs(this,js,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Gs(this,js,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=Xs.accumulateDelta(t,n.delta);Gs(this,js,"f")[e.data.id]=r}return Gs(this,js,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Gs(this,js,"f")[e.data.id]=e.data}if(Gs(this,js,"f")[e.data.id])return Gs(this,js,"f")[e.data.id];throw new Error("No snapshot available")},Ws=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const e of r.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=Gs(this,Ts,"m",Ks).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ks=function(e,t){return Xs.accumulateDelta(t,e)},Ys=function(e){switch(Js(this,Us,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Js(this,Cs,e.data,"f"),Gs(this,Ms,"f")&&(this._emit("toolCallDone",Gs(this,Ms,"f")),Js(this,Ms,void 0,"f"))}};class Qs extends Ja{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Xr(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,eo,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class eo extends Ga{}!function(e){e.MessagesPage=eo}(Qs||(Qs={}));class to extends Ja{retrieve(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;return Xr(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a?.headers}})}list(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return Xr(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,no,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class no extends Ga{}!function(e){e.RunStepsPage=no}(to||(to={}));class ro extends Ja{constructor(){super(...arguments),this.steps=new to(this._client)}create(e,t,n){const{include:r,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Xr(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,ao,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return Xs.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=i.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await oa(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,n){return Xs.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const a=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,a.id,r)}submitToolOutputsStream(e,t,n,r){return Xs.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}class ao extends Ga{}!function(e){e.RunsPage=ao,e.Steps=to,e.RunStepsPage=no}(ro||(ro={}));class io extends Ja{constructor(){super(...arguments),this.runs=new ro(this._client),this.messages=new Qs(this._client)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Xr(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return Xs.createThreadAssistantStream(e,this._client.beta.threads,t)}}!function(e){e.Runs=ro,e.RunsPage=ao,e.Messages=Qs,e.MessagesPage=eo}(io||(io={}));class so extends Ja{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Xr(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,oo,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),i=a.data;switch(i.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=a.response.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await oa(e);break;case"failed":case"completed":return i}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}}class oo extends Ga{}!function(e){e.VectorStoreFilesPage=oo}(so||(so={}));class lo extends Ja{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return Xr(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,oo,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(a.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=i.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await oa(e);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,t,n){let{files:r,fileIds:a=[]}=t;if(null==r||0==r.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=n?.maxConcurrency??5,s=Math.min(i,r.length),o=this._client,l=r.values(),c=[...a];const u=Array(s).fill(l).map((async function(e){for(let t of e){const e=await o.files.create({file:t,purpose:"assistants"},n);c.push(e.id)}}));return await(async e=>{const t=await Promise.allSettled(e),n=t.filter((e=>"rejected"===e.status));if(n.length){for(const e of n)console.error(e.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of t)"fulfilled"===a.status&&r.push(a.value);return r})(u),await this.createAndPoll(e,{file_ids:c})}}lo||(lo={});class co extends Ja{constructor(){super(...arguments),this.files=new so(this._client),this.fileBatches=new lo(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Xr(e)?this.list({},e):this._client.getAPIList("/vector_stores",uo,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class uo extends Ga{}!function(e){e.VectorStoresPage=uo,e.Files=so,e.VectorStoreFilesPage=oo,e.FileBatches=lo}(co||(co={}));class ho extends Ja{constructor(){super(...arguments),this.vectorStores=new co(this._client),this.chat=new Ps(this._client),this.assistants=new vi(this._client),this.threads=new io(this._client)}}!function(e){e.VectorStores=co,e.VectorStoresPage=uo,e.Chat=Ps,e.Assistants=vi,e.AssistantsPage=bi,e.Threads=io}(ho||(ho={}));class po extends Ja{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Xr(e)?this.list({},e):this._client.getAPIList("/batches",fo,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class fo extends Ga{}!function(e){e.BatchesPage=fo}(po||(po={}));class mo extends Ja{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,Dr({body:t,...n}))}}mo||(mo={});class go extends Ja{constructor(){super(...arguments),this.parts=new mo(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}var yo;!function(e){e.Parts=mo}(go||(go={}));class vo extends Wr{constructor(){let{baseURL:e=ua("OPENAI_BASE_URL"),apiKey:t=ua("OPENAI_API_KEY"),organization:n=ua("OPENAI_ORG_ID")??null,project:r=ua("OPENAI_PROJECT_ID")??null,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0===t)throw new va("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof navigator)throw new va("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Xa(this),this.chat=new ei(this),this.embeddings=new ti(this),this.files=new ni(this),this.images=new ai(this),this.audio=new li(this),this.moderations=new ci(this),this.models=new ui(this),this.fineTuning=new yi(this),this.beta=new ho(this),this.batches=new po(this),this.uploads=new go(this),this._options=i,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Ka(e,{arrayFormat:"brackets"})}}yo=vo,vo.OpenAI=yo,vo.DEFAULT_TIMEOUT=6e5,vo.OpenAIError=va,vo.APIError=ba,vo.APIConnectionError=_a,vo.APIConnectionTimeoutError=xa,vo.APIUserAbortError=wa,vo.NotFoundError=Oa,vo.ConflictError=Pa,vo.RateLimitError=Na,vo.BadRequestError=Ea,vo.AuthenticationError=ka,vo.InternalServerError=ja,vo.PermissionDeniedError=Sa,vo.UnprocessableEntityError=Ta,vo.toFile=Rr,vo.fileFromPath=yr;const{vc:bo,LG:wo,xX:_o,qA:xo,cH:Eo,m_:ko,fK:So,OE:Oo,v7:Po,v3:To,PO:No,Ll:jo,Is:Io}=e;!function(e){e.Page=Ya,e.CursorPage=Ga,e.Completions=Xa,e.Chat=ei,e.Embeddings=ti,e.Files=ni,e.FileObjectsPage=ri,e.Images=ai,e.Audio=li,e.Moderations=ci,e.Models=ui,e.ModelsPage=di,e.FineTuning=yi,e.Beta=ho,e.Batches=po,e.BatchesPage=fo,e.Uploads=go}(vo||(vo={}));new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);var Ao=n(5255),Co=n(1713),Ro=n(4070),$o=n(6139),Lo="object"===typeof window?window:{},Mo="0123456789abcdef".split(""),Do=[-2147483648,8388608,32768,128],Uo=[24,16,8,0],zo=[];function Fo(e){e?(zo[0]=zo[16]=zo[1]=zo[2]=zo[3]=zo[4]=zo[5]=zo[6]=zo[7]=zo[8]=zo[9]=zo[10]=zo[11]=zo[12]=zo[13]=zo[14]=zo[15]=0,this.blocks=zo):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Fo.prototype.update=function(e){if(!this.finalized){var t="string"!==typeof e;t&&e.constructor===Lo.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r,a=0,i=e.length||0,s=this.blocks;a<i;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(r=this.start;a<i&&r<64;++a)s[r>>2]|=e[a]<<Uo[3&r++];else for(r=this.start;a<i&&r<64;++a)(n=e.charCodeAt(a))<128?s[r>>2]|=n<<Uo[3&r++]:n<2048?(s[r>>2]|=(192|n>>6)<<Uo[3&r++],s[r>>2]|=(128|63&n)<<Uo[3&r++]):n<55296||n>=57344?(s[r>>2]|=(224|n>>12)<<Uo[3&r++],s[r>>2]|=(128|n>>6&63)<<Uo[3&r++],s[r>>2]|=(128|63&n)<<Uo[3&r++]):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++a)),s[r>>2]|=(240|n>>18)<<Uo[3&r++],s[r>>2]|=(128|n>>12&63)<<Uo[3&r++],s[r>>2]|=(128|n>>6&63)<<Uo[3&r++],s[r>>2]|=(128|63&n)<<Uo[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.block=s[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},Fo.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=Do[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Fo.prototype.hash=function(){var e,t,n=this.h0,r=this.h1,a=this.h2,i=this.h3,s=this.h4,o=this.blocks;for(e=16;e<80;++e)t=o[e-3]^o[e-8]^o[e-14]^o[e-16],o[e]=t<<1|t>>>31;for(e=0;e<20;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(s=(t=n<<5|n>>>27)+(r&a|~r&i)+s+1518500249+o[e]|0)<<5|s>>>27)+(n&(r=r<<30|r>>>2)|~n&a)+i+1518500249+o[e+1]|0)<<5|i>>>27)+(s&(n=n<<30|n>>>2)|~s&r)+a+1518500249+o[e+2]|0)<<5|a>>>27)+(i&(s=s<<30|s>>>2)|~i&n)+r+1518500249+o[e+3]|0)<<5|r>>>27)+(a&(i=i<<30|i>>>2)|~a&s)+n+1518500249+o[e+4]|0,a=a<<30|a>>>2;for(;e<40;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(s=(t=n<<5|n>>>27)+(r^a^i)+s+1859775393+o[e]|0)<<5|s>>>27)+(n^(r=r<<30|r>>>2)^a)+i+1859775393+o[e+1]|0)<<5|i>>>27)+(s^(n=n<<30|n>>>2)^r)+a+1859775393+o[e+2]|0)<<5|a>>>27)+(i^(s=s<<30|s>>>2)^n)+r+1859775393+o[e+3]|0)<<5|r>>>27)+(a^(i=i<<30|i>>>2)^s)+n+1859775393+o[e+4]|0,a=a<<30|a>>>2;for(;e<60;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(s=(t=n<<5|n>>>27)+(r&a|r&i|a&i)+s-1894007588+o[e]|0)<<5|s>>>27)+(n&(r=r<<30|r>>>2)|n&a|r&a)+i-1894007588+o[e+1]|0)<<5|i>>>27)+(s&(n=n<<30|n>>>2)|s&r|n&r)+a-1894007588+o[e+2]|0)<<5|a>>>27)+(i&(s=s<<30|s>>>2)|i&n|s&n)+r-1894007588+o[e+3]|0)<<5|r>>>27)+(a&(i=i<<30|i>>>2)|a&s|i&s)+n-1894007588+o[e+4]|0,a=a<<30|a>>>2;for(;e<80;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(s=(t=n<<5|n>>>27)+(r^a^i)+s-899497514+o[e]|0)<<5|s>>>27)+(n^(r=r<<30|r>>>2)^a)+i-899497514+o[e+1]|0)<<5|i>>>27)+(s^(n=n<<30|n>>>2)^r)+a-899497514+o[e+2]|0)<<5|a>>>27)+(i^(s=s<<30|s>>>2)^n)+r-899497514+o[e+3]|0)<<5|r>>>27)+(a^(i=i<<30|i>>>2)^s)+n-899497514+o[e+4]|0,a=a<<30|a>>>2;this.h0=this.h0+n|0,this.h1=this.h1+r|0,this.h2=this.h2+a|0,this.h3=this.h3+i|0,this.h4=this.h4+s|0},Fo.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return Mo[e>>28&15]+Mo[e>>24&15]+Mo[e>>20&15]+Mo[e>>16&15]+Mo[e>>12&15]+Mo[e>>8&15]+Mo[e>>4&15]+Mo[15&e]+Mo[t>>28&15]+Mo[t>>24&15]+Mo[t>>20&15]+Mo[t>>16&15]+Mo[t>>12&15]+Mo[t>>8&15]+Mo[t>>4&15]+Mo[15&t]+Mo[n>>28&15]+Mo[n>>24&15]+Mo[n>>20&15]+Mo[n>>16&15]+Mo[n>>12&15]+Mo[n>>8&15]+Mo[n>>4&15]+Mo[15&n]+Mo[r>>28&15]+Mo[r>>24&15]+Mo[r>>20&15]+Mo[r>>16&15]+Mo[r>>12&15]+Mo[r>>8&15]+Mo[r>>4&15]+Mo[15&r]+Mo[a>>28&15]+Mo[a>>24&15]+Mo[a>>20&15]+Mo[a>>16&15]+Mo[a>>12&15]+Mo[a>>8&15]+Mo[a>>4&15]+Mo[15&a]},Fo.prototype.toString=Fo.prototype.hex,Fo.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,a>>24&255,a>>16&255,a>>8&255,255&a]},Fo.prototype.array=Fo.prototype.digest,Fo.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};var Bo=n(3753);const Ho=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r=t.join("_"),new Fo(!0).update(r).hex();var r};class Zo{}const Vo=new Map;class qo extends Zo{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(Ho(e,t))??null)}async update(e,t,n){this.cache.set(Ho(e,t),n)}static global(){return new qo(Vo)}}var Wo=n(1774),Ko=n(9263),Yo=n(4445),Go=Object.defineProperty;function Jo(e,t){return 1===e.length?[t.get(e.join(","))]:function(e,t){let n=Array.from({length:e.length},((e,t)=>({start:t,end:t+1})));for(;n.length>1;){let r=null;for(let a=0;a<n.length-1;a++){const i=e.slice(n[a].start,n[a+1].end),s=t.get(i.join(","));null!=s&&(null==r||s<r[0])&&(r=[s,a])}if(null==r)break;{const e=r[1];n[e]={start:n[e].start,end:n[e+1].end},n.splice(e+1,1)}}return n}(e,t).map((n=>t.get(e.slice(n.start,n.end).join(",")))).filter((e=>null!=e))}var Xo,Qo,el=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=(()=>new TextEncoder)();textDecoder=(()=>new TextDecoder("utf-8"))();rankMap=(()=>new Map)();textMap=(()=>new Map)();constructor(e,t){this.patStr=e.pat_str;const n=e.bpe_ranks.split("\n").filter(Boolean).reduce(((e,t)=>{const[n,r,...a]=t.split(" "),i=Number.parseInt(r,10);return a.forEach(((t,n)=>e[t]=i+n)),e}),{});for(const[r,a]of Object.entries(n)){const e=Yo.toByteArray(r);this.rankMap.set(e.join(","),a),this.textMap.set(a,e)}this.specialTokens={...e.special_tokens,...t},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce(((e,t)=>{let[n,r]=t;return e[r]=this.textEncoder.encode(n),e}),{})}encode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all";const r=new RegExp(this.patStr,"ug"),a=el.specialTokenRegex(Object.keys(this.specialTokens)),i=[],s=new Set("all"===t?Object.keys(this.specialTokens):t),o=new Set("all"===n?Object.keys(this.specialTokens).filter((e=>!s.has(e))):n);if(o.size>0){const t=el.specialTokenRegex([...o]),n=e.match(t);if(null!=n)throw new Error(`The text contains a special token that is not allowed: ${n[0]}`)}let l=0;for(;;){let t=null,n=l;for(;a.lastIndex=n,t=a.exec(e),null!=t&&!s.has(t[0]);)n=t.index+1;const o=t?.index??e.length;for(const a of e.substring(l,o).matchAll(r)){const e=this.textEncoder.encode(a[0]),t=this.rankMap.get(e.join(","));null==t?i.push(...Jo(e,this.rankMap)):i.push(t)}if(null==t)break;let c=this.specialTokens[t[0]];i.push(c),l=t.index+t[0].length}return i}decode(e){const t=[];let n=0;for(let i=0;i<e.length;++i){const r=e[i],a=this.textMap.get(r)??this.inverseSpecialTokens[r];null!=a&&(t.push(a),n+=a.length)}const r=new Uint8Array(n);let a=0;for(const i of t)r.set(i,a),a+=i.length;return this.textDecoder.decode(r)}},tl=el;Qo=e=>new RegExp(e.map((e=>function(e){return e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(e))).join("|"),"g"),((e,t,n)=>{t in e?Go(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(tl,"symbol"!==typeof(Xo="specialTokenRegex")?Xo+"":Xo,Qo);const nl={},rl=new Ko.g({});async function al(e){return async function(e){return e in nl||(nl[e]=rl.fetch(`https://tiktoken.pages.dev/js/${e}.json`).then((e=>e.json())).then((e=>new tl(e))).catch((t=>{throw delete nl[e],t}))),await nl[e]}(function(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}(e))}var il=n(4085);const sl=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e;class ol extends il.YN{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??!1,this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class ll extends ol{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor(e){let{callbacks:t,callbackManager:n,...r}=e;const{cache:a,...i}=r;super({callbacks:t??n,...i}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache="object"===typeof a?a:a?qo.global():void 0,this.caller=new Ko.g(r??{})}async getNumTokens(e){if("string"!==typeof e)return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await al("modelName"in this?sl(this.modelName):"gpt2")}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}return t}static _convertInputToPromptValue(e){return"string"===typeof e?new Wo.HY(e):Array.isArray(e)?new Wo.aB(e.map(Bo.K0)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall(e){let{config:t,...n}=e;const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()},a=Object.entries(r).filter((e=>{let[t,n]=e;return void 0!==n})),i=a.map((e=>{let[t,n]=e;return`${t}:${JSON.stringify(n)}`})).sort().join(",");return i}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}var cl=n(6480),ul=n(4385),dl=n(6031),hl=n(261),pl=n(1430);class fl extends il.YN{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const n=(0,pl.ZI)(t);return this.func&&await this.func(e,n),this._callWithConfig((e=>Promise.resolve(e)),e,n)}async*transform(e,t){const n=(0,pl.ZI)(t);let r,a=!0;for await(const i of this._transformStreamWithConfig(e,(e=>e),n))if(yield i,a)if(void 0===r)r=i;else try{r=(0,hl.xW)(r,i)}catch{r=void 0,a=!1}this.func&&void 0!==r&&await this.func(r,n)}static assign(e){return new il.B2(new il.ck({steps:e}))}}function ml(e){return"function"===typeof e?.parse}class gl extends ll{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=t.signal,[t,n]}async invoke(e,t){const n=gl._convertInputToPromptValue(e);return(await this.generatePrompt([n],t,t?.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,n){throw new Error("Not implemented.")}async*_streamIterator(e,t){if(this._streamResponseChunks===gl.prototype._streamResponseChunks)yield this.invoke(e,t);else{const r=gl._convertInputToPromptValue(e).toChatMessages(),[a,i]=this._separateRunnableConfigFromCallOptionsCompat(t),s={...a.metadata,...this.getLsParams(i)},o=await cl.Td.configure(a.callbacks,this.callbacks,a.tags,this.tags,s,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this?.invocationParams(i),batch_size:1},c=await(o?.handleChatModelStart(this.toJSON(),[r],a.runId,void 0,l,void 0,void 0,a.runName));let u,d;try{for await(const e of this._streamResponseChunks(r,i,c?.[0])){if(null==e.message.id){const t=c?.at(0)?.runId;null!=t&&e.message._updateId(`run-${t}`)}e.message.response_metadata={...e.generationInfo,...e.message.response_metadata},yield e.message,u=u?u.concat(e):e,(0,Ao.jm)(e.message)&&void 0!==e.message.usage_metadata&&(d={tokenUsage:{promptTokens:e.message.usage_metadata.input_tokens,completionTokens:e.message.usage_metadata.output_tokens,totalTokens:e.message.usage_metadata.total_tokens}})}}catch(n){throw await Promise.all((c??[]).map((e=>e?.handleLLMError(n)))),n}await Promise.all((c??[]).map((e=>e?.handleLLMEnd({generations:[[u]],llmOutput:d}))))}}getLsParams(e){const t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,n){const r=e.map((e=>e.map(Ao.K0))),a={...n.metadata,...this.getLsParams(t)},i=await cl.Td.configure(n.callbacks,this.callbacks,n.tags,this.tags,a,this.metadata,{verbose:this.verbose}),s={options:t,invocation_params:this?.invocationParams(t),batch_size:1},o=await(i?.handleChatModelStart(this.toJSON(),r,n.runId,void 0,s,void 0,void 0,n.runName)),l=[],c=[];if(!!o?.[0].handlers.find((e=>(0,ul.K)(e)||(0,dl.l7)(e)))&&1===r.length&&this._streamResponseChunks!==gl.prototype._streamResponseChunks)try{const e=await this._streamResponseChunks(r[0],t,o?.[0]);let n,a;for await(const t of e){if(null==t.message.id){const e=o?.at(0)?.runId;null!=e&&t.message._updateId(`run-${e}`)}n=void 0===n?t:(0,hl.xW)(n,t),(0,Ao.jm)(t.message)&&void 0!==t.message.usage_metadata&&(a={tokenUsage:{promptTokens:t.message.usage_metadata.input_tokens,completionTokens:t.message.usage_metadata.output_tokens,totalTokens:t.message.usage_metadata.total_tokens}})}if(void 0===n)throw new Error("Received empty response from chat model call.");l.push([n]),await(o?.[0].handleLLMEnd({generations:l,llmOutput:a}))}catch($u){throw await(o?.[0].handleLLMError($u)),$u}else{const e=await Promise.allSettled(r.map(((e,n)=>this._generate(e,{...t,promptIndex:n},o?.[n]))));await Promise.all(e.map((async(e,t)=>{if("fulfilled"===e.status){const n=e.value;for(const e of n.generations){if(null==e.message.id){const t=o?.at(0)?.runId;null!=t&&e.message._updateId(`run-${t}`)}e.message.response_metadata={...e.generationInfo,...e.message.response_metadata}}return 1===n.generations.length&&(n.generations[0].message.response_metadata={...n.llmOutput,...n.generations[0].message.response_metadata}),l[t]=n.generations,c[t]=n.llmOutput,o?.[t]?.handleLLMEnd({generations:[n.generations],llmOutput:n.llmOutput})}return await(o?.[t]?.handleLLMError(e.reason)),Promise.reject(e.reason)})))}const u={generations:l,llmOutput:c.length?this._combineLLMOutput?.(...c):void 0};return Object.defineProperty(u,Co.SP,{value:o?{runIds:o?.map((e=>e.runId))}:void 0,configurable:!0}),u}async _generateCached(e){let{messages:t,cache:n,llmStringKey:r,parsedOptions:a,handledOptions:i}=e;const s=t.map((e=>e.map(Ao.K0))),o={...i.metadata,...this.getLsParams(a)},l=await cl.Td.configure(i.callbacks,this.callbacks,i.tags,this.tags,o,this.metadata,{verbose:this.verbose}),c={options:a,invocation_params:this?.invocationParams(a),batch_size:1,cached:!0},u=await(l?.handleChatModelStart(this.toJSON(),s,i.runId,void 0,c,void 0,void 0,i.runName)),d=[],h=(await Promise.allSettled(s.map((async(e,t)=>{const a=gl._convertInputToPromptValue(e).toString(),i=await n.lookup(a,r);return null==i&&d.push(t),i})))).map(((e,t)=>({result:e,runManager:u?.[t]}))).filter((e=>{let{result:t}=e;return"fulfilled"===t.status&&null!=t.value||"rejected"===t.status})),p=[];await Promise.all(h.map((async(e,t)=>{let{result:n,runManager:r}=e;if("fulfilled"===n.status){const e=n.value;return p[t]=e,e.length&&await(r?.handleLLMNewToken(e[0].text)),r?.handleLLMEnd({generations:[e]})}return await(r?.handleLLMError(n.reason)),Promise.reject(n.reason)})));const f={generations:p,missingPromptIndices:d};return Object.defineProperty(f,Co.SP,{value:u?{runIds:u?.map((e=>e.runId))}:void 0,configurable:!0}),f}async generate(e,t,n){let r;r=Array.isArray(t)?{stop:t}:t;const a=e.map((e=>e.map(Ao.K0))),[i,s]=this._separateRunnableConfigFromCallOptionsCompat(r);if(i.callbacks=i.callbacks??n,!this.cache)return this._generateUncached(a,s,i);const{cache:o}=this,l=this._getSerializedCacheKeyParametersForCall(s),{generations:c,missingPromptIndices:u}=await this._generateCached({messages:a,cache:o,llmStringKey:l,parsedOptions:s,handledOptions:i});let d={};if(u.length>0){const e=await this._generateUncached(u.map((e=>a[e])),s,i);await Promise.all(e.generations.map((async(e,t)=>{const n=u[t];c[n]=e;const r=gl._convertInputToPromptValue(a[n]).toString();return o.update(r,l,e)}))),d=e.llmOutput??{}}return{generations:c,llmOutput:d}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,n){const r=e.map((e=>e.toChatMessages()));return this.generate(r,t,n)}async call(e,t,n){return(await this.generate([e.map(Ao.K0)],t,n)).generations[0][0].message}async callPrompt(e,t,n){const r=e.toChatMessages();return this.call(r,t,n)}async predictMessages(e,t,n){return this.call(e,t,n)}async predict(e,t,n){const r=new Ao.xc(e),a=await this.call([r],t,n);if("string"!==typeof a.content)throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,t){if("function"!==typeof this.bindTools)throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const n=e,r=t?.name,a=n.description??"A function available to call.",i=t?.method,s=t?.includeRaw;if("jsonMode"===i)throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let o,l=r??"extract";ml(n)?o=[{type:"function",function:{name:l,description:a,parameters:(0,$o.Ik)(n)}}]:("name"in n&&(l=n.name),o=[{type:"function",function:{name:l,description:a,parameters:n}}]);const c=this.bindTools(o),u=il.jY.from((e=>{if(!e.tool_calls||0===e.tool_calls.length)throw new Error("No tool calls found in the response.");const t=e.tool_calls.find((e=>e.name===l));if(!t)throw new Error(`No tool call found with name ${l}.`);return t.args}));if(!s)return c.pipe(u).withConfig({runName:"StructuredOutput"});const d=fl.assign({parsed:(e,t)=>u.invoke(e.raw,t)}),h=fl.assign({parsed:()=>null}),p=d.withFallbacks({fallbacks:[h]});return il.zZ.from([{raw:c},p]).withConfig({runName:"StructuredOutputRunnable"})}}il.YN;il.YN;il.fJ;var yl=n(5527);class vl extends il.YN{parseResultWithPrompt(e,t,n){return this.parseResult(e,n)}_baseMessageToString(e){return"string"===typeof e.content?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return"string"===typeof e?this._callWithConfig((async(e,t)=>this.parseResult([{text:e}],t?.callbacks)),e,{...t,runType:"parser"}):this._callWithConfig((async(e,t)=>this.parseResult([{message:e,text:this._baseMessageToString(e)}],t?.callbacks)),e,{...t,runType:"parser"})}}class bl extends vl{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}}class wl extends Error{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=n,this.sendToLLM=r,r&&(void 0===n||void 0===t))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");(0,yl.Y)(this,"OUTPUT_PARSING_FAILURE")}}var _l=n(543);function xl(e,t){const n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(!xl(e[r],t[r]))return!1;return!0}if("object"===n){if(!e||!t)return e===t;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const a of n)if(!xl(e[a],t[a]))return!1;return!0}return e===t}"undefined"!==typeof self&&self.location&&"null"!==self.location.origin&&(self.location.origin,self.location.pathname,location.search);const El=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,kl=[0,31,28,31,30,31,30,31,31,30,31,30,31],Sl=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,Ol=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,Pl=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Tl=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,Nl=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,jl=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,Il=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Al=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,Cl=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,Rl=/^\d\d\d\d-[0-1]\d-[0-3]\d$/,$l=/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,Ll=/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,Ml=/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,Dl=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,Ul=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i;function zl(e){return e.test.bind(e)}const Fl={date:Bl,time:Hl.bind(void 0,!1),"date-time":function(e){const t=e.split(Zl);return 2==t.length&&Bl(t[0])&&Hl(!0,t[1])},duration:e=>e.length>1&&e.length<80&&(/^P\d+([.,]\d+)?W$/.test(e)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(e)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(e)),uri:function(e){return Vl.test(e)&&ql.test(e)},"uri-reference":zl(Pl),"uri-template":zl(Tl),url:zl(Nl),email:e=>{if('"'===e[0])return!1;const[t,n,...r]=e.split("@");return!(!t||!n||0!==r.length||t.length>64||n.length>253)&&("."!==t[0]&&!t.endsWith(".")&&!t.includes("..")&&(!(!/^[a-z0-9.-]+$/i.test(n)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(t))&&n.split(".").every((e=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(e)))))},hostname:zl(Ol),ipv4:zl(Dl),ipv6:zl(Ul),regex:function(e){if(Wl.test(e))return!1;try{return new RegExp(e),!0}catch($u){return!1}},uuid:zl(jl),"json-pointer":zl(Il),"json-pointer-uri-fragment":zl(Al),"relative-json-pointer":zl(Cl)};function Bl(e){const t=e.match(El);if(!t)return!1;const n=+t[1],r=+t[2],a=+t[3];return r>=1&&r<=12&&a>=1&&a<=(2==r&&function(e){return e%4===0&&(e%100!==0||e%400===0)}(n)?29:kl[r])}function Hl(e,t){const n=t.match(Sl);if(!n)return!1;const r=+n[1],a=+n[2],i=+n[3],s=!!n[5];return(r<=23&&a<=59&&i<=59||23==r&&59==a&&60==i)&&(!e||s)}const Zl=/t|\s/i;const Vl=/\/|:/,ql=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;const Wl=/[^\\]\\Z/;class Kl extends bl{async*_transform(e){for await(const t of e)"string"===typeof t?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class Yl extends Kl{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}async*_transform(e){let t,n;for await(const r of e){if("string"!==typeof r&&"string"!==typeof r.content)throw new Error("Cannot handle non-string output.");let e;if((0,_l.AJ)(r)){if("string"!==typeof r.content)throw new Error("Cannot handle non-string message output.");e=new Co.Cf({message:r,text:r.content})}else if((0,_l.ny)(r)){if("string"!==typeof r.content)throw new Error("Cannot handle non-string message output.");e=new Co.Cf({message:(0,Bo.ih)(r),text:r.content})}else e=new Co.mu({text:r});n=void 0===n?e:n.concat(e);const a=await this.parsePartialResult([n]);void 0===a||null===a||xl(a,t)||(this.diff?yield this._diff(t,a):yield a,t=a)}}getFormatInstructions(){return""}}var Gl=n(7665);class Jl extends bl{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){return new this(Gl.z.object(Object.fromEntries(Object.entries(e).map((e=>{let[t,n]=e;return[t,Gl.z.string().describe(n)]})))))}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.\n\n"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.\n\nFor example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}\nwould match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.\nThus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.\n\nYour output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!\n\nHere is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:\n\`\`\`json\n${JSON.stringify((0,$o.Ik)(this.schema))}\n\`\`\`\n`}async parse(e){try{const t=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,((e,t)=>`"${t.replace(/\n/g,"\\n")}"`)).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(t))}catch($u){throw new wl(`Failed to parse. Text: "${e}". Error: ${$u}`,e)}}}var Xl=n(6922),Ql=n(9523);class ec extends Yl{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,t){if(t)return e?(0,Xl.UD)(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return(0,Ql.D)(e[0].text)}async parse(e){return(0,Ql.D)(e,JSON.parse)}getFormatInstructions(){return""}}var tc=n(1388);function nc(e,t){if(void 0===e.function)return;let n;if(t?.partial)try{n=(0,Ql.d)(e.function.arguments??"{}")}catch($u){return}else try{n=JSON.parse(e.function.arguments)}catch($u){throw new wl([`Function "${e.function.name}" arguments:`,"",e.function.arguments,"","are not valid JSON.",`Error: ${$u.message}`].join("\n"))}const r={name:e.function.name,args:n,type:"tool_call"};return t?.returnId&&(r.id=e.id),r}function rc(e){if(void 0===e.id)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function ac(e,t){return{name:e.function?.name,args:e.function?.arguments,id:e.id,error:t,type:"invalid_tool_call"}}class ic extends Yl{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=e?.returnId??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e[0].message;let r;if((0,tc.KX)(n)&&n.tool_calls?.length)r=n.tool_calls.map((e=>{const{id:t,...n}=e;return this.returnId?{id:t,...n}:n}));else if(void 0!==n.additional_kwargs.tool_calls){r=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map((e=>nc(e,{returnId:this.returnId,partial:t})))}if(!r)return[];const a=[];for(const i of r)if(void 0!==i){const e={type:i.name,args:i.args,id:i.id};a.push(e)}return a}}class sc extends ic{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(void 0===this.zodSchema)return e;const t=await this.zodSchema.safeParseAsync(e);if(t.success)return t.data;throw new wl(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const t=(await super.parsePartialResult(e)).filter((e=>e.type===this.keyName));let n=t;if(t.length)return this.returnId||(n=t.map((e=>e.args))),this.returnSingle?n[0]:n}async parseResult(e){const t=(await super.parsePartialResult(e,!1)).filter((e=>e.type===this.keyName));let n=t;if(!t.length)return;if(this.returnId||(n=t.map((e=>e.args))),this.returnSingle)return this._validateResult(n[0]);const r=await Promise.all(n.map((e=>this._validateResult(e))));return r}}function oc(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function lc(e,t,n,r,a){e[t]=n,oc(e,t,r,a)}function cc(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map(((n,r)=>cc(e,t,n)))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return uc(e,t)}}const uc=(e,t)=>{const n={type:"integer",format:"unix-time"};if("openApi3"===t.target)return n;for(const r of e.checks)switch(r.kind){case"min":lc(n,"minimum",r.value,r.message,t);break;case"max":lc(n,"maximum",r.value,r.message,t)}return n};let dc;const hc=/^[cC][^\s-]{8,}$/,pc=/^[0-9a-z]+$/,fc=/^[0-9A-HJKMNP-TV-Z]{26}$/,mc=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,gc=()=>(void 0===dc&&(dc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),dc),yc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,vc=/^[a-zA-Z0-9_-]{21}$/;function bc(e,t){const n={type:"string"};function r(e){return"escape"===t.patternStrategy?wc(e):e}if(e.checks)for(const a of e.checks)switch(a.kind){case"min":lc(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":lc(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":_c(n,"email",a.message,t);break;case"format:idn-email":_c(n,"idn-email",a.message,t);break;case"pattern:zod":xc(n,mc,a.message,t)}break;case"url":_c(n,"uri",a.message,t);break;case"uuid":_c(n,"uuid",a.message,t);break;case"regex":xc(n,a.regex,a.message,t);break;case"cuid":xc(n,hc,a.message,t);break;case"cuid2":xc(n,pc,a.message,t);break;case"startsWith":xc(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":xc(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":_c(n,"date-time",a.message,t);break;case"date":_c(n,"date",a.message,t);break;case"time":_c(n,"time",a.message,t);break;case"duration":_c(n,"duration",a.message,t);break;case"length":lc(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t),lc(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":xc(n,RegExp(r(a.value)),a.message,t);break;case"ip":"v6"!==a.version&&_c(n,"ipv4",a.message,t),"v4"!==a.version&&_c(n,"ipv6",a.message,t);break;case"emoji":xc(n,gc,a.message,t);break;case"ulid":xc(n,fc,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":_c(n,"binary",a.message,t);break;case"contentEncoding:base64":lc(n,"contentEncoding","base64",a.message,t);break;case"pattern:zod":xc(n,yc,a.message,t)}break;case"nanoid":xc(n,vc,a.message,t)}return n}const wc=e=>Array.from(e).map((e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`)).join(""),_c=(e,t,n,r)=>{e.format||e.anyOf?.some((e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):lc(e,"format",t,n,r)},xc=(e,t,n,r)=>{e.pattern||e.allOf?.some((e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:Ec(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):lc(e,"pattern",Ec(t,r),n,r)},Ec=(e,t)=>{const n="function"===typeof e?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;const r=n.flags.includes("i"),a=n.flags.includes("m"),i=n.flags.includes("s"),s=r?n.source.toLowerCase():n.source;let o="",l=!1,c=!1,u=!1;for(let d=0;d<s.length;d++)if(l)o+=s[d],l=!1;else{if(r)if(c){if(s[d].match(/[a-z]/)){u?(o+=s[d],o+=`${s[d-2]}-${s[d]}`.toUpperCase(),u=!1):"-"===s[d+1]&&s[d+2]?.match(/[a-z]/)?(o+=s[d],u=!0):o+=`${s[d]}${s[d].toUpperCase()}`;continue}}else if(s[d].match(/[a-z]/)){o+=`[${s[d]}${s[d].toUpperCase()}]`;continue}if(a){if("^"===s[d]){o+="(^|(?<=[\r\n]))";continue}if("$"===s[d]){o+="($|(?=[\r\n]))";continue}}i&&"."===s[d]?o+=c?`${s[d]}\r\n`:`[${s[d]}\r\n]`:(o+=s[d],"\\"===s[d]?l=!0:c&&"]"===s[d]?c=!1:c||"["!==s[d]||(c=!0))}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return o};function kc(e,t){if("openApi3"===t.target&&e.keyType?._def.typeName===Gl.kY.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce(((n,r)=>({...n,[r]:jc(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",r]})??{}})),{}),additionalProperties:!1};const n={type:"object",additionalProperties:jc(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return n;if(e.keyType?._def.typeName===Gl.kY.ZodString&&e.keyType._def.checks?.length){const r=Object.entries(bc(e.keyType._def,t)).reduce(((e,t)=>{let[n,r]=t;return"type"===n?e:{...e,[n]:r}}),{});return{...n,propertyNames:r}}return e.keyType?._def.typeName===Gl.kY.ZodEnum?{...n,propertyNames:{enum:e.keyType._def.values}}:n}const Sc={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};const Oc=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map(((e,n)=>jc(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${n}`]}))).filter((e=>!!e&&(!t.strictUnions||"object"===typeof e&&Object.keys(e).length>0)));return n.length?{anyOf:n}:void 0};function Pc(e,t){return"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:jc(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:jc(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}const Tc=Symbol("Let zodToJsonSchema decide on which parser to use"),Nc={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function jc(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.seen.get(e);if(t.override){const a=t.override?.(e,t,r,n);if(a!==Tc)return a}if(r&&!n){const e=Ic(r,t);if(void 0!==e)return"$ref"in e&&t.seenRefs.add(e.$ref),e}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const i=Cc(e,e.typeName,t,n);return i&&Rc(e,t,i),a.jsonSchema=i,i}const Ic=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":const n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&"duplicate-ref"===t.nameStrategy&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:Ac(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every(((e,n)=>t.currentPath[n]===e))?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):"seen"===t.$refStrategy?{}:void 0}},Ac=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Cc=(e,t,n,r)=>{switch(t){case Gl.kY.ZodString:return bc(e,n);case Gl.kY.ZodNumber:return function(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",oc(n,"type",r.message,t);break;case"min":"jsonSchema7"===t.target?r.inclusive?lc(n,"minimum",r.value,r.message,t):lc(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),lc(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?lc(n,"maximum",r.value,r.message,t):lc(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),lc(n,"maximum",r.value,r.message,t));break;case"multipleOf":lc(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case Gl.kY.ZodObject:return function(e,t){const n={type:"object",...Object.entries(e.shape()).reduce(((e,n)=>{let[r,a]=n;if(void 0===a||void 0===a._def)return e;const i=jc(a._def,{...t,currentPath:[...t.currentPath,"properties",r],propertyPath:[...t.currentPath,"properties",r]});return void 0===i?e:{properties:{...e.properties,[r]:i},required:a.isOptional()&&!t.openaiStrictMode?e.required:[...e.required,r]}}),{properties:{},required:[]}),additionalProperties:Pc(e,t)};return n.required.length||delete n.required,n}(e,n);case Gl.kY.ZodBigInt:return function(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":"jsonSchema7"===t.target?r.inclusive?lc(n,"minimum",r.value,r.message,t):lc(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),lc(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?lc(n,"maximum",r.value,r.message,t):lc(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),lc(n,"maximum",r.value,r.message,t));break;case"multipleOf":lc(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case Gl.kY.ZodBoolean:return{type:"boolean"};case Gl.kY.ZodDate:return cc(e,n);case Gl.kY.ZodUndefined:return{not:{}};case Gl.kY.ZodNull:return function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}(n);case Gl.kY.ZodArray:return function(e,t){const n={type:"array"};return e.type?._def?.typeName!==Gl.kY.ZodAny&&(n.items=jc(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&lc(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&lc(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(lc(n,"minItems",e.exactLength.value,e.exactLength.message,t),lc(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}(e,n);case Gl.kY.ZodUnion:case Gl.kY.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return Oc(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every((e=>e._def.typeName in Sc&&(!e._def.checks||!e._def.checks.length)))){const e=n.reduce(((e,t)=>{const n=Sc[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e}),[]);return{type:e.length>1?e:e[0]}}if(n.every((e=>"ZodLiteral"===e._def.typeName&&!e.description))){const e=n.reduce(((e,t)=>{const n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[...e,n];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}}),[]);if(e.length===n.length){const t=e.filter(((e,t,n)=>n.indexOf(e)===t));return{type:t.length>1?t:t[0],enum:n.reduce(((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value]),[])}}}else if(n.every((e=>"ZodEnum"===e._def.typeName)))return{type:"string",enum:n.reduce(((e,t)=>[...e,...t._def.values.filter((t=>!e.includes(t)))]),[])};return Oc(e,t)}(e,n);case Gl.kY.ZodIntersection:return function(e,t){const n=[jc(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),jc(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter((e=>!!e));let r="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0;const a=[];return n.forEach((e=>{if("type"in(t=e)&&"string"===t.type||!("allOf"in t)){let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){const{additionalProperties:n,...r}=e;t=r}else r=void 0;a.push(t)}else a.push(...e.allOf),void 0===e.unevaluatedProperties&&(r=void 0);var t})),a.length?{allOf:a,...r}:void 0}(e,n);case Gl.kY.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map(((e,n)=>jc(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]}))).reduce(((e,t)=>void 0===t?e:[...e,t]),[]),additionalItems:jc(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map(((e,n)=>jc(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]}))).reduce(((e,t)=>void 0===t?e:[...e,t]),[])}}(e,n);case Gl.kY.ZodRecord:return kc(e,n);case Gl.kY.ZodLiteral:return function(e,t){const n=typeof e.value;return"bigint"!==n&&"number"!==n&&"boolean"!==n&&"string"!==n?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===n?"integer":n,enum:[e.value]}:{type:"bigint"===n?"integer":n,const:e.value}}(e,n);case Gl.kY.ZodEnum:return function(e){return{type:"string",enum:[...e.values]}}(e);case Gl.kY.ZodNativeEnum:return function(e){const t=e.values,n=Object.keys(e.values).filter((e=>"number"!==typeof t[t[e]])),r=n.map((e=>t[e])),a=Array.from(new Set(r.map((e=>typeof e))));return{type:1===a.length?"string"===a[0]?"string":"number":["string","number"],enum:r}}(e);case Gl.kY.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target||"property"===t.nullableStrategy?{type:Sc[e.innerType._def.typeName],nullable:!0}:{type:[Sc[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){const n=jc(e.innerType._def,{...t,currentPath:[...t.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const n=jc(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}(e,n);case Gl.kY.ZodOptional:return((e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return jc(e.innerType._def,t);const n=jc(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}})(e,n);case Gl.kY.ZodMap:return function(e,t){return"record"===t.mapStrategy?kc(e,t):{type:"array",maxItems:125,items:{type:"array",items:[jc(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},jc(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,n);case Gl.kY.ZodSet:return function(e,t){const n={type:"array",uniqueItems:!0,items:jc(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&lc(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&lc(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}(e,n);case Gl.kY.ZodLazy:return jc(e.getter()._def,n);case Gl.kY.ZodPromise:return function(e,t){return jc(e.type._def,t)}(e,n);case Gl.kY.ZodNaN:case Gl.kY.ZodNever:return{not:{}};case Gl.kY.ZodEffects:return function(e,t,n){return"input"===t.effectStrategy?jc(e.schema._def,t,n):{}}(e,n,r);case Gl.kY.ZodAny:case Gl.kY.ZodUnknown:return{};case Gl.kY.ZodDefault:return function(e,t){return{...jc(e.innerType._def,t),default:e.defaultValue()}}(e,n);case Gl.kY.ZodBranded:return function(e,t){return jc(e.type._def,t)}(e,n);case Gl.kY.ZodReadonly:case Gl.kY.ZodCatch:return((e,t)=>jc(e.innerType._def,t))(e,n);case Gl.kY.ZodPipeline:return((e,t)=>{if("input"===t.pipeStrategy)return jc(e.in._def,t);if("output"===t.pipeStrategy)return jc(e.out._def,t);const n=jc(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]});return{allOf:[n,jc(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]})].filter((e=>void 0!==e))}})(e,n);case Gl.kY.ZodFunction:case Gl.kY.ZodVoid:case Gl.kY.ZodSymbol:default:return}},Rc=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),$c=e=>"_def"in e?e._def:e;const Lc=e=>{const t=(e=>"string"===typeof e?{...Nc,basePath:["#"],definitions:{},name:e}:{...Nc,basePath:["#"],definitions:{},...e})(e),n=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map((e=>{let[n,r]=e;return[$c(r),{def:$c(r),path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]})))}};function Mc(e,t){return((e,t)=>{const n=Lc(t),r="string"===typeof t?t:"title"===t?.nameStrategy?void 0:t?.name,a=jc(e._def,void 0===r?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},i="object"===typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==i&&(a.title=i);const s=(()=>{if(function(e){if(!e)return!0;for(const t in e)return!1;return!0}(n.definitions))return;const e={},t=new Set;for(let r=0;r<500;r++){const r=Object.entries(n.definitions).filter((e=>{let[n]=e;return!t.has(n)}));if(0===r.length)break;for(const[a,i]of r)e[a]=jc($c(i),{...n,currentPath:[...n.basePath,n.definitionPath,a]},!0)??{},t.add(a)}return e})(),o=void 0===r?s?{...a,[n.definitionPath]:s}:a:"duplicate-ref"===n.nameStrategy?{...a,...s||n.seenRefs.size?{[n.definitionPath]:{...s,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[..."relative"===n.$refStrategy?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...s,[r]:a}};return"jsonSchema7"===n.target?o.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===n.target&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o})(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Dc(e,t,n){return function(e,t){const n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}({type:"json_schema",json_schema:{...n,name:t,strict:!0,schema:Mc(e,{name:t})}},(t=>e.parse(JSON.parse(t))))}function Uc(e){return function(e,t){let{parser:n,callback:r}=t;const a={...e};return Object.defineProperties(a,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:n,enumerable:!1},$callback:{value:r,enumerable:!1}}),a}({type:"function",function:{name:e.name,parameters:Mc(e.parameters,{name:e.name}),strict:!0,...e.description?{description:e.description}:void 0}},{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}function zc(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:a,baseURL:i,azureADTokenProvider:s,azureOpenAIEndpoint:o}=e;if((r||s)&&a&&t)return`${a}/${t}`;if((r||s)&&o&&t)return`${o}/openai/deployments/${t}`;if(r||s){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${t}`}return i}function Fc(e,t){const n="number"===typeof t?void 0:t;return{name:e.name,description:e.description,parameters:(0,$o.Ik)(e.schema),...void 0!==n?.strict?{strict:n.strict}:{}}}function Bc(e){return function(e){return!!e&&"object"===typeof e&&"name"in e&&"schema"in e&&ml(e.schema)}(e)||function(e){return void 0!==e&&il.YN.isRunnable(e)&&"lc_name"in e.constructor&&"function"===typeof e.constructor.lc_name&&"RunnableToolLike"===e.constructor.lc_name()}(e)||function(e){return void 0!==e&&Array.isArray(e.lc_namespace)}(e)}function Hc(e,t){return e.lc_error_code=t,e.message=`${e.message}\n\nTroubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${t}/\n`,e}function Zc(e){let t;return e.constructor.name===xo.name?(t=new Error(e.message),t.name="TimeoutError"):e.constructor.name===Eo.name?(t=new Error(e.message),t.name="AbortError"):t=400===e.status&&e.message.includes("tool_calls")?Hc(e,"INVALID_TOOL_RESULTS"):401===e.status?Hc(e,"MODEL_AUTHENTICATION"):429===e.status?Hc(e,"MODEL_RATE_LIMIT"):404===e.status?Hc(e,"MODEL_NOT_FOUND"):e,t}function Vc(e,t){const n=[];for(const[r,a]of Object.entries(e.properties??{}))a.description&&t<2&&n.push(`// ${a.description}`),e.required?.includes(r)?n.push(`${r}: ${qc(a,t)},`):n.push(`${r}?: ${qc(a,t)},`);return n.map((e=>" ".repeat(t)+e)).join("\n")}function qc(e,t){if(void 0!==(n=e).anyOf&&Array.isArray(n.anyOf))return e.anyOf.map((e=>qc(e,t))).join(" | ");var n;switch(e.type){case"string":return e.enum?e.enum.map((e=>`"${e}"`)).join(" | "):"string";case"number":case"integer":return e.enum?e.enum.map((e=>`${e}`)).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Vc(e,t+2),"}"].join("\n");case"array":return e.items?`${qc(e.items,t)}[]`:"any[]";default:return""}}function Wc(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":if(!Ao.cM.isInstance(e))throw new Error("Invalid generic chat message");return function(e){return"system"!==e.role&&"assistant"!==e.role&&"user"!==e.role&&"function"!==e.role&&"tool"!==e.role&&console.warn(`Unknown message role: ${e.role}`),e.role}(e);default:throw new Error(`Unknown message type: ${t}`)}}function Kc(e,t,n){const r=e.tool_calls;if("assistant"===e.role){const a=[],i=[];for(const e of r??[])try{a.push(nc(e,{returnId:!0}))}catch($u){i.push(ac(e,$u.message))}const s={function_call:e.function_call,tool_calls:r};let o;return void 0!==n&&(s.__raw_response=t),t.system_fingerprint&&(o={usage:{...t.usage},system_fingerprint:t.system_fingerprint}),e.audio&&(s.audio=e.audio),new Ao.Od({content:e.content||"",tool_calls:a,invalid_tool_calls:i,additional_kwargs:s,response_metadata:o,id:t.id})}return new Ao.cM(e.content||"",e.role??"unknown")}function Yc(e,t,n,r){const a=e.role??n,i=e.content??"";let s;s=e.function_call?{function_call:e.function_call}:e.tool_calls?{tool_calls:e.tool_calls}:{},r&&(s.__raw_response=t),e.audio&&(s.audio={...e.audio,index:t.choices[0].index});const o={usage:{...t.usage}};if("user"===a)return new Ao.a7({content:i,response_metadata:o});if("assistant"===a){const n=[];if(Array.isArray(e.tool_calls))for(const t of e.tool_calls)n.push({name:t.function?.name,args:t.function?.arguments,id:t.id,index:t.index,type:"tool_call_chunk"});return new Ao.H({content:i,tool_call_chunks:n,additional_kwargs:s,id:t.id,response_metadata:o})}return"system"===a?new Ao.uU({content:i,response_metadata:o}):"function"===a?new Ao.FK({content:i,additional_kwargs:s,name:e.name,response_metadata:o}):"tool"===a?new Ao.dr({content:i,additional_kwargs:s,tool_call_id:e.tool_call_id,response_metadata:o}):new Ao.XU({content:i,role:a,response_metadata:o})}function Gc(e){return e.flatMap((e=>{const t={role:Wc(e),content:e.content};if(null!=e.name&&(t.name=e.name),null!=e.additional_kwargs.function_call&&(t.function_call=e.additional_kwargs.function_call,t.content=null),(0,Ao.KX)(e)&&e.tool_calls?.length?(t.tool_calls=e.tool_calls.map(rc),t.content=null):(null!=e.additional_kwargs.tool_calls&&(t.tool_calls=e.additional_kwargs.tool_calls),null!=e.tool_call_id&&(t.tool_call_id=e.tool_call_id)),e.additional_kwargs.audio&&"object"===typeof e.additional_kwargs.audio&&"id"in e.additional_kwargs.audio){return[t,{role:"assistant",audio:{id:e.additional_kwargs.audio.id}}]}return t}))}function Jc(e,t){return function(e){return!("object"!==typeof e||!e)&&!!("type"in e&&"function"===e.type&&"function"in e&&"object"===typeof e.function&&e.function&&"name"in e.function&&"parameters"in e.function)}(e)?void 0!==t?.strict?{...e,function:{...e.function,strict:t.strict}}:e:function(e,t){let n;if(Bc(e)){const r=Uc({name:e.name,parameters:e.schema,description:e.description});n=r.function.parameters?{type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...void 0!==t?.strict?{strict:t.strict}:{}}}:{type:"function",function:Fc(e,t)}}else n=e;return void 0!==t?.strict&&(n.function.strict=t.strict),n}(e,t)}class Xc extends gl{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.apiKey??e?.openAIApiKey??e?.configuration?.apiKey??(0,Ro.Az)("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=e?.azureOpenAIApiKey??(0,Ro.Az)("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=e?.azureADTokenProvider??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,Ro.Az)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=e?.azureOpenAIApiDeploymentName??(0,Ro.Az)("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??(0,Ro.Az)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,Ro.Az)("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??(0,Ro.Az)("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=e?.azureOpenAIEndpoint??(0,Ro.Az)("AZURE_OPENAI_ENDPOINT"),this.modelName=e?.model??e?.modelName??this.model,this.model=this.modelName,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.maxTokens=e?.maxTokens,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this?.stop,this.user=e?.user,this.__includeRawResponse=e?.__includeRawResponse,this.audio=e?.audio,this.modalities=e?.modalities,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const e=this.azureOpenAIBasePath.split("/openai/deployments/");if(2===e.length){const[,t]=e;this.azureOpenAIApiDeploymentName=t}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.streaming=e?.streaming??!1,this.streamUsage=e?.streamUsage??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:t?.basePath??e?.configuration?.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:t?.baseOptions?.headers??e?.configuration?.baseOptions?.headers,defaultQuery:t?.baseOptions?.params??e?.configuration?.baseOptions?.params,...t,...e?.configuration},void 0!==e?.supportsStrictToolCalling&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,t){let n;return void 0!==t?.strict?n=t.strict:void 0!==this.supportsStrictToolCalling&&(n=this.supportsStrictToolCalling),this.bind({tools:e.map((e=>Jc(e,{strict:n}))),...t})}createResponseFormat(e){return e&&"json_schema"===e.type&&e.json_schema.schema&&Qc(e.json_schema.schema)?Dc(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,t){let n;void 0!==e?.strict?n=e.strict:void 0!==this.supportsStrictToolCalling&&(n=this.supportsStrictToolCalling);let r={};void 0!==e?.stream_options?r={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t?.streaming)&&(r={stream_options:{include_usage:!0}});const a={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:-1===this.maxTokens?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:e?.tools?.length?e.tools.map((e=>Jc(e,{strict:n}))):void 0,tool_choice:(i=e?.tool_choice,i?"any"===i||"required"===i?"required":"auto"===i?"auto":"none"===i?"none":"string"===typeof i?{type:"function",function:{name:i}}:i:void 0),response_format:this.createResponseFormat(e?.response_format),seed:e?.seed,...r,parallel_tool_calls:e?.parallel_tool_calls,...this.audio||e?.audio?{audio:this.audio||e?.audio}:{},...this.modalities||e?.modalities?{modalities:this.modalities||e?.modalities}:{},...this.modelKwargs};var i;return a}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,t,n){if(this.model.includes("o1-")){console.warn("[WARNING]: OpenAI o1 models do not yet support token-level streaming. Streaming will yield single chunk.");const r=await this._generate(e,t,n),a=(0,Ao.ih)(r.generations[0].message);return void(yield new Co.Cf({message:a,text:"string"===typeof a.content?a.content:""}))}const r=Gc(e),a={...this.invocationParams(t,{streaming:!0}),messages:r,stream:!0};let i;const s=await this.completionWithRetry(a,t);let o;for await(const l of s){const e=l?.choices?.[0];if(l.usage&&(o=l.usage),!e)continue;const{delta:r}=e;if(!r)continue;const a=Yc(r,l,i,this.__includeRawResponse);i=r.role??i;const s={prompt:t.promptIndex??0,completion:e.index??0};if("string"!==typeof a.content){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const c={...s};null!=e.finish_reason&&(c.finish_reason=e.finish_reason,c.system_fingerprint=l.system_fingerprint),this.logprobs&&(c.logprobs=e.logprobs);const u=new Co.Cf({message:a,text:a.content,generationInfo:c});yield u,await(n?.handleLLMNewToken(u.text??"",s,void 0,void 0,void 0,{chunk:u}))}if(o){const e={...null!==o.prompt_tokens_details?.audio_tokens&&{audio:o.prompt_tokens_details?.audio_tokens},...null!==o.prompt_tokens_details?.cached_tokens&&{cache_read:o.prompt_tokens_details?.cached_tokens}},t={...null!==o.completion_tokens_details?.audio_tokens&&{audio:o.completion_tokens_details?.audio_tokens},...null!==o.completion_tokens_details?.reasoning_tokens&&{reasoning:o.completion_tokens_details?.reasoning_tokens}},n=new Co.Cf({message:new Ao.H({content:"",response_metadata:{usage:{...o}},usage_metadata:{input_tokens:o.prompt_tokens,output_tokens:o.completion_tokens,total_tokens:o.total_tokens,...Object.keys(e).length>0&&{input_token_details:e},...Object.keys(t).length>0&&{output_token_details:t}}}),text:""});yield n}if(t.signal?.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,t,n){const r={},a=this.invocationParams(t),i=Gc(e);if(a.stream){const a=this._streamResponseChunks(e,t,n),i={};for await(const e of a){e.message.response_metadata={...e.generationInfo,...e.message.response_metadata};const t=e.generationInfo?.completion??0;void 0===i[t]?i[t]=e:i[t]=i[t].concat(e)}const s=Object.entries(i).sort(((e,t)=>{let[n]=e,[r]=t;return parseInt(n,10)-parseInt(r,10)})).map((e=>{let[t,n]=e;return n})),{functions:o,function_call:l}=this.invocationParams(t),c=await this.getEstimatedTokenCountFromPrompt(e,o,l),u=await this.getNumTokensFromGenerations(s);return r.input_tokens=c,r.output_tokens=u,r.total_tokens=c+u,{generations:s,llmOutput:{estimatedTokenUsage:{promptTokens:r.input_tokens,completionTokens:r.output_tokens,totalTokens:r.total_tokens}}}}{let e;e=t.response_format&&"json_schema"===t.response_format.type?await this.betaParsedCompletionWithRetry({...a,stream:!1,messages:i},{signal:t?.signal,...t?.options}):await this.completionWithRetry({...a,stream:!1,messages:i},{signal:t?.signal,...t?.options});const{completion_tokens:n,prompt_tokens:s,total_tokens:o,prompt_tokens_details:l,completion_tokens_details:c}=e?.usage??{};n&&(r.output_tokens=(r.output_tokens??0)+n),s&&(r.input_tokens=(r.input_tokens??0)+s),o&&(r.total_tokens=(r.total_tokens??0)+o),null===l?.audio_tokens&&null===l?.cached_tokens||(r.input_token_details={...null!==l?.audio_tokens&&{audio:l?.audio_tokens},...null!==l?.cached_tokens&&{cache_read:l?.cached_tokens}}),null===c?.audio_tokens&&null===c?.reasoning_tokens||(r.output_token_details={...null!==c?.audio_tokens&&{audio:c?.audio_tokens},...null!==c?.reasoning_tokens&&{reasoning:c?.reasoning_tokens}});const u=[];for(const t of e?.choices??[]){const n={text:t.message?.content??"",message:Kc(t.message??{role:"assistant"},e,this.__includeRawResponse)};n.generationInfo={...t.finish_reason?{finish_reason:t.finish_reason}:{},...t.logprobs?{logprobs:t.logprobs}:{}},(0,Ao.KX)(n.message)&&(n.message.usage_metadata=r),n.message=new Ao.Od({...n.message}),u.push(n)}return{generations:u,llmOutput:{tokenUsage:{promptTokens:r.input_tokens,completionTokens:r.output_tokens,totalTokens:r.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,t,n){let r=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&"auto"!==n){const e=function(e){const t=["namespace functions {",""];for(const n of e)n.description&&t.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(t.push(`type ${n.name} = (_: {`),t.push(Vc(n.parameters,0)),t.push("}) => any;")):t.push(`type ${n.name} = () => any;`),t.push("");return t.push("} // namespace functions"),t.join("\n")}(t);r+=await this.getNumTokens(e),r+=9}return t&&e.find((e=>"system"===e._getType()))&&(r-=4),"none"===n?r+=1:"object"===typeof n&&(r+=await this.getNumTokens(n.name)+4),r}async getNumTokensFromGenerations(e){return(await Promise.all(e.map((async e=>e.message.additional_kwargs?.function_call?(await this.getNumTokensFromMessages([e.message])).countPerMessage[0]:await this.getNumTokens(e.message.content))))).reduce(((e,t)=>e+t),0)}async getNumTokensFromMessages(e){let t=0,n=0,r=0;"gpt-3.5-turbo-0301"===this.model?(n=4,r=-1):(n=3,r=1);const a=await Promise.all(e.map((async e=>{const a=await this.getNumTokens(e.content),i=await this.getNumTokens(Wc(e)),s=void 0!==e.name?r+await this.getNumTokens(e.name):0;let o=a+n+i+s;const l=e;if("function"===l._getType()&&(o-=2),l.additional_kwargs?.function_call&&(o+=3),l?.additional_kwargs.function_call?.name&&(o+=await this.getNumTokens(l.additional_kwargs.function_call?.name)),l.additional_kwargs.function_call?.arguments)try{o+=await this.getNumTokens(JSON.stringify(JSON.parse(l.additional_kwargs.function_call?.arguments)))}catch(c){console.error("Error parsing function arguments",c,JSON.stringify(l.additional_kwargs.function_call)),o+=await this.getNumTokens(l.additional_kwargs.function_call?.arguments)}return t+=o,o})));return t+=3,{totalCount:t,countPerMessage:a}}async completionWithRetry(e,t){const n=this._getClientOptions(t);return this.caller.call((async()=>{try{return await this.client.chat.completions.create(e,n)}catch($u){throw Zc($u)}}))}async betaParsedCompletionWithRetry(e,t){const n=this._getClientOptions(t);return this.caller.call((async()=>{try{return await this.client.beta.chat.completions.parse(e,n)}catch($u){throw Zc($u)}}))}_getClientOptions(e){if(!this.client){const e=zc({azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint}),t={...this.clientConfig,baseURL:e,timeout:this.timeout,maxRetries:0};t.baseURL||delete t.baseURL,this.client=new vo(t)}const t={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.query={"api-version":this.azureOpenAIApiVersion,...t.query}),t}_llmType(){return"openai"}_combineLLMOutput(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>(t&&t.tokenUsage&&(e.tokenUsage.completionTokens+=t.tokenUsage.completionTokens??0,e.tokenUsage.promptTokens+=t.tokenUsage.promptTokens??0,e.tokenUsage.totalTokens+=t.tokenUsage.totalTokens??0),e)),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,t){let n,r,a,i;var s;let o,l;if(void 0!==(s=e)&&"object"===typeof s.schema?(n=e.schema,r=e.name,a=e.method,i=e.includeRaw):(n=e,r=t?.name,a=t?.method,i=t?.includeRaw),void 0!==t?.strict&&"jsonMode"===a)throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if("jsonMode"===a)o=this.bind({response_format:{type:"json_object"}}),l=Qc(n)?Jl.fromZodSchema(n):new ec;else if("jsonSchema"===a)o=this.bind({response_format:{type:"json_schema",json_schema:{name:r??"extract",description:n.description,schema:n,strict:t?.strict}}}),l=Qc(n)?Jl.fromZodSchema(n):new ec;else{let e=r??"extract";if(Qc(n)){const r=(0,$o.Ik)(n);o=this.bind({tools:[{type:"function",function:{name:e,description:r.description,parameters:r}}],tool_choice:{type:"function",function:{name:e}},...void 0!==t?.strict?{strict:t.strict}:{}}),l=new sc({returnSingle:!0,keyName:e,zodSchema:n})}else{let r;"string"===typeof n.name&&"object"===typeof n.parameters&&null!=n.parameters?(r=n,e=n.name):(e=n.title??e,r={name:e,description:n.description??"",parameters:n}),o=this.bind({tools:[{type:"function",function:r}],tool_choice:{type:"function",function:{name:e}},...void 0!==t?.strict?{strict:t.strict}:{}}),l=new sc({returnSingle:!0,keyName:e})}}if(!i)return o.pipe(l);const c=fl.assign({parsed:(e,t)=>l.invoke(e.raw,t)}),u=fl.assign({parsed:()=>null}),d=c.withFallbacks({fallbacks:[u]});return il.zZ.from([{raw:o},d])}}function Qc(e){return"function"===typeof e?.parse}var eu=n(6628),tu=(n(9582),n(4614));class nu extends ol{get lc_namespace(){return["langchain","tools"]}constructor(e){super(e??{}),Object.defineProperty(this,"returnDirect",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"verboseParsingErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"responseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"content"}),this.verboseParsingErrors=e?.verboseParsingErrors??this.verboseParsingErrors,this.responseFormat=e?.responseFormat??this.responseFormat}async invoke(e,t){let n,r;(0,tu.K)(e)?(n=e.id,r=e.args):r=e;const a=(0,pl.ZI)(t);return this.call(r,{...a,configurable:{...a.configurable,tool_call_id:n}})}async call(e,t,n){let r;try{r=await this.schema.parseAsync(e)}catch($u){let n="Received tool input did not match expected schema";throw this.verboseParsingErrors&&(n=`${n}\nDetails: ${$u.message}`),new tu.q(n,JSON.stringify(e))}const a=(0,cl.H_)(t),i=await cl.Td.configure(a.callbacks,this.callbacks,a.tags||n,this.tags,a.metadata,this.metadata,{verbose:this.verbose}),s=await(i?.handleToolStart(this.toJSON(),"string"===typeof r?r:JSON.stringify(r),a.runId,void 0,void 0,void 0,a.runName));let o,l,c,u;delete a.runId;try{o=await this._call(r,s,a)}catch($u){throw await(s?.handleToolError($u)),$u}if("content_and_artifact"===this.responseFormat){if(!Array.isArray(o)||2!==o.length)throw new Error(`Tool response format is "content_and_artifact" but the output was not a two-tuple.\nResult: ${JSON.stringify(o)}`);[l,c]=o}else l=o;a&&"configurable"in a&&(u=a.configurable.tool_call_id);const d=function(e){const{content:t,artifact:n,toolCallId:r}=e;return r?"string"===typeof t||Array.isArray(t)&&t.every((e=>"object"===typeof e))?new eu.uf({content:t,artifact:n,tool_call_id:r,name:e.name}):new eu.uf({content:au(t),artifact:n,tool_call_id:r,name:e.name}):t}({content:l,artifact:c,toolCallId:u,name:this.name});return await(s?.handleToolEnd(d)),d}}class ru extends nu{constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:Gl.z.object({input:Gl.z.string().optional()}).transform((e=>e.input))})}call(e,t){return super.call("string"!==typeof e&&e?e:{input:e},t)}}function au(e){try{return JSON.stringify(e,null,2)}catch(t){return`${e}`}}Object.defineProperty(class extends ru{static lc_name(){return"DallEAPIWrapper"}constructor(e){void 0!==e?.responseFormat&&["url","b64_json"].includes(e.responseFormat)&&(e.dallEResponseFormat=e.responseFormat,e.responseFormat="content"),super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"A wrapper around OpenAI DALL-E API. Useful for when you need to generate images from a text description. Input should be an image description."}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"dall-e-3"}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:"vivid"}),Object.defineProperty(this,"quality",{enumerable:!0,configurable:!0,writable:!0,value:"standard"}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:"1024x1024"}),Object.defineProperty(this,"dallEResponseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"url"}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t={apiKey:e?.apiKey??e?.openAIApiKey??(0,Ro.Az)("OPENAI_API_KEY"),organization:e?.organization??(0,Ro.Az)("OPENAI_ORGANIZATION"),dangerouslyAllowBrowser:!0,baseUrl:e?.baseUrl};this.client=new vo(t),this.model=e?.model??e?.modelName??this.model,this.style=e?.style??this.style,this.quality=e?.quality??this.quality,this.n=e?.n??this.n,this.size=e?.size??this.size,this.dallEResponseFormat=e?.dallEResponseFormat??this.dallEResponseFormat,this.user=e?.user}processMultipleGeneratedUrls(e){return"url"===this.dallEResponseFormat?e.flatMap((e=>e.data.flatMap((e=>e.url?{type:"image_url",image_url:e.url}:[])).filter((e=>void 0!==e&&"image_url"===e.type&&"string"===typeof e.image_url&&void 0!==e.image_url)))):e.flatMap((e=>e.data.flatMap((e=>e.b64_json?{type:"image_url",image_url:{url:e.b64_json}}:[])).filter((e=>void 0!==e&&"image_url"===e.type&&"object"===typeof e.image_url&&"url"in e.image_url&&"string"===typeof e.image_url.url&&void 0!==e.image_url.url))))}async _call(e){const t={model:this.model,prompt:e,n:1,size:this.size,response_format:this.dallEResponseFormat,style:this.style,quality:this.quality,user:this.user};if(this.n>1){const e=await Promise.all(Array.from({length:this.n}).map((()=>this.client.images.generate(t))));return this.processMultipleGeneratedUrls(e)}const n=await this.client.images.generate(t);let r="";return"url"===this.dallEResponseFormat?[r]=n.data.map((e=>e.url)).filter((e=>"undefined"!==e)):[r]=n.data.map((e=>e.b64_json)).filter((e=>"undefined"!==e)),r}},"toolName",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"});var iu=n(4778),su=n(7717);n(3492);iu.m;n(6933),n(454),n(3849),n(3330);su.RZ;const ou=e=>{const[t,n]=(0,r.useState)(null),[a,i]=(0,r.useState)(null);console.log("hipo"),console.log(window._env_),console.log({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_TEST),console.log(window._env_.REACT_APP_OPENAI_API_KEY);const s=su.RZ.fromMessages([["system","Instructions: You are an assistant which answers questions about Rory, using only the provided context.\n                If you do not not have enough information to answer the question, reply explaining that you aren't sure.\n                Do not use more than 20 words in your answers.\n            \n            Context: Rory grew up in Saffron Walden, a town Essex. Rory began coding when he was 13. Rory is currently 23. Rory received his Bachelor's\n                degree in Computer Science from University College London in 2023. Rory enjoys reading, running, gaming, and listening to music.\n                Rory speaks Spanish. Rory is a cat-lover. In addition to Computer Science, Rory is also interested in Physics, Philosophy, and\n                History. \n            "],new su.GL("messages")]),o=new Xc({apiKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_OPENAI_API_KEY,model:"gpt-4o-mini",temperature:.4}),l=s.pipe(o);return(0,r.useEffect)((()=>{n(null),e.length>1&&(async()=>{const t=await l.invoke({messages:e});n(t.content)})()}),[e]),{aiResponse:t,error:a}},lu=()=>{const[e,t]=(0,r.useState)([{role:"system",content:"Hello, I'm Rozbot! I am a language model trained to answer questions you have about Rory."}]),{aiResponse:n,error:a}=ou(e),[i,s]=(0,r.useState)("");return(0,r.useEffect)((()=>{const t=document.getElementById("chatInput");e.length>1&&t&&t.focus()}),[n]),(0,De.jsx)("div",{className:"rozbot m-4 ",children:(0,De.jsxs)(lr,{fluid:!0,className:"p-0",children:[(0,De.jsx)("h2",{className:"m-3",children:"Rozbot"}),(0,De.jsx)("div",{className:"p-0 overflow-scroll",style:{maxHeight:"100vh"},children:(0,De.jsxs)("ul",{className:"list-group border border-outline",children:[e.map(((e,t)=>(0,De.jsx)("li",{className:"list-group-item"+(t%2!==0?" text-end":" bg-body-tertiary"),children:e.content},t))),e.length>1&&!n&&(0,De.jsx)("li",{className:"list-group-item bg-body-tertiary",children:(0,De.jsx)("div",{className:"spinner-border spinner-border-sm"})}),!!n&&(0,De.jsx)("li",{className:"list-group-item bg-body-tertiary",children:n}),(e.length<=1||!!n)&&(0,De.jsx)("li",{className:"list-group-item",children:(0,De.jsxs)("form",{onSubmit:r=>{(r=>{r.preventDefault(),t(n?[...e,{role:"assistant",content:n},{role:"user",content:i}]:[...e,{role:"user",content:i}]),s("")})(r)},children:[(0,De.jsx)("input",{className:"form-control text-end",placeholder:"your response...",value:i,onChange:e=>{s(e.target.value)},id:"chatInput"}),(0,De.jsx)("input",{type:"submit",hidden:!0})]})})]})})]})})},cu=()=>(0,De.jsxs)("div",{className:"mainPage",children:[(0,De.jsx)(sr,{}),(0,De.jsx)(lu,{}),(0,De.jsx)(ir,{})]}),uu=n.p+"static/media/good_latent_space.0c0f41a8a88efd4fafd9.png",du=n.p+"static/media/genwindow_app.63c157b69628ec74e422.png",hu=n.p+"static/media/graph_sr.e6f2f23877e0cad0ebac.png",pu=n.p+"static/media/Sketch Application FlowChart.7d329892cd69e4704319.png";function fu(e,t){return Array.isArray(e)?e.includes(t):e===t}const mu=r.createContext({});mu.displayName="AccordionContext";const gu=mu,yu=r.forwardRef(((e,t)=>{let{as:n="div",bsPrefix:a,className:i,children:s,eventKey:o,...l}=e;const{activeEventKey:c}=(0,r.useContext)(gu);return a=Ze(a,"accordion-collapse"),(0,De.jsx)(It,{ref:t,in:fu(c,o),...l,className:Te()(i,a),children:(0,De.jsx)(n,{children:r.Children.only(s)})})}));yu.displayName="AccordionCollapse";const vu=yu,bu=r.createContext({eventKey:""});bu.displayName="AccordionItemContext";const wu=bu,_u=r.forwardRef(((e,t)=>{let{as:n="div",bsPrefix:a,className:i,onEnter:s,onEntering:o,onEntered:l,onExit:c,onExiting:u,onExited:d,...h}=e;a=Ze(a,"accordion-body");const{eventKey:p}=(0,r.useContext)(wu);return(0,De.jsx)(vu,{eventKey:p,onEnter:s,onEntering:o,onEntered:l,onExit:c,onExiting:u,onExited:d,children:(0,De.jsx)(n,{ref:t,...h,className:Te()(i,a)})})}));_u.displayName="AccordionBody";const xu=_u;const Eu=r.forwardRef(((e,t)=>{let{as:n="button",bsPrefix:a,className:i,onClick:s,...o}=e;a=Ze(a,"accordion-button");const{eventKey:l}=(0,r.useContext)(wu),c=function(e,t){const{activeEventKey:n,onSelect:a,alwaysOpen:i}=(0,r.useContext)(gu);return r=>{let s=e===n?null:e;i&&(s=Array.isArray(n)?n.includes(e)?n.filter((t=>t!==e)):[...n,e]:[e]),null==a||a(s,r),null==t||t(r)}}(l,s),{activeEventKey:u}=(0,r.useContext)(gu);return"button"===n&&(o.type="button"),(0,De.jsx)(n,{ref:t,onClick:c,...o,"aria-expanded":Array.isArray(u)?u.includes(l):l===u,className:Te()(i,a,!fu(u,l)&&"collapsed")})}));Eu.displayName="AccordionButton";const ku=Eu,Su=r.forwardRef(((e,t)=>{let{as:n="h2",bsPrefix:r,className:a,children:i,onClick:s,...o}=e;return r=Ze(r,"accordion-header"),(0,De.jsx)(n,{ref:t,...o,className:Te()(a,r),children:(0,De.jsx)(ku,{onClick:s,children:i})})}));Su.displayName="AccordionHeader";const Ou=Su,Pu=r.forwardRef(((e,t)=>{let{as:n="div",bsPrefix:a,className:i,eventKey:s,...o}=e;a=Ze(a,"accordion-item");const l=(0,r.useMemo)((()=>({eventKey:s})),[s]);return(0,De.jsx)(wu.Provider,{value:l,children:(0,De.jsx)(n,{ref:t,...o,className:Te()(i,a)})})}));Pu.displayName="AccordionItem";const Tu=Pu,Nu=r.forwardRef(((e,t)=>{const{as:n="div",activeKey:a,bsPrefix:i,className:s,onSelect:o,flush:l,alwaysOpen:c,...u}=Re(e,{activeKey:"onSelect"}),d=Ze(i,"accordion"),h=(0,r.useMemo)((()=>({activeEventKey:a,onSelect:o,alwaysOpen:c})),[a,o,c]);return(0,De.jsx)(gu.Provider,{value:h,children:(0,De.jsx)(n,{ref:t,...u,className:Te()(s,d,l&&`${d}-flush`)})})}));Nu.displayName="Accordion";const ju=Object.assign(Nu,{Button:ku,Collapse:vu,Item:Tu,Header:Ou,Body:xu}),Iu=()=>(0,De.jsxs)("div",{className:"sketch-app",children:[(0,De.jsx)("hr",{class:"p-0 m-0"}),(0,De.jsx)("div",{className:"container-fluid pe-4 py-2 bg-body-tertiary",children:(0,De.jsx)("nav",{"aria-label":"breadcrumb",children:(0,De.jsxs)("ol",{className:"breadcrumb m-0",children:[(0,De.jsx)("li",{className:"breadcrumb-item",children:(0,De.jsx)("a",{href:"/",children:"Home"})}),(0,De.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Sketch Completion with Machine Learning"})]})})}),(0,De.jsx)("h2",{className:"m-4",children:"Sketch Completion with Machine Learning"}),(0,De.jsxs)(ju,{children:[(0,De.jsxs)(ju.Item,{eventKey:"0",children:[(0,De.jsx)(ju.Header,{children:"What was the project?"}),(0,De.jsxs)(ju.Body,{children:[(0,De.jsx)("h3",{className:"lead",children:"There are many examples of recent research in the field of image generation using machine learning. However, the vast majority of these projects are focused around pixel-based image formats. To that end, this project aimed to build upon vector-based image generation research with the idea that this image format follows human intuition more closely. This may then allow the creation of tools which may work more closely with people to provide assistance and inspiration in the sketching process."}),(0,De.jsx)("h3",{className:"lead",children:"Specifically, this may assist those learning to draw or who may otherwise find sketching difficult; in particular, those who have a physical or mental disability which may make it difficult to put onto paper exactly the picture they had in mind (this project was made as a dissertation project with the assistance of the UCL Global Disability Innovation Hub)."}),(0,De.jsxs)("h3",{className:"lead",children:["The project was made by adapting the ",(0,De.jsx)("a",{href:"https://arxiv.org/abs/1704.03477",children:"Sketch-RNN"})," framework."]})]})]}),(0,De.jsxs)(ju.Item,{eventKey:"1",children:[(0,De.jsx)(ju.Header,{children:"How did it work?"}),(0,De.jsxs)(ju.Body,{children:[(0,De.jsx)("h3",{className:"lead",children:"The model used in this project was a bi-directional variational autoencoder (VAE) using long-short term memory (LSTM) recurrent neural networks (RNNs). The input to the network was a series of five-dimensional vectors to represent strokes. After encoding, Gaussian noise and normalisation is applied to the latent vector to provide a well-formed and regularised latent space. The output of the model was a series of six-dimensional vectors representing a Gaussian mixture model (GMM) to provide a probability function of the stroke to be made at each point of the output sequence."}),(0,De.jsx)("h3",{className:"lead",children:"The idea behind this tool is that a user may input some strokes into the sketching window. They then may request that their sketch is either re-interpreted or completed by a pre-trained model (in this case the model is trained on owls). The user is then shown a grid of the resulting sketches, each sampled around a focal point in the model's latent space."}),(0,De.jsx)("h3",{className:"lead",children:"The user may then select their favourite sketch, according to which the focal point is moved such that newly generated sketches resemble their favourite more closely. This process may be repeated until the user finds a satisfactory sketch, at which point the sketch may be saved as an SVG file."}),(0,De.jsx)("h3",{className:"lead",children:"In addition, this project explored the viability of transfer learning within the Sketch-RNN framework by comparing training results on pre-trained models to results on fresh models."})]})]}),(0,De.jsxs)(ju.Item,{eventKey:"2",children:[(0,De.jsx)(ju.Header,{children:"What was the outcome?"}),(0,De.jsxs)(ju.Body,{children:[(0,De.jsx)("h3",{className:"lead",children:"The final application had the ability to generate quality images while adapting the features according to the user preferences. However, one caveat is that user selections could lead the latent space into extreme values, meaning low quality images would occasionally be generated. In hindsight, this flaw could be fixed by normalising the latent space values in order to deter focal points with extreme values."}),(0,De.jsx)("h3",{className:"lead",children:"As for the transfer learning module of the project, this was found to be successful and potentially useful for certain applications. Transfer learning was found to give a large head-start to models, however fresh models would catch up after around three hours of training. This means it could be useful to facilitate rapid development of different models to fit certain styles and subjects, however would not be necessary for regular use."}),(0,De.jsxs)("h3",{className:"lead",children:["Overall this project was marked as a first-class dissertation. The paper written for this project may be found ",(0,De.jsx)("a",{href:"assets/diss.pdf",target:"_blank",children:"here"}),", and the github repository for the application and transfer learning module may be found ",(0,De.jsx)("a",{href:"https://github.com/roryn959/Sketch-Generation-Tool",children:"here"}),"."]})]})]})]}),(0,De.jsx)("div",{className:"container my-4",children:(0,De.jsx)("div",{className:"w-50 mx-auto",style:{height:"700px !important"},children:(0,De.jsxs)("div",{id:"sketchAppCarousel",className:"carousel carousel-dark slide","data-bs-ride":"carousel",children:[(0,De.jsxs)("div",{className:"carousel-inner",children:[(0,De.jsx)("div",{className:"carousel-item active",children:(0,De.jsx)("img",{src:nr,className:"d-block w-100",alt:"Main window"})}),(0,De.jsx)("div",{className:"carousel-item",children:(0,De.jsx)("img",{src:uu,className:"d-block w-100",alt:"Good latent space"})}),(0,De.jsx)("div",{className:"carousel-item",children:(0,De.jsx)("img",{src:du,className:"d-block w-100",alt:"Generation window"})}),(0,De.jsx)("div",{className:"carousel-item",children:(0,De.jsx)("img",{src:hu,className:"d-block w-100",alt:"Transfer learning loss graph"})}),(0,De.jsx)("div",{className:"carousel-item",children:(0,De.jsx)("img",{src:pu,className:"d-block w-100",alt:"App flow chart"})})]}),(0,De.jsxs)("button",{className:"carousel-control-prev",type:"button","data-bs-target":"#sketchAppCarousel","data-bs-slide":"prev",children:[(0,De.jsx)("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),(0,De.jsx)("span",{className:"visually-hidden",children:"Previous"})]}),(0,De.jsxs)("button",{className:"carousel-control-next",type:"button","data-bs-target":"#sketchAppCarousel","data-bs-slide":"next",children:[(0,De.jsx)("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),(0,De.jsx)("span",{className:"visually-hidden",children:"Next"})]})]})})})]}),Au=n.p+"static/media/chessMove2.961dc06b0b7606de352e.png",Cu=()=>(0,De.jsxs)("div",{className:"knifefish",children:[(0,De.jsx)("hr",{class:"p-0 m-0"}),(0,De.jsx)("div",{className:"container-fluid pe-4 py-2 bg-body-tertiary",children:(0,De.jsx)("nav",{"aria-label":"breadcrumb",children:(0,De.jsxs)("ol",{className:"breadcrumb m-0",children:[(0,De.jsx)("li",{className:"breadcrumb-item",children:(0,De.jsx)("a",{href:"index.html",children:"Home"})}),(0,De.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Knifefish"})]})})}),(0,De.jsx)("h2",{class:"m-4",children:"Knifefish Chess Engine"}),(0,De.jsxs)(ju,{children:[(0,De.jsxs)(ju.Item,{eventKey:"0",children:[(0,De.jsx)(ju.Header,{children:"What was the project?"}),(0,De.jsx)(ju.Body,{children:"This project contains two chess engines. I originally wrote it in Python for a school project, before re-writing it years later in Java in order to improve its speed as well as improve the code quality and introduce new concepts for a higher playing skill. It includes a chess-playing application with an AI opponent of variable difficulty."})]}),(0,De.jsxs)(ju.Item,{eventKey:"1",children:[(0,De.jsx)(ju.Header,{children:"How did it work?"}),(0,De.jsxs)(ju.Body,{children:[(0,De.jsx)("h3",{className:"lead",children:"The engine uses a Minimax backtracking algorithm alongside Alphabeta pruning. In this way, the AI will exhaustively search through all positions up to a certain number of moves away (or a terminal game state)."}),(0,De.jsx)("h3",{className:"lead",children:"This is then improved with Quiescience search, which will conditionally search the game tree more deeply based on how volatile a position appears to be. This avoids the 'horizon effect', where a position is inaccurately judged by a search with fixed depth because a game changing move was 'just over the horizon' and out of sight."}),(0,De.jsx)("h3",{className:"lead",children:"Additionally, note that an exhaustive search will search the same game state several times; often the same moves may be made in a different sequence, and so there are multiple ways to reach a particular position. To that end, transposition tables allow previous evaluations of positions to be used to prevent redundant calculations. This is implemented with a hash table, where Zobrist hashing allows extremely fast calculations of the table keys."}),(0,De.jsx)("h3",{className:"lead",children:"Finally, the static evaluations of a given position are calculated by using a piece-square table to adapt the estimated score of a given piece according to its position on the board. The values of these tables were populated by using a genetic algorithm to find the optimal scores."})]})]}),(0,De.jsxs)(ju.Item,{eventKey:"2",children:[(0,De.jsx)(ju.Header,{children:"What was the outcome?"}),(0,De.jsxs)(ju.Body,{children:[(0,De.jsx)("h3",{className:"lead",children:"The results of this project were a decent chess engine alongside a much-improved one. The newer engine showcases both a much higher code quality and overall project organisation, and an AI which beats a much higher percentile of the population."}),(0,De.jsxs)("h3",{className:"lead",children:["The repositories for these engines are available in ",(0,De.jsx)("a",{href:"https://github.com/roryn959/Python-Knifefish",children:"Python"})," and",(0,De.jsx)("a",{href:"https://github.com/roryn959/Java-Knifefish",children:"Java"}),"."]})]})]})]}),(0,De.jsx)("div",{class:"container my-4",children:(0,De.jsx)("div",{class:"w-50 mx-auto",style:{height:"700px !important"},children:(0,De.jsxs)("div",{id:"sketchAppCarousel",class:"carousel carousel-dark slide","data-bs-ride":"carousel",children:[(0,De.jsxs)("div",{class:"carousel-inner",children:[(0,De.jsx)("div",{class:"carousel-item active",children:(0,De.jsx)("img",{src:ar,class:"d-block w-100",alt:"Chess move two"})}),(0,De.jsx)("div",{class:"carousel-item",children:(0,De.jsx)("img",{src:Au,class:"d-block w-100",alt:"Chess move one"})})]}),(0,De.jsxs)("button",{class:"carousel-control-prev",type:"button","data-bs-target":"#sketchAppCarousel","data-bs-slide":"prev",children:[(0,De.jsx)("span",{class:"carousel-control-prev-icon","aria-hidden":"true"}),(0,De.jsx)("span",{class:"visually-hidden",children:"Previous"})]}),(0,De.jsxs)("button",{class:"carousel-control-next",type:"button","data-bs-target":"#sketchAppCarousel","data-bs-slide":"next",children:[(0,De.jsx)("span",{class:"carousel-control-next-icon","aria-hidden":"true"}),(0,De.jsx)("span",{class:"visually-hidden",children:"Next"})]})]})})})]});const Ru=function(){return console.log("hi"),console.log({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_OPENAI_API_KEY),(0,De.jsx)(ce,{children:(0,De.jsxs)("div",{className:"App",children:[(0,De.jsx)(tr,{}),(0,De.jsxs)(se,{children:[(0,De.jsx)(ae,{path:"knifefish",element:(0,De.jsx)(Cu,{})}),(0,De.jsx)(ae,{path:"sketchApp",element:(0,De.jsx)(Iu,{})}),(0,De.jsx)(ae,{path:"*",element:(0,De.jsx)(cu,{})})]})]})})};i.createRoot(document.getElementById("root")).render((0,De.jsx)(r.StrictMode,{children:(0,De.jsx)(Ru,{})}))})()})();
//# sourceMappingURL=main.322db1bc.js.map